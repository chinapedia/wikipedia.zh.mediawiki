{{noteTA
|T= zh-cn:协方差; zh-tw:共變異數; zh-hk:協方差;
|G1=Math
}}

'''共變異數'''（{{lang-en|Covariance}}），在[[機率論|機率論]]與[[統計學|統計學]]中用於衡量两个[[随机变量|随机变量]]的联合变化程度。
{{各地漢字名
|t=1
|名詞= Covariance
|cn=协方差
|hk=協方差
|tw=共變異數
|where=日本、韓國
|other={{lang|ja|共分散}}
}}

若变量X的较大值主要与另一个变量Y的较大值相对应，而两者的较小值也相对应，则可稱兩變數倾向于表现出相似的行为，协方差为正。在相反的情况下，当一个变量的较大值主要对应于另一个变量的较小值时，则两变量倾向于表现出相反的行为，协方差为负。即共變異數之正負號顯示著變數的[[相關_(概率論)|相关性]]。

[[File:Covariance_trends.svg|thumb]]

协方差的数值大小取决於變數大小，因此不易解釋。不过，常態形式的协方差大小可以显示两变量线性关系的强弱，可见[[皮尔逊积矩相关系数|皮尔逊积矩相关系数]]。

[[方差|方差]]為协方差的一种特殊情況，即該變數與其自身之共變異數。

== 公式 ==
[[期望值|期望值]]分别为<math>E(X)=\mu</math>与<math>E(Y)=\nu</math>的两个具有有限二阶[[矩_(数学)|矩]]的[[实数|实数]][[随机变量|随机变量]]''X'' 与''Y'' 之间的'''协方差'''定义为：

: <math>\operatorname{cov}(X, Y) = \operatorname{E}((X - \mu) (Y - \nu))=\operatorname{E}(X \cdot Y) - \mu \nu.</math>

协方差表示的是两个变量的总体的[[误差|误差]]，这与只表示一个变量误差的''[[方差|方差]]''不同。
如果两个[[变量|变量]]的变化趋势一致，也就是说如果其中一个大于自身的期望值，另外一个也大于自身的期望值，那么两个变量之间的协方差就是正值。
如果两个变量的变化趋势相反，即其中一个大于自身的期望值，另外一个却小于自身的期望值，那么两个变量之间的协方差就是负值。

如果''X'' 与''Y'' 是[[統計獨立性|统计独立]]的，那么二者之间的协方差就是0，这是因为
: <math>E(X \cdot Y)=E(X) \cdot E(Y)=\mu\nu,</math>
但是反过来并不成立，即如果''X'' 与''Y'' 的协方差为0，二者并不一定是统计独立的。

取决于协方差的[[相關_(概率論)|相关性]]η
: <math> \eta =  \dfrac{\operatorname{cov}(X, Y)}{\sqrt{\operatorname{var}(X) \cdot \operatorname{var}(Y)}} \ ,</math>
更准确地说是线性相关性，是一个衡量线性独立的[[无量纲|无量纲]]数，其取值在[－1, 1]之间。相关性η = 1时称为“完全线性相关”（相关性η = －1时称为“完全线性负相关”），此时将Y<sub>i</sub>对X<sub>i</sub>作Y-X [[散点图|散点图]]，将得到一组精确排列在直线上的点；相关性数值介于－1到1之间时，其绝对值越接近1表明线性相关性越好，作散点图得到的点的排布越接近一条直线。

相关性为0（因而协方差也为0）的两个随机变量又被称为是[[相關_(概率論)|不相关]]的，或者更准确地说叫作“线性无关”、“线性不相关”，这仅仅表明''X'' 与''Y'' 两随机变量之间没有线性相关性，并非表示它们之间一定没有任何内在的（非线性）函数关系，和前面所说的“X、Y二者并不一定是统计独立的”说法一致。

== 属性 ==

如果''X'' 与''Y'' 是实数随机变量，''a'' 与''b'' 是常数，那么根据协方差的定义可以得到：

: <math>\operatorname{cov}(X, X) = \operatorname{var}(X)</math>，
: <math>\operatorname{cov}(X, Y) = \operatorname{cov}(Y, X)</math>，
: <math>\operatorname{cov}(aX, bY) = ab\, \operatorname{cov}(X, Y)</math>，

对于随机变量序列''X''<sub>1</sub>, ..., ''X''<sub>''n''</sub>与''Y''<sub>1</sub>, ..., ''Y''<sub>''m''</sub>，有

: <math>\operatorname{cov}\left(\sum_{i=1}^n {X_i}, \sum_{j=1}^m{Y_j}\right) =  \sum_{i=1}^n{\sum_{j=1}^m{\operatorname{cov}\left(X_i, Y_j\right)}}</math>，

对于随机变量序列''X''<sub>1</sub>, ..., ''X''<sub>''n''</sub>，有

:<math>\operatorname{var}\left(\sum_{i=1}^n X_i \right) = \sum_{i=1}^n \operatorname{var}(X_i) + 2\sum_{i,j\,:\,i<j} \operatorname{cov}(X_i,X_j)</math>。

== 协方差矩阵 ==

分别为''m'' 与''n'' 个[[标量|标量]]元素的列[[向量|向量]]随机变量''X'' 与''Y''，二者对应的期望值分别为μ与ν，这两个变量之间的协方差定义为''m''×''n'' [[矩阵|矩阵]]

: <math>\operatorname{cov}(X, Y) = \operatorname{E}((X-\mu)(Y-\nu)^\top).</math>

两个向量变量的协方差cov(''X'', ''Y'')与cov(''Y'', ''X'')互为[[转置矩阵|转置矩阵]]。

协方差有时也称为是两个随机变量之间“线性独立性”的度量，但是这个含义与[[线性代数|线性代数]]中严格的[[线性相关性|线性独立性]]线性独立不同。

== 参见 ==
* [[自协方差|自协方差]]
* [[协方差矩阵|协方差矩阵]]
* [[协方差函数|协方差函数]]
* [[误差传播|误差传播]]

{{統計學}}

[[Category:协方差与相关性|Category:协方差与相关性]]