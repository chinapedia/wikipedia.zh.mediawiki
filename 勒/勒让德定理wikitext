在正数<math>n!</math>的[[质因数分解|质因数分解]]中，[[質数|質数]]p的指数记作<math>\nu_p(n!)</math>，则<math>\nu_p(n!)=\sum_{k\ge 1} [{n \over p^k}]</math>。

== 背景 ==
'''勒让德定理'''是由[[法国|法国]][[数学家|数学家]][[勒让德|勒让德]]发现证明的。

== 证明 ==
若把2,3,...,n都分解成了标准分解式，则<math>\nu_p(n!)</math>就是这n-1个分解式中p的[[指数|指数]]和.设其中p的[[指数|指数]]为r的有<math>n_r</math>个(<math>r\ge 1</math>)，则

<math>\begin{align}\nu_p(n!) &=n_1+2n_2+3n_3+...=\sum_{r\ge 1} rn_r\\
&=(n_1+n_2+n_3+...)+(n_2+n_3+...)+(n_3+...)=N_1+N_2+N_3+...=\sum_{k\ge 1} N_k\end{align}</math>

其中<math>N_k=n_k+n_{k+1}+...=\sum_{r\ge k} n_r</math>恰好是2,3,...,n这n-1个数中能被<math>p^k</math>除尽的数的个数，即<math>N_k=[{n \over p^k}]</math>得证。

== 其它表達式 ==
將n以p為基底寫做<math>n = n_\ell p^\ell + \cdots + n_1 p + n_0</math>（[[進位制|進位制]]）

定義<math>{\displaystyle s_{p}(n)=n_{0}+n_{1}+\cdots +n_{r}}</math>是p[[底数_(进制)|底数]]的數位和，則

:<math>\nu_p(n!) = \frac{n - s_p(n)}{p - 1}.</math>

因此'''勒讓德定理'''可以用來證明[[庫默爾定理|庫默爾定理]]。

=== 證明 ===
<math>n = n_\ell p^\ell + \cdots + n_1 p + n_0</math>

<math>\textstyle \left\lfloor \frac{n}{p^i} \right\rfloor = n_\ell p^{\ell-i} + \cdots + n_{i+1} p + n_i</math>

:<math>
\begin{align}
\nu_p(n!)
&= \sum_{i=1}^{\ell} \left\lfloor \frac{n}{p^i} \right\rfloor \\
&= \sum_{i=1}^{\ell} \left(n_\ell p^{\ell-i} + \cdots + n_{i+1} p + n_i\right) \\
&= \sum_{i=1}^{\ell} \sum_{j=i}^{\ell} n_j p^{j-i} \\
&= \sum_{j=1}^{\ell} \sum_{i=1}^{j} n_j p^{j-i} \\
&= \sum_{j=1}^{\ell} n_j \cdot \frac{p^j - 1}{p - 1} \\
&= \sum_{j=0}^{\ell} n_j \cdot \frac{p^j - 1}{p - 1} \\
&= \frac{1}{p - 1} \sum_{j=0}^{\ell} \left(n_j p^j - n_j\right) \\
&= \frac{1}{p - 1} \left(n - s_p(n)\right).
\end{align}
</math>

[[Category:数学定理|L]]
[[Category:数论|Category:数论]]