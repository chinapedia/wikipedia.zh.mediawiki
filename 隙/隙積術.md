'''垛积术'''，也称'''隙积术'''，实质上是一种高阶[[等差级数|等差级数]]求和问题。由北宋[[沈括|沈括]]首開先河，南宋[[杨辉|杨辉]]和元朝[[朱世杰|朱世杰]]多有贡献。

沈括在《[[梦溪笔谈|梦溪笔谈]]》卷十八《技艺》篇首创隙积术，是用來研究某種物品按規律堆積起來求其總數問題。隙积是指酒甕之类的物品，往上堆積成台形之狀，求其總數，這是二階等差級數求和問題。至於垛積是堆垛求積的意思。垛积术是杨辉繼沈括的隙積術之後，開創高阶等差级数的研究。元代朱世杰則將垛积术的研究推向最高峰，他使用的[[招差術|招差術]]实际上是解决了任意高阶等差级数的有限项求和问题。

==沈括隙积术==
北宋[[沈括|沈括]]在《[[梦溪笔谈|梦溪笔谈]]》卷十八《技艺》篇，首创隙积术：''隙積者，謂積之有隙者，如累棋、層壇及灑家積罌之類。雖似覆鬥，四面皆殺，緣有刻缺及虛隙之處，用芻童法求之，常失於數少。餘思而得之，用爭童法為上位；下位別列：下廣以上廣減之，余者以高乘之，六而一，並入上位。假令積罌：最上行縱橫各二罌，最下行各十二罌，行行相次。先以上二行相次，率至十二，當十一行也。以芻童法求之，倍上行長得四，並入下長得十六，以上廣乘之，得之三十二；又倍下行長得二十四，並入上長，得二十六，以下廣乘之，得三百一十二；並二位得三百四十四，以高乘之，得三千七百八十四。重列下廣十二，以上廣減之，餘十，以高乘之，得一百一十，並入上位，得三千八百九十四；六而一，得六百四十九，此為罌數也。芻童求見實方之積，隙積求見合角不盡，益出羨積也''

一个层罈，共<math>h</math>层，上面<math>a\times b</math>，下底<math>c\times d</math>，

这是二阶等差级数求和问题：

: <math>ab+(a+1)(b+1)+(a+2)(b+2)+...+(a+h-1)(b+h-1)</math>

沈括给出的公式 <math>\frac{h}{6}((2a+c)b+(2c+a)d +(d-b))</math><ref>吴文俊主编 《[[中国数学史大系|中国数学史大系]]》 第五卷 北宋 沈括  73页  ISBN 7-303-04926-6/O</ref>

==杨辉垛积术==
杨辉在《详解九章算法》《商功》篇阐述了方垛，刍甍垛，刍童垛，和三角垛。
===方垛===
''果子以垛，下方十四个，问计几何？''
''术曰：下方加一，乘下方为平积。又加半为高，以乘下方为高积。如三而一''.
:<math>1+4+9+16....n^2=\frac{1}{3}n(n+1)(n+\frac{1}{2})=\frac{1}{6}n(n+1)(2n+1)</math>。<ref>吴文俊主编 《中国数学史大系》 第五卷 南宋 杨辉 592页</ref>

===刍童垛===
即长方形立体垛,上面长<math>n</math>个,宽<math>m</math>个,高<math>h</math>个:
:<math>4*2+5*3+6*4+7*5+\dots +(n+h-1)*(m+h-1)=\frac{h}{6}((2n+n+h-1))*m+(2(n+h-1)+n)</math>

===三角垛===
''三角垛下广一面十二个，上尖，高十二个，问：计几何?''
:术曰：下广加一，乘下广。平积，下广加二乘之，立高方积，如六而一。

<math>1+3+6+10+\dots \frac{n(n+1)}{2}=\frac{1}{6}n(n+1)(n+2)</math><ref>吴文俊主编 《中国数学史大系》 第五卷 南宋 杨辉 592页</ref>

==朱世杰垛积术==
===三角垛===
《[[四元玉鉴|四元玉鉴]]》 《果垛叠藏》第一问：

“今有三角垛果子一所，值钱一贯三百二十文，只云从上一个值钱二文，次下层层每个累贵一文，问底子每面几何？”
:答曰：九个。

术曰：立天元一为每个底子，如积求之，得三万一千六百八十为益实十为从方，二十一为从上廉，一十四为下廉，三为从隅，三桀方开之，得每个底子，合问。

三角垛级数

<math>1+3+6+10+...+\frac{1}{2}n(n+1)</math>

三角垛自上而下，每边的果子数是：

<math>1,2,3,4,5,6,\dots ,n</math>

自上而下，每个果子值钱：

<math> 2,3,4,5,6,7,\dots ,(n+1)</math>

三角果子垛价值V由下列级数表示

<math>v=2+9+24+50+90+147+224+\dots +\frac{1}{2}n(n+1)^2</math>

这是一个已知级数和，倒求 n 的数学问题。

朱世杰用天元术，令天元一 为每底边的果子数<math>x=n</math>

朱世杰用的求和公式：<math> v=\frac{1}{2*3*4}(3x+5)*x*(x+1)*(x+2)</math>



今<math>v=1320</math>得

<math>3*x^4+14x^3+21x^2+10x-31680=0</math><ref>万有文库第二集 朱世杰撰 罗士琳草 （中） 卷下之一 六四六-六四八</ref>

解之，得<math>x=n=9</math>。

<math>v=2+9+24+50+90+147+224+324+450=1320</math>。

===三角落一形垛===
<math>1*2*3+2*3*4+3*4*5+\dots+n(n+1)(n+2)=\frac{1}{4} n(n+1)(n+2)(n+3)</math><ref>《李俨.钱宝琮科学史全集》卷3  294页 辽宁教育出版社. 1998</ref>
===四角落一形垛===
<math>1*2*3+2*3*5+3*4*7+\dots +n(n+1)(2n+2)=\frac{1}{2}n(n+1)^2(n+2)</math><ref>《李俨.钱宝琮科学史全集》卷3  294页 辽宁教育出版社. 1998</ref>
===岚峰形垛===
<math>1+6+18+\dots +n^2(n+1)=\frac{1}{12}n(n+1)(n+2)(3n+1)</math>
===三角岚峰形垛===
<math>6+48+180+\dots +n^2(n+1)(n+2)=\frac{1}{20}n(n+1)(n+2)(n+3)(4n+1)</math>
===撒星更落一形垛===
<math>1+5+15+35+70+\dots +\frac{1}{24}n(n+1)(n+2)(n+3)=\frac{1}{120}n(n+1)(n+2)(n+3)(n+4)</math>
===三角撒星更落一形垛===
<math>1+6+21+56+126+\dots +\frac{1}{120}n(n+1)(n+2)(n+3)(n+4)=\frac{1}{720}n(n+1)(n+2)(n+3)(n+4)(n+5)</math>

===四角岚峰形垛===
<math>6+90+336+900+\dots +n^2(n+1)(2n+1)=\frac{1}{10}n(n+1)(n+2)(n(4n+1+\frac{1}{2})+(4n+\frac{1}{2}))</math>

==参考文献==
{{reflist}}
{{中国数学史}}
[[Category:中國古代數學|Category:中國古代數學]]