{{機率分佈
| name =负二项分布
|type =质量
|pdf_image =[[File:Negbinomial.gif|250px]]
*紅線是[[平均值|平均值]]
*綠線是[[標準差|標準差]]
|cdf_image =
|parameters =<math>r > 0\!</math> ([[實數|實]])<br /><math>0<p<1\!</math>（實）
|support =<math>k \in \{0,1,2,\ldots\}\!</math>
|pdf =<math>\frac{\Gamma(r+k)}{k!\,\Gamma(r)}\,p^r\,(1-p)^k \!</math>
|cdf =<math>I_p(r,k+1)</math>
|mean =<math>r\,\frac{1-p}{p}\!</math>
|median =
|mode =<math>\lfloor(r-1)\,(1-p)/p\rfloor\text{ if }r>1</math><br /><math>0\text{ if }r\leq 1</math>
|variance =<math>r\,\frac{1-p}{p^2}\!</math>
|skewness =<math>\frac{2-p}{\sqrt{r\,(1-p)}}\!</math>
|kurtosis =<math>\frac{6}{r} + \frac{p^2}{r\,(1-p)}\!</math>
|entropy =
|mgf =<math>\left(\frac{p}{1-(1-p) e^t}\right)^r \!</math>
|char =<math>\left(\frac{p}{1-(1-p) e^{i\,t}}\right)^r \!</math>
}}

'''負二項分布'''是[[統計學|統計學]]上一種描述在一系列独立同分布的伯努利试验中，失败次数到达指定次数（记为r）时成功次数的[[離散概率分布|離散概率分布]]。比如，如果我们定义掷骰子随机变量x值为x=1时为失败，所有x≠1为成功，这时我们反复掷骰子直到1出现3次（失败次数r=3），此时非1数字出现次数的概率分布即为负二项分布。

[[帕斯卡分布|帕斯卡分布]]（'''Pascal distribution，'''来自Blaise Pascal）和[[波利亚分布|波利亚分布]]（'''Polya distribution'''，又称罐子模型，来自George Pólya）均是负二项分布的特例。在工程，气候等领域中经常用“负二项分布”或“帕斯卡分布”来描述变量r为整数的情况，而使用“波利亚分布”来描述r取到实数值R的情况。

对于“传染性的”（"contagious"）的离散事件，例如龙卷风爆发，相比泊松分布，波利亚分布由于允许其平均值和方差不同，而能够给出更精确的模型。“传染性”的事件中，如果事件发生率相互独立，其发生率间的正相关性（即发生率间存在正协方差项）会导致变量分布有更大的方差。

“负二项分布”与“二项分布”的区别在于：“二项分布”是固定试验总次数N的独立试验中，成功次数k的分布；而“负二项分布”是所有到失败r次时即终止的独立试验中，成功次数k的分布。

==定义==
若每次伯努利试验有两种可能的结果，分别为成功或者失败。在每次试验中，成功的概率为p，失败的概率为（1-p）。反复进行该伯努利试验，直到观察到第r次失败发生。此时试验成功次数''<math>
    X
  </math>''的分布即为负二项分布（或称帕斯卡分布），那么：

: '''若随机变量<math>\mathit{X}</math>服从参数为<math>\mathit{r}</math>和<math>\mathit{p}</math>的负二项分布，则记为<math>X \sim NB(r,p)</math>.'''

在实际生活中，我们可以使用负二项分布描述某种机器在坏掉前，能够工作的天数的分布。此时，“成功”的事件可以指机器正常工作一天，“失败”的事件可以指机器故障的一天。如果我们使用负二项分布来描述运动员在获取r个奖牌前尝试的次数的分布，此时，“成功”的事件指运动员的一次尝试，“失败”的事件指运动员获取一枚奖牌。如果使用负二项分布来描述掷一枚硬币出现r次反面前，出现硬币正面的次数的分布，“成功”的事件指出现硬币的正面，“失败”的事件指出现硬币的反面。

==概率质量函数==

=== 帕斯卡分布 ===
當<math>r</math>是整數時的負二項分布又稱'''帕斯卡分布'''，其[[概率質量函數|概率質量函數]]為<math>
    f(k; r, p) \equiv \Pr(X = k) = \binom{k+r-1}{k} p^k(1-p)^r \quad\text{for }k = 0, 1, 2, \dotsc
  </math>其中''k''是成功的次数，''r''是失败的次数，''p''是事件成功的概率。在负二项分布的概率质量函数中，由于''k+r''次伯努利试验为独立同分布，每个失败''r''次、成功''k''次的事件的概率为{{nowrap|(1 − ''p'')''<sup>r</sup>p<sup>k</sup>''}}。由于第r次失败一定是最后一次试验，所以应该在k+r-1次试验中选择k次成功，使用排列组合二项系数获取所有可能的选择数。

==== 二项系数与负二项名称来源 ====
括号中为[[二項式係數|二项式系数]]表达式：

: <math>
    \binom{k+r-1}{k} = \frac{(k+r-1)!}{(k)!\,(r-1)!} = \frac{(k+r-1)(k+r-2)\dotsm(r)}{(k)!}
  </math>

该表达式可以写成带负值参数的二项系数的形式，如下式所示，解释了“负二项”名称的来源：

: <math>
\begin{align}
& \frac{(k+r-1)\dotsm(r)}{k!} \\[6pt]
= {}& (-1)^k \frac{(-r)(-r-1)(-r-2)\dotsm(-r-k+1)}{k!} = (-1)^k\binom{-r}{k}.
\end{align}
</math>

==== 概率密度函数对所有可能k值求和为1 ====
帕斯卡分布概率质量函数f(k;r,p)对所有可能k值求和，一定等于1：

<math>
\sum_{k=0}^\infty \binom{k+r-1}{k}p^r q^k = 1 

</math>

证明如下：

<math>
1= p^r p^{-r}
 = p^r(1-q)^{-r}
 = p^r\sum_{k=0}^\infty\binom{-r}{k}(-q)^k
 = p^r\sum_{k=0}^\infty(-1)^k\binom{-r}{k}q^k
 = \sum_{k=0}^\infty \binom{k+r-1}{k}p^r q^k 

</math>

其中第三步用到了[[二项序列|二项序列]]展开。

=== 几何分布 ===
取<math>r=1</math>，負二項分布等於幾何分布。其概率質量函數為<math>f(k;1,p) =  p \cdot (1-p)^k \!</math>。

===例子===
舉例說，若我們擲骰子，擲到一即視為成功。則每次擲骰的成功率是1/6。要擲出三次一，所需的擲骰次數屬於集合{ 3, 4, 5, 6, ... }。擲到三次一的擲骰次數是負二項分布的隨機變數。要在第三次擲骰時，擲到第三次一，則之前兩次都要擲到一，其機率為<math>(1/6)^3</math>。注意擲骰是伯努利試驗，之前的結果不影響隨後的結果。

若要在第四次擲骰時，擲到第三次一，則之前三次之中要有剛好兩次擲到一，在三次擲骰中擲到2次1的機率為<math>{3 \choose 3-1}({5\over6})({1\over6})^2</math>。第四次擲骰要擲到一，所以要將前面的機率再乘（1/6）：<math>{1+3-1 \choose 3-1}({1\over6})^3 ({5\over6})</math>。

{{概率分布类型列表|負二項分布}}
[[Category:离散分布|Category:离散分布]]
[[Category:阶乘与二项式主题|Category:阶乘与二项式主题]]