{{NoteTA|G1=IT}}
'''高级加密标准指令集'''现已经集成到许多处理器中。应用程序执行[[高级加密标准|高级加密标准]]（AES）时，使用该指令集提高加密和解密的速度（以及对侧信道攻击的抵抗能力）。

== x86架构 ==
'''高级加密标准指令集'''（或称英特尔'''高级加密标准新指令'''，简称'''AES-NI'''）是一个[[x86|x86]][[指令集架构|指令集架构]]的扩展，用于[[英特尔|Intel]]和[[超威半导体|AMD]][[微处理器|微处理器]]，由Intel在2008年3月提出。<ref>{{Cite web|url=http://softwareprojects.intel.com/avx/|title=Intel Software Network|accessdate=2008-04-05|publisher=Intel|archiveurl=https://web.archive.org/web/20080407095317/http://softwareprojects.intel.com/avx/|archivedate=2008-04-07|deadurl=yes}}</ref>该指令集的目的是改进应用程序使用[[高级加密标准|高级加密标准]]（AES）执行加密和解密的速度。

=== 指令 ===
{| class="wikitable"

! 指令
! 描述<ref>{{Cite web|url=http://software.intel.com/en-us/articles/intel-advanced-encryption-standard-aes-instructions-set/|title=Intel Advanced Encryption Standard (AES) Instruction Set White Paper|accessdate=2012-09-20|author=Shay Gueron|year=2010|publisher=Intel|archive-date=2012-10-29|archive-url=https://web.archive.org/web/20121029035142/http://software.intel.com/en-us/articles/intel-advanced-encryption-standard-aes-instructions-set/|dead-url=no}}</ref>
|-
| <code>AESENC</code>
|执行一轮AES加密流
|-
| <code>AESENCLAST</code>
| 执行最后一轮AES加密流
|-
| <code>AESDEC</code>
| 执行一轮AES解密流<br>
|-
| <code>AESDECLAST</code>
|执行最后一轮AES解密流
|-
| <code>AESKEYGENASSIST</code>
|协助生成AES轮回密钥
|-
| <code>AESIMC</code>
|协助AES逆列混合
|-
| <code>PCLMULQDQ</code>
| 无进位乘法（{{link-en|CLMUL|CLMUL instruction set}}）<ref>{{Cite web|url=http://software.intel.com/en-us/articles/intel-carry-less-multiplication-instruction-and-its-usage-for-computing-the-gcm-mode/|title=Carry-Less Multiplication|publisher=Intel|accessdate=2016-05-14|archive-date=2016-04-25|archive-url=https://web.archive.org/web/20160425231232/https://software.intel.com/en-us/articles/intel-carry-less-multiplication-instruction-and-its-usage-for-computing-the-gcm-mode/|dead-url=no}}</ref>
|}

=== Intel ===
Intel支持AES-NI的处理器<ref>{{Cite web |url=https://ark.intel.com/search/featurefilter?productType=873&0_AESTech=True |title=Intel® Product Specification Advanced Search |accessdate=2019-03-22 |archive-date=2019-09-18 |archive-url=https://web.archive.org/web/20190918234954/https://ark.intel.com/content/www/us/en/ark/search/featurefilter.html?productType=873&0_AESTech=True |dead-url=no }}</ref>：
* Intel [[Westmere微架构|Westmere]]架构处理器，具体如下：
** Intel [[Intel_Xeon處理器列表|Westmere-EP (Xeon 56XX)]]（也称Gulftown至强5600系列DP服务器型号）处理器。
** Intel Clarkdale处理器（酷睿i3、奔腾和赛扬除外）。
** Intel Arrandale处理器（赛扬、奔腾、酷睿i3、酷睿i5-4XXM除外）。
* Intel [[Sandy_Bridge微架構|Sandy Bridge]]处理器。
** 桌面：全部，奔腾、赛扬、酷睿i3除外<ref>{{Cite web |url=http://www.anandtech.com/show/4083/the-sandy-bridge-review-intel-core-i5-2600k-i5-2500k-and-core-i3-2100-tested/2 |title=AnandTech - The Sandy Bridge Review: Intel Core i7-2600K, i5-2500K and Core i3-2100 Tested |accessdate=2016-05-14 |archive-date=2015-04-24 |archive-url=https://web.archive.org/web/20150424190837/http://www.anandtech.com/show/4083/the-sandy-bridge-review-intel-core-i5-2600k-i5-2500k-and-core-i3-2100-tested/2 |dead-url=yes }}</ref><ref>{{Cite web |url=http://ark.intel.com/compare/53415,63913,58667,53480,53481,53482,53483,53484,53485,53490,53491,53492,53416,53414 |title=Compare Intel® Products |accessdate=2016-05-14 |archive-date=2016-04-25 |archive-url=https://web.archive.org/web/20160425173303/http://ark.intel.com/compare/53415,63913,58667,53480,53481,53482,53483,53484,53485,53490,53491,53492,53416,53414 |dead-url=no }}</ref>
** 移动：酷睿i7和酷睿i5全部。一些供应商发售的BIOS配置已禁用该扩展<ref>{{Cite web |url=http://forum.notebookreview.com/windows-os-software/582628-aes-ni-support-truecrypt-sandy-bridge-problem.html |title=AES-NI support in TrueCrypt (Sandy Bridge problem) |accessdate=2016-05-14 |archive-date=2014-08-08 |archive-url=https://web.archive.org/web/20140808054643/http://forum.notebookreview.com/windows-os-software/582628-aes-ni-support-truecrypt-sandy-bridge-problem.html |dead-url=yes }}</ref>，需要更新BIOS才能启用它。<ref>{{Cite web|url=http://ark.intel.com/products/52224|title=Some products can support AES New Instructions with a Processor Configuration update, in particular, i7-2630QM/i7-2635QM, i7-2670QM/i7-2675QM, i5-2430M/i5-2435M, i5-2410M/i5-2415M. Please contact OEM for the BIOS that includes the latest Processor configuration update.|accessdate=2016-05-14|archive-date=2011-08-13|archive-url=https://web.archive.org/web/20110813235533/http://ark.intel.com/products/52224|dead-url=no}}</ref>
* Intel [[Ivy_Bridge微架構|Ivy Bridge]]处理器
** 仅所有i5、i7、至强和i3-2115C<ref>{{Cite web |url=http://ark.intel.com/products/68332/Intel-Core-i3-2115C-Processor-(3MB-Cache-2_00-GHz) |title=存档副本 |accessdate=2016-05-14 |archive-date=2016-03-22 |archive-url=https://web.archive.org/web/20160322022052/http://ark.intel.com/products/68332/Intel-Core-i3-2115C-Processor-(3MB-Cache-2_00-GHz) |dead-url=no }}</ref>。
* Intel [[Haswell微架構|Haswell]]处理器。（i3-4000M<ref>{{Cite web |url=http://ark.intel.com/products/75104/Intel-Core-i3-4000M-Processor-3M-Cache-2_40-GHz |title=存档副本 |accessdate=2016-05-14 |archive-date=2017-09-04 |archive-url=https://web.archive.org/web/20170904172219/http://ark.intel.com/products/75104/Intel-Core-i3-4000M-Processor-3M-Cache-2_40-GHz |dead-url=no }}</ref>、奔腾和赛扬除外）
* Intel [[Skylake|Skylake]]（和以後）處理器。

=== AMD ===
* [[超威半导体|AMD]]
**[[AMD_Ryzen|AMD Ryzen]]处理器。
** [[AMD_Bulldozer|AMD Bulldozer]]处理器。<ref>{{Cite web|url=http://blogs.amd.com/work/2010/11/22/following-instructions/|title=Following Instructions|accessdate=2011-01-04|date=November 22, 2010|publisher=AMD|archiveurl=https://web.archive.org/web/20101126155830/http://blogs.amd.com/work/2010/11/22/following-instructions/|archivedate=2010-11-26|deadurl=yes}}</ref>
** [[AMD_Piledriver|AMD Piledriver]]处理器。
** [[AMD_Steamroller|AMD Steamroller]]处理器。
** [[AMD_Jaguar|AMD Jaguar]]处理器。
** {{le|Puma微架構|Puma (microarchitecture)|AMD Puma}}处理器。

== 其他架构中的硬件加速 ==
在最新的[[SPARC|SPARC]]处理器（T4、T5、M5及之后）和最新的ARM处理器中也有非特权的处理器指令提供AES支持。2011年推出的SPARC T4处理器有用户级指令实现AES轮回。<ref>{{Cite web|url=https://blogs.oracle.com/DanX/entry/sparc_t4_openssl_engine|title=SPARC T4 OpenSSL Engine|accessdate=2012-09-20|author=Dan Anderson|year=2011|publisher=Oracle|archive-date=2012-11-03|archive-url=https://web.archive.org/web/20121103131150/https://blogs.oracle.com/DanX/entry/sparc_t4_openssl_engine|dead-url=no}}</ref>这些指令补充了更高级别的加密命令。2011年宣布的[[ARM架構|ARMv8-A]]处理器架构也有指令实现AES轮回，这包括ARM Cortex-A53和A57，但不包括以前的v7处理器（如Cortex A5、7、8、9、11、15）。<ref>{{Cite web|url=http://www.arm.com/files/downloads/ARMv8_Architecture.pdf|title=ARMv8-A Technology Preview|accessdate=2012-09-20|author=Richard Grisenthwaite|year=2011|publisher=ARM|archive-url=https://web.archive.org/web/20180610181021/https://www.arm.com/files/downloads/ARMv8_Architecture.pdf|archive-date=2018-06-10|dead-url=yes}}</ref>2012年8月，[[IBM|IBM]]宣布<ref>{{Cite web|url=http://www.theregister.co.uk/2012/08/20/ibm_power7_plus_processor_preview/|title=All the sauce on Big Blue's hot chip: More on Power7+|accessdate=2012-09-20|author=Timothy Prickett Morgan|year=2012|publisher=The Register|archive-date=2012-08-24|archive-url=https://web.archive.org/web/20120824023433/http://www.theregister.co.uk/2012/08/20/ibm_power7_plus_processor_preview/|dead-url=no}}</ref>即将到来的Power7+架构有望提供AES支持。这些架构中的命令不能直接与AES-NI命令兼容，但可实现类似的功能。

IBM z9或更晚的主机处理器支持AES作为单操作码（KM、KMC）AES ECB/CBC指令，使用IBM的CryptoExpress硬件。<ref>{{Cite web|url=http://www-03.ibm.com/systems/z/advantages/security/z10cryptography.html|title=IBM System z10 cryptography|accessdate=2014-01-27|publisher=IBM|archive-date=2014-02-01|archive-url=https://web.archive.org/web/20140201190424/http://www-03.ibm.com/systems/z/advantages/security/z10cryptography.html|dead-url=no}}</ref>这些单指令的AES版本比Intel NI更容易使用，但不能被扩展实现为基于AES轮回函数的其他算法，例如Whirlpool散列算法。

=== x86 CPU的支持 ===
[[威盛電子|VIA x86 CPU]]、[[AMD_Geode|AMD Geode]]和Marvell Kirkwood（ARM，mv_cesa在Linux中）使用基于驱动程序的AES加速处理（另见{{link-en|Crypto API (Linux)|Crypto API (Linux)}}）。下列产品支持AES硬件加速，虽然不支持AES-NI指令集：
* AMD [[AMD_Geode|Geode LX]]处理器。<ref>{{Cite web|url=http://www.amd.com/us/products/embedded/processors/geode-lx/Pages/geode-lx-processor-family-technical-specifications.aspx|title=AMD Geode™ LX Processor Family Technical Specifications|publisher=AMD|accessdate=2016-05-14|archive-date=2014-01-30|archive-url=https://web.archive.org/web/20140130150437/http://www.amd.com/us/products/embedded/processors/geode-lx/Pages/geode-lx-processor-family-technical-specifications.aspx|dead-url=no}}</ref>
* VIA
** [[威盛電子|VIA PadLock]]。<ref>{{Cite web|url=http://www.via.com.tw/en/initiatives/padlock/hardware.jsp#aes|title=VIA Padlock Security Engine|accessdate=2011-11-14|publisher=VIA|archive-url=https://web.archive.org/web/20110515073323/http://www.via.com.tw/en/initiatives/padlock/hardware.jsp#aes|archive-date=2011-05-15|dead-url=yes}}</ref><span contenteditable="false"> </span>'''·''' <ref name="openwrt">[http://wiki.openwrt.org/doc/hardware/cryptographic.hardware.accelerators Cryptographic Hardware Accelerators] {{Wayback|url=http://wiki.openwrt.org/doc/hardware/cryptographic.hardware.accelerators |date=20180121000023 }} on OpenWRT.org</ref>
*** [[VIA_C3|VIA C3 Nehemiah C5P (Eden-N)处理器]]。<ref>{{Cite web|url=http://www.via.com.tw/en/products/processors/eden-n/|title=VIA Eden-N Processors|accessdate=2011-11-14|publisher=VIA|deadurl=yes|archiveurl=https://web.archive.org/web/20111111212545/http://www.via.com.tw/en/products/processors/eden-n/|archivedate=2011-11-11}}</ref>
*** [[VIA_C7-D|VIA C7 Esther C5J处理器]]。<ref>{{Cite web|url=http://www.via.com.tw/en/products/processors/c7/|title=VIA C7 Processors|accessdate=2011-11-14|publisher=VIA|archive-date=2007-04-19|archive-url=https://web.archive.org/web/20070419142654/http://www.via.com.tw/en/products/processors/c7-m/|dead-url=no}}</ref>

=== ARM架构 ===
* [[全志科技|Allwinner]]
** 使用“安全系统”的A10和A20。<ref>{{Cite web |url=http://sunxi.montjoie.ovh/ |title=Security System driver status |accessdate=2016-05-14 |archive-date=2016-05-14 |archive-url=https://web.archive.org/web/20160514130435/http://sunxi.montjoie.ovh/ |dead-url=no }}</ref>
* [[博通|Broadcom]]
** 使用“安全处理器”的BCM5801/BCM5805/BCM5820。<ref name="openwrt"/>
* [[高通|高通]]
** [[Snapdragon|Snapdragon]] 805（和以後）。
* [[三星電子|三星電子]]
** [[Exynos|Exynos]] 3系列（和以後）。

=== 其他架构 ===
* [[Atmel_AVR|Atmel xmega]] <ref>{{Cite web|url=http://www.atmel.com/Images/doc8106.pdf|title=Using the XMEGA built-in AES accelerator|accessdate=2014-12-03|archive-date=2015-09-23|archive-url=https://web.archive.org/web/20150923175939/http://www.atmel.com/Images/doc8106.pdf|dead-url=no}}</ref>（[[并行计算|并行执行]]的片上加速器，不是指令）

== 性能 ==
在《AES-NI 性能分析》中，Patrick Schmid和Achim Roos 指出：“...少数已使用英特尔 AES-NI 进行优化的应用程序表现出了傲人成绩”。
<ref>{{Cite web|url=http://www.tomshardware.com/reviews/clarkdale-aes-ni-encryption,2538.html|title=AES-NI Performance Analyzed|accessdate=2010-08-10|author=P. Schmid and A. Roos|year=2010|publisher=Tom's Hardware}}</ref>
一次使用[[Crypto++|Crypto++]][[函式庫|函式庫]]执行的性能分析显示，相比没有加速的[[奔腾4|Pentium 4]], AES/{{le|伽羅瓦/計數器模式|Galois/Counter_Mode|GCM}}的吞吐量从大约每字节28.0周期显著提升至每字节3.5周期。
<ref>{{Cite web|url=http://groups.google.com/group/cryptopp-users/msg/a688203c2314ef08|title=How to get fast AES calls?|accessdate=2010-08-11|author=T. Krovetz, W. Dai|year=2010|work=Crypto++ user group|archive-date=2012-11-09|archive-url=https://web.archive.org/web/20121109061542/http://groups.google.com/group/cryptopp-users/msg/a688203c2314ef08|dead-url=no}}</ref><ref>{{Cite web|url=http://www.cryptopp.com/benchmarks-p4.html|title=Crypto++ 5.6.0 Pentium 4 Benchmarks|accessdate=2010-08-10|year=2009|work=Crypto++ Website|archiveurl=https://web.archive.org/web/20100919121759/http://cryptopp.com/benchmarks-p4.html|archivedate=2010-09-19|deadurl=no}}</ref>

== 软件支持 ==
大多数现代编译器能够利用AES指令。

许多安全和加密软件支持AES指令集，包括下列核心基础设施：
* [[Cryptographic_API|Cryptography API: Next Generation (CNG)]]（Windows）<ref>{{Cite web|url=https://software.intel.com/en-us/articles/intel-advanced-encryption-standard-instructions-aes-ni/|title=Intel Advanced Encryption Standard Instructions (AES-NI)|accessdate=2010-07-11|date=March 2, 2010|publisher=Intel|archiveurl=https://web.archive.org/web/20100707065952/https://software.intel.com/en-us/articles/intel-advanced-encryption-standard-instructions-aes-ni/|archivedate=2010-07-07|deadurl=no}}</ref>
* {{link-en|Linux的Crypto API|Crypto API (Linux)}}
* [[Java|Java]] 7 [[HotSpot|HotSpot]]
* [[Network_Security_Services|Network Security Services]]（NSS）3.13及更高版本 <ref>{{Cite web|url=https://bugzilla.mozilla.org/show_bug.cgi?id=706024|title=AES-NI enhancements to NSS on Sandy Bridge systems|accessdate=2012-11-25|date=2012-05-02|archive-date=2014-04-13|archive-url=https://web.archive.org/web/20140413131728/https://bugzilla.mozilla.org/show_bug.cgi?id=706024|dead-url=no}}</ref>（被[[Firefox|Firefox]]和[[Google_Chrome|Google Chrome]]使用）
* {{link-en|Solaris Cryptographic Framework|Solaris Cryptographic Framework}}<ref>{{Cite web|url=http://docs.oracle.com/cd/E19253-01/816-4557/scf-1/index.html|title=System Administration Guide: Security Services, Chapter 13 Solaris Cryptographic Framework (Overview)|accessdate=2012-11-27|date=September 2010|publisher=Oracle|archive-date=2012-02-07|archive-url=https://web.archive.org/web/20120207142821/http://docs.oracle.com/cd/E19253-01/816-4557/scf-1/index.html|dead-url=no}}</ref>从[[Solaris|Solaris]] 10起。
* [[FreeBSD|FreeBSD]]的OpenCrypto API（aesni(4) 驱动程序）<ref>{{Cite web|url=http://www.freebsd.org/releases/8.2R/relnotes.html|title=FreeBSD 8.2 Release Notes|accessdate=2011-12-18|date=2011-02-24|publisher=FreeBSD.org|archive-date=2011-04-12|archive-url=https://web.archive.org/web/20110412153215/http://www.freebsd.org/releases/8.2R/relnotes.html|dead-url=yes}}</ref>
* [[OpenSSL|OpenSSL]] 1.0.1及以上<ref>{{Cite web |url=http://cvs.openssl.org/fileview?f=openssl%2FCHANGES&v=1.1686 |title=OpenSSL: CVS Web Interface |accessdate=2020-12-07 |archive-date=2012-07-07 |archive-url=https://archive.today/20120707203035/http://cvs.openssl.org/fileview?f=openssl/CHANGES&v=1.1686 |dead-url=yes }}</ref>
* [http://flam.de/en/technology/products/ FLAM®/FLUC®]{{Wayback|url=http://flam.de/en/technology/products/ |date=20160509202413 }} 5.1.08（2015-08-24发布）及以上

== 参考 ==
* [[AVX指令集|高级矢量扩展]]（AVX）
* {{link-en|CLMUL指令集|CLMUL instruction set}}
* [[熔合乘法累积指令集|FMA指令集]]（FMA3、FMA4）
* [[RdRand|RdRand]]

== 参考资料 ==
{{Reflist|30em}}

== 外部链接 ==
* [https://software.intel.com/en-us/articles/intel-advanced-encryption-standard-instructions-aes-ni/ Intel®高级加密标准指令（AES-NI）]{{Wayback|url=https://software.intel.com/en-us/articles/intel-advanced-encryption-standard-instructions-aes-ni/ |date=20100707065952 }}
* [https://software.intel.com/sites/default/files/article/165683/aes-wp-2012-09-22-v01.pdf AES指令集白皮书]{{Wayback|url=https://software.intel.com/sites/default/files/article/165683/aes-wp-2012-09-22-v01.pdf |date=20160322032635 }} (4.4 Mbyte, pdf) // Intel

{{多媒體指令集}}
{{分组密码}}

[[Category:X86架構|Category:X86架構]]
[[Category:X86指令|Category:X86指令]]
[[Category:高级加密标准|Category:高级加密标准]]
[[Category:AMD技术|Category:AMD技术]]