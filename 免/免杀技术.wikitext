{{Refimprove|time=2020-08-18T19:33:09+00:00}}
{{noteTA
| G1 = IT
}}
'''免杀技术'''全称为反杀毒技术'''''Anti Anti- Virus'''''简称“免杀”，它指的是一种能使病毒木马免于被[[杀毒软件|杀毒软件]]查杀的技术。由于免杀技术的涉猎面非常广，其中包含反[[汇编|汇编]]、[[逆向工程|逆向工程]]、[[系统漏洞|系统漏洞]]等黑客技术，所以难度很高，一般人不会或没能力接触这技术的深层内容。其内容基本上都是修改病毒、木马的内容改变特征码，从而躲避了杀毒软件的查杀。<ref>>{{cite web|url=http://news.xinhuanet.com/internet/2008-03/07/content_7735825.htm|title=黑客炫耀“免杀”技术 专家称已有破解方法|publisher=news.xinhuanet.com|accessdate=2009-10-19|archive-date=2015-04-25|archive-url=https://web.archive.org/web/20150425043930/http://news.xinhuanet.com/internet/2008-03/07/content_7735825.htm|dead-url=no}}</ref>

==分类==
*开源免杀：指的是拥有病毒、木马源代码的前提下，通过修改源代码进行免杀。
*手工免杀：指的是仅有病毒、[[木马|木马]]的可执行文件（PE文件）的情况下进行免杀。
*自动免杀：指的是[[病毒|病毒]]、木马自身能自动变异，如：千面人病毒

==技术概览==

===加壳脱壳与加密解密===
*參見[[加殼壓縮|加殼壓縮]]，在免杀技术里所谓的'''壳'''与'''伪装壳'''其实就是压缩与外层数据伪装，其实是利用特殊的[[算法|算法]]，对[[可执行文件|可执行文件]]与[[动态库|动态库]]裡的资源进行[[压缩|压缩]]与对文件的描述、版本号、创建日期、修改软件、系统执行需求等外层[[数据|数据]]进行[[伪装|伪装]]。
*'''脱壳'''就是把已压缩与伪装的文件完全或近似还原到未压缩与伪装的状态。最常用的加壳软件就是[[WinRAR|WinRAR]]。
*加密是将明文信息隐匿起来，使之在缺少特殊信息时全部或部分数据不可读，令杀毒软件无从下手。
*而解密就是令在宿主电脑中的病毒得到密钥，从而突然发作。

===加花指令与程序入口点修改===
*加花指令就是在程序开头加入一段计算用的汇编指令和一些入口点内存地址的乱跳转，或加上其他常用程序特有的入口指令来迷惑杀毒软件。因为计算与跳转的最后结果是没有实质的意义的，所以这么做并不影响[[程序|程序]]的正常运行。但能使一些杀毒软件无法正确识别木马程序，从而达到免杀的效果。
*[[程序入口点|程序入口点]]修改就是改变入口点，通常用到的方法是在入口点的地址加1或把入口点地址拆开，也有加花指令之后把原入口点修改到花指令的入口点上令电脑先处理那段没意义的指令，再在花指令后再加跳转[[代码|代码]]，跳转到程序执行数据的入口点上，令程序正常运行。
例：
（[[組合语言|組合语言]]）
<syntaxhighlight lang=asm>
mov ebp,esp
push ebp	;把基址指针寄存器压入堆栈
pop ebp	        ;把基址指针寄存器弹出堆栈
push eax        ;把数据寄存器压入堆栈
pop eax         ;把数据寄存器弹出堆栈
nop             ;不执行
add esp,1       ;指针寄存器加1
sub esp,1       ;指针寄存器减1
inc ecx         ;计数器加1
dec ecx         ;计数器减1
sub esp,1       ;指针寄存器加1
sub esp,-1      ;指针寄存器加-1
push 321BA      ;跳到内存入口地址321BA
retn            ;反回到入口地址
jb 456CD        ;跳到内存入口地址456CD
jnb 321BA       ;跳到内存入口地址321BA
mov eax,456CD   ;跳到内存入口地址456CD
jmp eax         ;跳到程序入口地址
jmp 321BA       ;跳到程序入口地址321BA
push 123AB      ;把入口地址123AB压入堆栈
mov eax,123AB   ;把入口地址123AB转送到数据寄存器中。
jmp 123AB       ;跳到入口地址123AB（程序执行数据的真正入口点）
</syntaxhighlight>

===内存、文件特征码的定位与修改===
众所周知大部分杀毒软件查杀病毒的根据就是对比[[特征码|特征码]]，而这个过程一般发生在内存与硬盘中。对比[[硬盘|硬盘]]中储存着的文件的特征码，能全面地查杀计算机中的可疑文件；对比在[[内存|内存]]中储存着的文件的特征码，能快速地查杀正在运行的程序是否带有病毒，另外[[病毒|病毒]]文件一旦进入内存即运行中，很可能会现出原形被杀毒软件查杀。针对杀毒软件这一特性，[[骇客|骇客]]们发明了内存、文件特征码修改免杀法。通常首先用特征码定位软件定位[[文件|文件]]特征码的所在之处，再用[[UltraEdit|UltraEdit]]对被定位的特征码段进行修改。

一般修改方法有：
*十六进制的特征码直接修改法，就是把十六进制的特征码加1；
*字符串大小写修改法，就是特征码所对应的内容是[[字符串|字符串]]的时候，把大小字互换；
*等价替换法，就是当特征码所对应的是[[汇编指令|汇编指令]]时，把指令替换成功能类拟的指令；
*指令顺序调换法，把特征码对应的汇编指令的顺序互换；
*通用跳转法，用跳转的方法把特征码对应的汇编指令跳转走，犹如加花一样。

修改特征码的方法针对性很强很有用，但一次修改-{只}-能对一款杀毒软件免杀；要令另一款软件免杀，就要重新针对该软件修改特征码，因为各家杀毒软件公司使用的特征码基本上都不相同。

===文件植入与捆绑===

==免杀工具==
常用工具有<ref>>{{cite web|url=http://news.newhua.com/news1/safe_technology/2008/214/0821410743GHD936119H58KJ27DEHB.html?lt=common|title=免杀技术之特征码修改常识|publisher=news.newhua.com|accessdate=2009-10-19|deadurl=yes|archiveurl=https://web.archive.org/web/20120808190634/http://news.newhua.com/news1/safe_technology/2008/214/0821410743GHD936119H58KJ27DEHB.html?lt=common|archivedate=2012-08-08}}</ref>：

*[[加壳|加壳]]器：PEditor、MaskPE、UPX等
*[[脱壳|脱壳]]与分析器：PEid、ResScope、RL!dePacker、Restorator等
*[[加花|加花]]器：FakeNinja
*特征码定位与修改器:CCL、OllyDbg、[[UltraEdit|UltraEdit]]
*调试器：SoftIce
*[[反汇编|反汇编]]器：IDA、W32Dasm等
*十六进制编辑器：HIEW、UltraEdit等
*开发包：SDK与DDK
*[[编译|编译]]器：[[Microsoft_Visual_C++|Microsoft Visual C++]]、Borland C++、Watcom C、GNU C以及Free Pascal等

==注释==
{{reflist}}

==外部链接==
*[https://web.archive.org/web/20090502123826/http://www.3800hk.com/mszt/ 黑鹰安全网－免杀专题]

[[Category:计算机病毒|Category:计算机病毒]]