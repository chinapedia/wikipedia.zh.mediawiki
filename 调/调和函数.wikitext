{{about|数学中的协和函数|音乐中的和声功能|和声功能}}
在[[数学|数学]]、[[数学物理|数学物理]]学以及[[随机过程|随机过程]]理论中，都有'''调和函数'''的概念。一个'''调和函数'''是一个二阶[[导数|连续可导]]的[[函数|函数]]''f'' : ''U'' → '''R'''（其中''U''是'''R'''<sup>''n''</sup>里的一个[[开集|开子集]]），其满足[[拉普拉斯方程|拉普拉斯方程]]，即在''U''上满足方程：

:<math>
\frac{\partial^2f}{\partial x_1^2} +
\frac{\partial^2f}{\partial x_2^2} +
\cdots +
\frac{\partial^2f}{\partial x_n^2} = 0
</math>
上式也经常写作
:<math>\nabla^2 f = 0</math>或<math>\ \Delta f = 0</math>，其中符号<math>\Delta</math>是[[拉普拉斯算子|拉普拉斯算子]]

调和函数还用一个较为弱的定义，但这个定义与上述的定义是等价的。

运用[[拉普拉斯算子|拉普拉斯-德拉姆算子]]<math>\Delta</math>，调和函数可以在任意的黎曼流形上定义。在这种情况下，调和函数直接定义为：满足 
<math>\ \Delta f = 0</math>

一个<math>C^2</math>的函数如果满足<math>\Delta f \ge 0</math>，则被称作'''[[次调和函数|次调和函数]]'''。 

== 例子 ==
二元的调和函数的例子有：
* 任意[[全纯函数|全纯函数]]的实数部分和虚数部分。
* 函数： 
<math>f(x_1, x_2)=\ln(x_1^2+x_2^2)</math>

:这个函数定义在'''R'''<sup>2</sup> \ {0}上（实际上是一个均匀线[[电荷|电荷]]所产生的[[电势|电势]]或一个细长的均匀无限长[[圆柱|圆柱]]形物体产生的[[引力|引力]]势所对应的数学模型）
* 函数：
<math>f(x_1, x_2)=e^{x_1}\sin{x_2}</math>。

''n''元的调和函数的例子有：

*'''R'''<sup>''n''</sup>所有的常数函数、线性函数和仿射函数（比如说两块均匀带电无限大平板之间的电势）。
*定义在'''R'''<sup>''n''</sup> \ {0}上的函数''f''(''x''<sub>1</sub>,...,''x''<sub>''n''</sub>) = (''x''<sub>1</sub><sup>2</sup> + ... + ''x''<sub>''n''</sub><sup>2</sup>)<sup>1 −''n''/2</sup>，其中''n'' ≥ 2。

在三元的调和函数的例子前，先定义<math>r^2=x^2+y^2+z^2</math>以简化形式。下面表格中的函数在经过数乘（乘以一个常数）、旋转和相加后仍然会是调和函数。调和函数是由其奇点决定的。调和函数的奇点可以在电磁学中解释为电荷所在的点，因此相应的调和函数可以看作是某种电荷分布下的电势场。

:{| class="wikitable"
! 函数 !! 奇点
|-
|align=center|<math>\frac{1}{r}</math>
|原点处的点电荷
|-
|align=center|<math>\frac{x}{r^3}</math>
|原点处的x-向[[电偶极矩|电偶极矩]]
|-
|align=center|<math>-\ln(r^2-z^2)\,</math>
|整个z-轴上均匀带电的线电荷
|-
|align=center|<math>-\ln(r+z)\,</math>
|负的z-轴上均匀带电的线电荷
|-
|align=center|<math>\frac{x}{r^2-z^2}\,</math>
|整个z-轴上的线性电偶极矩
|-
|align=center|<math>\frac{x}{r(r+z)}\,</math>
|负的z-轴上的线性电偶极矩
|}

== 性质 ==
在给定的开集''U''上所有的调和函数的集合是其上的[[拉普拉斯算子|拉普拉斯算子]]Δ的[[核_(代数)|核]]，因此是一个'''R'''的[[向量空间|向量空间]]：调和函数的和與差以及数乘，結果依然是调和函数。

如果''f''是''U''上的一个调和函数，那么''f''的所有[[偏导数|偏导数]]也仍然是''U''上的调和函数，在调和函数类上，拉普拉斯算子和偏导数算子是交换的。

在某些意义上，调和函数是[[全纯函数|全纯函数]]在实值函数上的对应物。所有的调和函数都是[[解析函数|解析的]]，也就是说它们可以局部地展开成[[幂级数|幂级数]]。这是关于[[椭圆算子|椭圆算子]]的一个性质，而拉普拉斯算子是一个常见的例子。

收敛的调和函数列的一致极限仍会是调和的。这是因为所有满足介值性质的连续函数都是调和函数。

== 与复函数理论的联系==
一个全纯函数的实数和虚数部分都是'''R'''<sup>2</sup>上的调和函数。反过来说，对于一个调和函数''u''，总可以找到一个调和函数''v''，使得函数''u+iv''是全纯函数。这个函数''v''被称为调和函数''u''的'''[[调和共轭|调和共轭]]'''。这里的函数''v''在差一个常数的意义上是唯一定义的。这个结果在[[希尔伯特变换|希尔伯特变换]]中有应用，也是数学分析中一个与[[奇异积分算子|奇异积分算子]]有关的基本例子。在几何意义上，''u''和''v''可以被看作具有'''[[正交|正交]]'''的关系。如果画出两者的等值线，那么两条线在交点处正交（两条[[切线|切线]]成[[直角|直角]]）。在这种视角下，函数''u+iv''可以被看作一种“复位势场”，其中''u''是一个[[位势轮|位势函数]]，而''v''是[[流函数|流函数]]。

=== 调和函数规则性的理论===
调和函数总是无穷次可导（光滑）的。事实上，调和函数是[[解析函数|实解析函数]]的一种。

=== 极大值定理===
调和函数满足以下的'''极大值定理'''：如果''K''是''U''的一个[[紧集|紧子集]]，那么''f''在''K''上诱导的函数只能在[[边界_(拓扑学)|边界]]上达到其[[最大值和最小值|最大值和最小值]]。如果''U''是[[连通空间|连通的]]，那么这个定理意味着''f''不能达到最大值和最小值，除非它是常数函数。对于次调和函数也有同样的定理。

=== 介值性质 ===
设B(''x'',''r'')是一个以''x''为中心，以''r''为半径的完全在''U''中的球，那么调和函数''f''(''x'')球的边界上取值的平均值和''f''在球的内部的取值的平均值相同。也就是说：

<math>
  u(x) = \frac{1}{\omega_n r^{n-1}}\oint_{\partial B(x,r)} u \, dS
 = \frac{n}{\omega_n r^n}\int_{B (x,r)} u \, dV
</math>

其中<math>\omega_n</math>表示''n''维的[[单位N维球面|单位球面]]。

=== 刘维尔定理 ===
如果''f''在整个'''R'''<sup>''n''</sup>都有定义的调和函数，并且在其上有最大值或最小值，那么函数''f''是常数函数（参见复平面上函数的[[刘维尔定理_(复分析)|刘维尔定理]]）。

==推广==
调和函数研究的一个推广是黎曼流形上的[[调和形|调和形]]的研究，后者与[[上同调|上同调]]的研究有关。此外，可以定义调和的向量值函数，或者两个黎曼流形间的调和映射。这些调和映射出现在最小表面理论中。比如说，一个从'''R'''上区间
射到一个黎曼流形的映射是调和的当且仅当它是一条[[测地线|短程线]]。

==参见==
*[[狄利克雷问题|狄利克雷问题]]
*[[熱傳導方程|熱傳導方程]]
*[[拉普拉斯方程|拉普拉斯方程]]
*[[泊松方程|泊松方程]]
*[[二次域|二次域]]
*[[次调和函数|次调和函数]]

== 参考 ==
* L.C. Evans, 1998. ''Partial Differential Equations''. American Mathematical Society. 
*D. Gilbarg, N. Trudinger ''Elliptic Partial Differential Equations of Second Order''. ISBN 3-540-41160-7.
* Q. Han, F. Lin, 2000, ''Elliptic Partial Differential Equations'', American Mathematical Society
* [https://web.archive.org/web/20141129025210/http://www.jyu.edu.cn/shuxue/math/kecheng/course/fubianhanshu/kejian/22.PPT 解析函数与调和函数][https://web.archive.org/web/20041223191357/http://www.gxtvu.com.cn/eduwest/web_courseware/physics/0135/page/no2/010202.htm 2]

== 外部链接==
* {{MathWorld|urlname=HarmonicFunction|title=调和函数}}
* [https://web.archive.org/web/20070124091631/http://math.fullerton.edu/mathews/c2003/HarmonicFunctionMod.html J.H.马修，调和函数教程]
* [http://www.axler.net/HFT.html 调和函数教程]{{Wayback|url=http://www.axler.net/HFT.html |date=20080514173849 }}

{{Authority control}}
[[Category:调和函数|Category:调和函数]]
[[Category:傅里叶分析|Category:傅里叶分析]]