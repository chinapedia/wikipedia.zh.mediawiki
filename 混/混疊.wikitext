{{missing information|数学上的解释|time=2019-06-14T09:05:25+00:00}}
{{noteTA
|G1=Communication
|1=zh-hans:数字; zh-hant:數位;
|2=zh-hans:模拟; zh-hant:類比;
|3=zh-hans:操作; zh-hant:動作;
}}
'''混疊'''（{{lang-en|'''Aliasing'''}}），在[[訊號|訊號]]頻譜上可稱作'''疊頻'''；在[[影像|影像]]上可稱作'''疊影'''，主要來自於對連續時間訊號作[[取樣|取樣]]以[[數位化|數位化]]時，取樣頻率低於兩倍[[奈奎斯特頻率|奈奎斯特頻率]]。

在[[統計|統計]]、[[訊號處理|訊號處理]]和相關領域中，'''混疊'''是指取樣訊號被還原成連續訊號時產生彼此交疊而'''失真'''的現象。當混疊發生時，原始訊號無法從取樣訊號還原。而混疊可能發生在時域上，稱做[[時間混疊|時間混疊]]，或是發生在頻域上，被稱作[[空間混疊|空間混疊]]。

在視覺影像的[[類比數位轉換|類比數位轉換]]或[[音樂訊號|音樂訊號]]領域，混疊都是相當重要的議題。因為在做類比-數位轉換時若取樣頻率選取不當將造成高頻訊號和低頻訊號混疊在一起，因此無法完美地重建出原始的訊號。為了避免此情形發生，取樣前必須先做[[濾波|濾波]]的動作。

== 概要 ==


=== 時間週期上的混疊 ===
舉例來說：[[太陽|太陽]]在天空由東往西移動，兩次的日出間隔了24小時。若某個人每23小時對天空拍張照片，太陽會好像由西向東移動，並且日出週期由24小時轉變成552小時（24×23=552）。相同的現象也會發生在高速旋轉的車輪鋼圈，視覺上看到的旋轉方向和實際上相反。這就是[[時間混疊|時間混疊]]。 [[File:aliasing-plot.png|frame]]
 
混疊是一個[[音訊|音訊]]與[[視訊|視訊]]上的最大問題。例如在音樂上訊號中會含有超出人耳聽力範圍的高頻成分，如果音樂訊號取樣低於32000取樣/秒(赫茲)任何等於16000赫茲或以上的訊號(奈奎斯特準則)將在數位轉類比轉換器(DAC)中造成混疊現象。為了防止這樣的混疊現象發生，[[抗混疊濾波器|抗混疊濾波器]]可以用來移除高於奈圭斯特頻率以上的混疊雜訊，或是要求音訊內容的取樣保持在兩倍人耳最高頻率極限之上。因此，可以參照[[取樣率|取樣率]]中不同的運用有著不同的取樣率，除人聲傳輸的應用之外，在記錄音樂、聲音的應用中大多都是採用高於40kHz的取樣頻率以確保能夠完整還原。

在[[視訊|視訊]]中時間混疊的造成是來自於[[幀率|幀率]]的限制，進而造成車輪看起來倒轉但實際上正轉的[[車輪效應|車輪效應]](wagon-wheel effect)，在這個現象中逆轉的現象可以以負頻率解釋。為了解決視訊中時間混疊的現象，可以使用[[抗混疊濾波器|抗混疊濾波器]]來減少，或者是要求視訊內容的幀率保持在兩倍視覺暫留頻率之上。

=== 空間週期上的混疊 ===

在瀏覽照片時，檔案中的圖像會被顯示器或印表機等設備重建。在這個過程中，影像資料處理若涉及到重新取樣及重建，混疊的現象就會發生。

右圖即為圖像在低解析度的還原下產生的莫列波紋範例。這種混疊可能是在取樣或是重建的階段發生，為了減少這些混疊的現象產生，[[抗混疊濾波器|抗混疊濾波器]]可以用於減低混疊在取樣時的影響程度。進而改善還原時混疊出現的失真雜訊。<ref name="mitchell">{{cite conference
|title=Reconstruction filters in computer-graphics
|first=Don P.
|last=Mitchell
|author2=Netravali, Arun N.
|author-link2=Arun Netravali
|url=http://www.mentallandscape.com/Papers_siggraph88.pdf
|doi=10.1145/54852.378514
|conference=ACM SIGGRAPH International Conference on Computer Graphics and Interactive Techniques
|conferenceurl=http://portal.acm.org/toc.cfm?id=54852&type=proceeding&coll=GUIDE&dl=GUIDE,ACM&CFID=30538218&CFTOKEN=95411512
|pages=221–228
|date=August 1988
|volume=22
|number=4
|ISBN=0-89791-275-6
|access-date=2020-05-24
|archive-date=2021-02-24
|archive-url=https://web.archive.org/web/20210224225655/http://mentallandscape.com/Papers_siggraph88.pdf
|dead-url=no
}}</ref>

=== 奈奎斯特準則 ===
以不產生交疊現象的狀況下，所定的取樣頻率如上圖所示。若取樣的頻率太低，就會產生取樣的結果和原來的樣本不同的狀況。若一樣本的頻譜是帶限頻譜，也就是在某一頻率ǀWnǀ之外都為0的頻譜；那麼取樣頻率Ws就必須要大於兩倍的Wn才不至於使頻譜產生交疊，而在此產生失真的現象。

數學式<math>\omega_s>2\omega_n\,</math>即奈奎斯特準則

=== 音訊的例子 ===
在音訊的案例中我們可以比較電話(取樣8kHz)與CD(取樣44.1kHz)的差別。顯而易見電話中我們只能聽到較為低頻的聲音，而高頻的部分無法完整重現，而在CD中我們可以聽見弦樂、敲擊樂器等較為高頻的聲音。目前的技術標準中已有許多訂定取樣率為192kHz，如藍光光碟中的音訊、以及[[SACD|SACD]]。雖然高取樣率會造成檔案大小龐大，但能更完整的還原音訊。

== 數學上的解釋 ==
[[File:AliasedSpectrum.png|thumb]]（DTFT）時，其虛部（綠色部份）會和轉換後訊號（藍色部份）疊加。在這個假設的例子中，這兩個函數的離散傅立葉轉換相同，表示<u>取樣到的訊號也完全相同</u>，可是在取樣前的原函數是不同的。若這是聲音訊號，''x''(''t'')和''x''<sub>A</sub>(''t'')聽起來是不一樣的，可是其以''f''<sub>s</sub>的頻率取樣是一樣的，因此最後重制的聲音是相同的，因此我們可以說''x''<sub>A</sub>(''t'')是<math>x(T)</math>在此取樣頻率下的混疊（alias）]]

若<math>X(t)</math>為一函數(如圖所示)，其[[傅立葉轉換|傅立葉轉換]]<math>X(f)</math>為:

:<math>X(f)\ {=}\ \int_{-\infty}^{\infty} x(t) \ e^{- i 2 \pi f t} \ {\rm d}t,</math>

經由週期T的取樣後[[蒲松求和公式|蒲松求和公式]]指出<math>x(t)</math>的取樣<math>x(nT)</math>已以產生<math>X(f)</math>的{{le|週期和|periodic summation}}，結果為：

<math>X_s(f)\ {=} \sum_{k=-\infty}^{\infty} X\left(f - k f_s\right) = \sum_{n=-\infty}^{\infty} T\cdot x(nT)\ e^{-i 2\pi n T f},</math>


是一個週期函數，等效為[[傅立葉級數|傅立葉級數]]，係數為<math>T \cdot x(nT)</math>。此數列也稱作x的[[離散傅立葉轉換|離散傅立葉轉換]] (DTFT)，在此n為整數，代表第n個時刻。

如圖所示，<math>X(f)</math> 的影子(綠色部分)被平移了 ''f<sub>s</sub>'' 的倍數，並相加合併。如果奈奎斯特准則沒有被滿足，相鄰部分就會重疊，一般就不能完整還原出 <math>X(f)</math>。任何超过 ''f<sub>s</sub>''/2 的頻率分量都会與較低的頻率分量難以區分，這就稱作“混叠”。在这种情况下，通常的插值法就會產生混叠，而不是原始的分量了。

== 更好的取樣方式（濾波） ==
[[File:ReconstructFilter.png|thumb]]

考慮成本以及符合特定規範下(例如電話使用8kHz取樣頻率)，<math>X(f)</math>通常要先以[[低通濾波器|低通濾波器]]將高頻的分量减少到可以接受的大小，而[[低通濾波器|低通濾波器]]在此也稱作[[抗混叠濾波器|抗混叠濾波器]]。[[抗混叠濾波器|抗混叠濾波器]]可以使訊號滿足取樣定理的條件。這個方法在理論上是可行的，但是在實際情况中難以完美實現。因為濾波器不可能完全滤除[[奈奎斯特頻率|奈奎斯特頻率]]之上的訊號，必然會留下一些殘餘的能量，而且低通濾波器同時也會對部分取樣定理條件以下的訊號產生些微影響。


{{DSP}}

[[Category:數位訊號處理|Category:數位訊號處理]]

==參考文獻==
[[取樣定理|取樣定理]]
[[取樣率|取樣率]]