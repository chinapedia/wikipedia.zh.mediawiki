{{NoteTA
|G1=IT
|G2=Windows
}}
'''VxD'''是在[[Windows_2.1x|Microsoft Windows/386]]、[[Windows_3.x|Windows 3.x]]的386增强模式及[[Windows_9x|Windows 9x]]中使用的[[设备驱动程序|设备驱动程序]]模型，并在一定程度上被{{tsl|en|DR-DOS|Novell DOS 7}}、{{tsl|en|OpenDOS 7.01}}以及{{tsl|en|DR-DOS 7.02}}（及更高版本）多任务（<code>TASKMGR</code>）使用。<ref name="Paul_1997_NWDOSTIP">{{Cite book|url=http://www.antonis.de/dos/dos-tuts/mpdostip/html/nwdostip.htm|title=NWDOS-TIPs — Tips & Tricks rund um Novell DOS 7, mit Blick auf undokumentierte Details, Bugs und Workarounds|last=Paul|first=Matthias|date=1997-07-30|work=MPDOSTIP|accessdate=2014-09-06|edition=edition 3, release 157|language=de|type=e-book|archive-url=https://web.archive.org/web/20161104235829/http://www.antonis.de/dos/dos-tuts/mpdostip/html/nwdostip.htm|archive-date=2016-11-04|dead-url=yes}}</ref>VxDs可以访问[[内核|内核]]和所有运行中[[进程|进程]]的内存，以及对硬件的原始访问。

== 设计 ==
名称“VxD”是“虚拟xxx驱动程序”（virtual xxx driver）的[[缩写|缩写]]，其中“xxx”是一些硬件设备的类别。它本身源于Windows 3.x中以<code>vxxxd.386</code>作为文件名称的大多数驱动程序，例如：vjoyd.386（[[操纵杆|操纵杆]]）、vmm.386（内存管理器）。VxD在Windows 3.x下通常使用<code>.386</code>为[[文件扩展名|文件扩展名]]，在Windows 9x下则使用<code>.vxd</code>。为Windows 3.x编写的VxD可以在Windows 9x下使用，反之亦然。

== 历史 ==
在Windows出现前，[[DOS|DOS]]应用程序直接与各种硬件通信（响应[[中断|中断]]，读取和写入设备内存等）或通过DOS[[驱动程序|设备驱动程序]]通信。由于DOS不是[[多任务|多任务]]架构，每个应用程序将在运行时对硬件进行独占和完全的控制。虽然[[Windows|Windows]]应用程序通常不直接与硬件通信，但它是Windows驱动程序的唯一方法，并且在Windows 3.x中的真实和标准模式中仍是如此。

Windows/386及之后的系统允许多个DOS应用程序在自己的{{tsl|en|Virtual DOS machine|DOS虚拟机}}中并发执行。为在这些虚拟机之间共享物理资源，微软引入了虚拟设备驱动程序。这些驱动程序通过拦截对硬件的调用来解决与物理资源的使用冲突相关的问题。相较于实际设备的[[通訊埠|机器端口]]，它表示经由操作系统管理的“虚拟”设备。

== 过时 ==
尽管Windows 98引入了[[Windows_Driver_Model|Windows Driver Model]] (WDM)，VxD仍可在Windows 98和Windows Me上使用。VxD不能在[[Windows_NT|Windows NT]]及后续版本中使用。从Windows 2000开始，基于Windows NT的操作系统也使用Windows Driver Model，而Windows NT 4和更低版本必须使用专门为它们编写的驱动程序。在Windows 9x中使用VxD驱动程序而非WDM驱动程序将导致高级[[高级配置与电源接口|ACPI]] 状态（例如[[休眠_(電腦)|休眠]]）不可用。

VxD不应与类似的名称混淆。[[NTVDM|NTVDM]]专用的“VDD”（虚拟设备驱动程序）在Windows NT“DOS Box”下仿真直接I/O的方法NTVDM VDD作为常规的32位用户模式DLL运行，并且必须依靠Win32 API（或另一个WDM驱动程序）代表16位程序模拟所需的I/O。

== 参见 ==
* {{tsl|en|VXD (CONFIG.SYS directive)}}
* [[Windows_Driver_Model|Windows Driver Model]]（WDM）
* {{tsl|en|Architecture of Windows 9x|Windows 9x的架构}}

== 参考资料 ==
<references />

== 拓展阅读 ==
* {{Cite book|title=Unauthorized Windows 95 - Developer's Resource Kit|url=https://archive.org/details/unauthorizedwind00schu|date=November 1994|publisher={{tsl|en|John Wiley & Sons, Inc.}}|isbn=1-56884-305-4|edition=1st|location=Foster City, California, USA|id=ISBN 978-1-56884-305-6}}
* {{Cite book|title=Undocumented DOS: A programmer's guide to reserved MS-DOS functions and data structures - expanded to include MS-DOS 6, Novell DOS, and Windows 3.1|date=1994<!-- 1993? -->|publisher={{tsl|en|Addison Wesley}}|isbn=0-201-63287-X|edition=2nd|location={{tsl|en|Reading, Massachusetts}}|id=ISBN 978-0-201-63287-3}}
* {{Cite book|url=https://books.google.com/books/about/Programmer_s_Guide_to_Microsoft_Windows.html?id=MLZQAAAAMAAJ|title=Programmer's Guide to Microsoft Windows 95: Key Topics on Programming for Windows from the Microsoft Windows Development Team|last=<!-- staff writers -->|date=1995-07-01|work=Technical Reference|publisher=[[Microsoft_Press|Microsoft Press]]|isbn=1-55615-834-3|edition=1st|location=Redmond, Washington, USA|id=ISBN 978-1-55615-834-6}}
* {{Cite book|title=Systems Programming for Windows 95|date=1995|publisher=[[Microsoft_Press|Microsoft Press]]|isbn=1-55615-949-8|edition=1st|location=Redmond, Washington, USA|id=ISBN 978-1-55615-949-7}}
* {{Cite book|url=https://books.google.com/books/about/Windows_95_System_Programming_Secrets.html?id=E9Q7KAAACAAJ|title=Windows 95 System Programming Secrets|date=November 1995|work=The Secrets Series|publisher={{tsl|en|John Wiley & Sons, Inc.}}|isbn=1-56884-318-6|edition=1st|id=ISBN 978-156884-318-6}}
* {{Cite book|title=Writing Windows VxDs and Device Drivers - Programming Secrets for Virtual Device Drivers|date=1997|publisher={{tsl|en|R&D Boooks}} / {{tsl|en|Miller Freeman, Inc.}}|isbn=0-87930-438-3|edition=2nd printing, 2nd|location=Lawrence, Kansas, USA|id=ISBN 978-0-87930-438-6}}

{{Microsoft APIs}}

[[Category:驱动程序|Category:驱动程序]]
[[Category:微軟API|Category:微軟API]]
[[Category:Windows组件|Category:Windows组件]]