{{Expand English|PowerShell|time=2021-08-16T21:56:27+00:00}}
{{noteTA
|G1=IT
|G2=FL
}}
{{Infobox programming language
| name                   = PowerShell
| logo                   = PowerShell Core 6.0 icon.png
| screenshot             = PowerShell Core 7.1.5 with Windows Terminal.png
| screenshot caption     = 在[[Windows_Terminal|Windows Terminal]]内运行的PowerShell 7
| paradigm               = [[指令式編程|命令式]]、[[管道_(软件)|管道]]、[[面向对象程序设计|面向对象]]、[[函数编程语言|函数式]]、[[反射式编程|反射式]]
| released               = {{start date and age|2006|11|14}}
| designer               = {{link-en|杰弗里·史诺威|Jeffrey Snover}}（Jeffrey Snover）<br/>布鲁斯·帕耶特（Bruce Payette）<br/>詹姆斯·特鲁赫（James Truher） (et al.)
| developer              = [[微软|Microsoft]]
| latest release version ={{LSR/wikidata}}
| latest release date = 
| latest preview version = 
| latest preview date = 
| typing                 = [[強弱型別|强类型]]、[[类型安全|类型安全]]、[[类型推论|类型推论]]和[[动态类型|动态类型]]
| dialects               =
| influenced             =
| platform               = [[.NET框架|.NET Framework]], [[.NET_Core|.NET Core]]
| license                = [[MIT許可證|MIT許可證]]<ref>{{Cite web |url=https://github.com/PowerShell/PowerShell/blob/master/LICENSE.txt |title=PowerShell LICENSE |access-date=2017-06-10 |archive-date=2022-05-11 |archive-url=https://web.archive.org/web/20220511115840/https://github.com/PowerShell/PowerShell/blob/master/LICENSE.txt }}</ref>（但Windows组件仍然是[[专有软件|专有的]]）
| influenced_by          = [[KornShell|Ksh]]、[[Perl|Perl]]、{{tsl|en|C♯||C#}}、{{link-en|IBM i 控制语言|IBM i Control Language|CL}}、{{link-en|DIGITAL命令语言|DIGITAL Command Language|DCL}}、[[SQL|SQL]]、[[Tcl|Tcl]]、[[Tk|Tk]]、<ref name="snover2008">{{cite web|last = Snover|first = Jeffrey|title = PowerShell and WPF: WTF|date = 2008-05-25|url = https://blogs.msdn.microsoft.com/powershell/2008/05/25/powershell-and-wpf-wtf/|website = Windows PowerShell Blog|publisher = Microsoft|access-date = 2017-06-10|archive-date = 2019-01-08|archive-url = https://web.archive.org/web/20190108162204/https://blogs.msdn.microsoft.com/powershell/2008/05/25/powershell-and-wpf-wtf/}}</ref>{{tsl|en|Chef||Chef}}、[[Puppet|Puppet]]
| operating_system       = [[Windows_7|Windows 7]]及其后续版本、[[Linux|Linux]]、[[macOS|macOS]]
| genre                  = [[殼層|殼層]]、[[組態管理|組態管理]]
| file extensions        = {{Plainlist|
*.ps1 (脚本文件)
*.ps1xml（XML文档）
*.psc1（控制台文件）
*.psd1（数据文件）
*.psm1（脚本模块）
*.pssc（会话配置文件）
*.cdxml (Cmdlet定义的XML文档)
  }}
}}

'''PowerShell'''（包括'''Windows PowerShell'''和'''PowerShell Core'''）是[[微軟公司|微軟公司]]开发的任务自动化和[[組態管理|組態管理]]架構，由[[.NET_Framework|.NET Framework]]和[[.NET_Core|.NET Core]]构建的[[命令行界面|命令行界面]][[殼層|殼層]]相关脚本语言组成，最初僅僅是[[Windows|Windows]]元件，后于2016年8月18日[[开放源代码|开源]]并提供[[跨平台|跨平台]]支持。<ref name=ars-opensource>{{cite web|last1=Bright|first1=Peter|title=PowerShell is Microsoft's latest open source release, coming to Linux, OS X|url=http://arstechnica.com/information-technology/2016/08/powershell-is-microsofts-latest-open-source-release-coming-to-linux-os-x/|website=[[Ars_Technica|Ars Technica]]|publisher=[[康泰纳仕|Condé Nast]]|date=2016-08-18|access-date=2017-06-10|archive-date=2022-04-28|archive-url=https://web.archive.org/web/20220428143534/https://arstechnica.com/information-technology/2016/08/powershell-is-microsofts-latest-open-source-release-coming-to-linux-os-x/}}</ref>

在PowerShell中，管理任务通常由cmdlets（发音为command-lets）执行，这是执行特定操作的专用.NET[[类_(计算机科学)|类]]。可以将cmdlet集合至脚本、可执行文件（一般是独立应用程序）中，或通过常规.NET类（或WMI / COM对象）实例化。<ref name="how">{{cite web | url = http://msdn2.microsoft.com/en-us/library/ms714658.aspx | title = How Windows PowerShell works | website = [[Microsoft_Developer_Network|Microsoft Developer Network]] | publisher = [[微软|Microsoft]] | accessdate = 2007-11-27 | archive-date = 2008-09-05 | archive-url = https://web.archive.org/web/20080905054903/http://msdn2.microsoft.com/en-us/library/ms714658.aspx }}</ref><ref name="MSDN">{{cite magazine | last=Truher | first=Jim | date=December 2007 | url=https://msdn.microsoft.com/en-us/magazine/cc163293.aspx | title=Extend Windows PowerShell With Custom Commands | work=[[微软开发者网络|MSDN Magazine]] | publisher=Microsoft | archiveurl=https://web.archive.org/web/20081006195551/http://msdn.microsoft.com/en-us/magazine/cc163293.aspx | archivedate=2008-10-06 | access-date=2017-06-10 | dead-url=no }}</ref>

== 源起與目的 ==
[[UNIX|UNIX]]系統一直有著功能強大的殼程式（[[殼層|shell]]），Windows PowerShell的誕生就是要提供功能相當於UNIX系統的命令列殼程式（例如：[[Bourne_shell|sh]]、{{tsl|en|bash||bash}}或[[C_Shell|csh]]），同時也內建腳本語言以及輔助腳本程式的工具。

== 程式特性 ==
* 一致性的設計讓所有工具和系統資料的使用語法、命名原則都相同。
* 腳本語言簡單易學，而且能支援現有的腳本程式和命令列工具。
* 內含129種稱為cmdlet的標準工具，可用來處理常見的系統管理工作。
* 具備完整的擴充功能，獨立軟體商或開發者都能很容易的自行擴充。
* 进程间数据传递内容具有强类型特征。
* PowerShell Core可以自動檢測字符編碼，自動識別Linux和Windows下的換行符，跨平台运行。

cmdlet是Windows PowerShell的指令，發音唸法為command-let。這相當於[[DOS|DOS]]或其他殼程式的內建指令，指令名稱的格式都是以[[連字號|連字號]]（-）隔開的一對[[動詞|動詞]]和[[名詞|名詞]]，並且通常都是[[單數_(語言學)|單數]]名詞；例如線上查詢說明的cmdlet指令為get-help，名稱的動詞部分大致有get、set、add、remove等等（字母都不分大小寫）。

Windows PowerShell ISE是Windows PowerShell的主机应用程序。在此程序中，可以在单个Windows GUI中运行命令、编辑与测试脚本。此程序具有多行编辑、Tab补齐、上下文相关帮助、语法着色、选择性执行等功能，而且还支持从右到左的书写顺序等功能。

== 技術基礎 ==
Windows PowerShell是以[[.NET_Framework|.NET Framework]]技術為基礎，並且與現有的{{tsl|en|WSH||WSH}}保持回溯相容，因此它的腳本程式不僅能存取.NET CLR，也能使用現有的{{tsl|en|COM||COM}}技術。同時也包含了數種系統管理工具、簡易且一致的語法，常見如登錄資料庫、WMI。Exchange Server 2007以及System Center Operations Manager 2007等伺服器軟體都將內建Windows PowerShell。

== 範例 ==

* 停止所有目前執行中的以"p"字元開頭命名的程式：
<syntaxhighlight lang="powershell">
get-process p* | stop-process
</syntaxhighlight>

* 停止所有目前執行中的所有使用大於1000MB記憶體的程式：
<syntaxhighlight lang="powershell">
get-process | where { $_.WS -gt 1000MB } | stop-process
</syntaxhighlight>

* 計算一個目錄下檔案內的位元組大小：
<syntaxhighlight lang="powershell">
get-childitem | measure-object -property length -sum
</syntaxhighlight>

* 將"hello, world!"字串轉為英文大寫字元，成為"HELLO, WORLD!"：
<syntaxhighlight lang="powershell">
"hello, world!".ToUpper()
</syntaxhighlight>

* 訂閱一個指定的RSS Feed並顯示它最近8個主題：
<syntaxhighlight lang="powershell">
$rssUrl = "http://blogs.msdn.com/powershell/rss.aspx"
$blog = [xml](new-object System.Net.WebClient).DownloadString($rssUrl)
$blog.rss.channel.item | select title -first 8
</syntaxhighlight>

=== 命令提示字元比较 ===
{| class="wikitable plainrowheaders" style="width: 100%; text-align: center; font-size: small;"
|+PowerShell命令行與其他命令行解釋器的內部和外部命令的比較
|-
! scope="col" | PowerShell（命令行）
! scope="col" | PowerShell（別名）
! scope="col" | [[命令提示符|命令提示符]]<!--不是 [[COMMAND.COM|COMMAND.COM]]! 这里有太多东西不适用于 COMMAND.COM.-->
! scope="col" | [[Unix_shell|Unix shell]]
! scope="col" | 描述
|-
! scope="row" | Get-ChildItem
|gci, dir, ls
|[[Dir_(命令)|dir]]
|[[ls|ls]]
|列出目前或指定資料夾中的所有檔案和資料夾
|-
! scope="row" | Test-Connection{{efn|1=尽管外部[[ping|ping]]命令仍可用於PowerShell，但“Test-Connection”的输出是一个可以通过编程来检查的结构化[[对象_(计算机科学)|对象]]。
<br />
While the external ping command remains available to PowerShell, Test-Connection's output is a structured object that can be programmatically inspected.<ref>{{cite web|title=Test-Connection|url=https://technet.microsoft.com/en-us/library/hh849808.aspx|website=PowerShell documentations|publisher=[[微软|微软]]|date=9 August 2015|access-date=2019-12-18|archive-date=2016-10-31|archive-url=https://web.archive.org/web/20161031104550/https://technet.microsoft.com/en-us/library/hh849808.aspx}}</ref>}}
|[[ping|ping]]
|[[ping|ping]]
|[[ping|ping]]
|從目前電腦向指定電腦傳送[[Ping|Ping]]，或指示另一台電腦這樣做
|-
! scope="row" | Get-Content
|gc, type, cat
|{{tsl|en|TYPE (DOS command)||type}}
|[[Cat_(Unix)|cat]]
|取得檔案內容
|-
! scope="row" | Get-Command
|gcm
|{{tsl|en|help (command)||help}}
|{{tsl|en|type (Unix)||type}}, {{tsl|en|which (command)||which}}, [[compgen_(Unix)|compgen]]
|列出可用的命令
|-
! scope="row" | Get-Help
|help, man
|{{tsl|en|help (command)||help}}
|{{tsl|en|apropos (Unix)||apropos}}, [[手册页|man]]
|在控制台上打印命令的文档
|-
! scope="row" | Clear-Host
|cls, clear
|{{tsl|en|cls (computing)||cls}}
|[[Clear_(Unix)|clear]]
|清除屏幕{{efn|Clear-Host被實現為預定義的PowerShell功能。}}
|-
! scope="row" | Copy-Item
|cpi, copy, cp
|[[Copy_(命令)|copy]], {{tsl|en|xcopy|}}, {{tsl|en|robocopy|}}
|[[Cp_(Unix)|cp]]
|將檔案和資料夾複製到另一個位置
|-
! scope="row" | Move-Item
|mi, move, mv
|{{tsl|en|move (command)||move}}
|[[Mv_(Unix)|mv]]
|將檔案和資料夾移動到新位置
|-
! scope="row" | Remove-Item
|ri, del, erase, rmdir, rd, rm
|{{tsl|en|del (command)||del}}, {{tsl|en|del (command)||erase}}, [[rmdir|rmdir]], [[Rmdir|rd]]
|[[Rm_(Unix)|rm]], rmdir
|刪除檔案或資料夾
|-
! scope="row" | Rename-Item
|rni, ren, mv
|{{tsl|en|ren (command)||ren}}, rename
|[[Mv_(Unix)|mv]]
|重命名單個檔案、資料夾、硬連結或符號連結
|-
! scope="row" | Get-Location
|gl, cd, pwd
|[[Cd_(命令)|cd]]
|[[pwd|pwd]]
|顯示工作路徑（目前資料夾）
|-
! scope="row" | Pop-Location
|popd
|{{tsl|en|pushd and popd||popd}}
|popd
|將工作路徑更改為最近推送到堆疊上的位置
|-
! scope="row" | Push-Location
|pushd
|{{tsl|en|pushd and popd||pushd}}
|pushd
|將工作路徑儲存到堆疊中
|-
! scope="row" | Set-Location
|sl, cd, chdir
|[[Cd_(命令)|cd]], [[Cd_(命令)|chdir]]
|cd
|改變工作路徑
|-
! scope="row" | Tee-Object
|tee
|{{n/a}}
|[[tee|tee]]
|將輸入管道傳輸到檔案或變數，並沿管道傳遞輸入
|-
! scope="row" | Write-Output
|echo, write
|[[Echo_(命令)|echo]]
|echo
|將字符串或其他對像打印到[[標準串流|標準串流]]
|-
! scope="row" | Get-Process
|gps, ps
|tlist,{{efn|name="Available tlist kill"|1=Available in Windows NT4, Windows 98 Resource Kit, Windows 2000 Support Tools}} {{tsl|en|tasklist|}}{{efn|name="Available tasklist taskkill"|1=Available in Windows XP Professional Edition and later}}
|[[Ps_(Unix)|ps]]
|列出所有正在執行的處理程序
|-
! scope="row" | Stop-Process
|spps, kill
|{{tsl|en|kill (command)||kill}},{{efn|name="Available tlist kill"}} [[Kill_(命令)|taskkill]]{{efn|name="Available tasklist taskkill"}}
|kill{{efn|name="UNIX kill misnomer"|1=Also used in UNIX to send a process any [[Unix信号|signal]], the "Terminate" signal is merely the default}}
|停止正在執行的處理程序
|-
! scope="row" | Select-String
|sls
|[[findstr|findstr]]
|[[find|find]], [[grep|grep]]
|打印与模式匹配的-{zh-tw:列;zh-cn:行;}-
|-
! scope="row" | Set-Variable
|sv, set
|{{tsl|en|Environment variable#DOS||set}}
|env, export, set, setenv
|创建或更改[[环境变量|环境变量]]的內容
|-
! scope="row" | Invoke-WebRequest
|iwr, <s>curl, wget</s>{{efn|<code>curl</code> and <code>wget</code> aliases are absent from PowerShell Core, so as to not interfere with invoking similarly named native commands.}}
|[[CURL|curl]]
|[[wget|wget]], curl
|取得互联网上的网页內容
|}
{{notelist}}

== 參考文獻 ==
{{reflist}}

== 擴展閱讀 ==
* {{Cite book |title=Monad (AKA PowerShell) |first=Andy |last=Oakley |isbn=0-596-10009-4 |year=2005 |publisher=[[歐萊禮|O'Reilly Media]]}}
* {{Cite book |title=Windows PowerShell Quick Reference |first=Lee |last=Holmes |isbn=0-596-52813-2 |publisher=[[歐萊禮|O'Reilly Media]] |year=2006}}
* {{Cite book |title=Windows PowerShell Cookbook |first=Lee |last=Holmes |isbn=0-596-52849-3 |publisher=[[歐萊禮|O'Reilly Media]] |year=2007}}
* {{Cite book |title=Professional Windows PowerShell |first=Andrew |last=Watt |isbn=0-471-94693-1 |year=2007 |publisher={{link-en|Wrox Press|Wrox Press}}}}
* {{Cite book |last=Kumaravel |first=Arul |first2=Jon |last2=White |first3=Michael |last3=Naixin Li |first4=Scott |last4=Happell |first5=Guohui |last5=Xie |first6=Krishna C. |last6=Vutukuri |title= Professional Windows PowerShell Programming: Snapins, Cmdlets, Hosts and Providers |isbn= 0-470-17393-9 |year=2008 |publisher={{link-en|Wrox Press|Wrox Press}}}}
* {{Cite book |title=Windows PowerShell Unleashed |first=Tyson |last=Kopczynski |first2=Pete |last2=Handley |first3=Marco |last3=Shaw |isbn=978-0-672-32988-3 |edition=2nd |year=2009 |publisher=[[培生教育|Pearson Education]]}}
* {{Cite book |title=Windows PowerShell 2.0: TFM |url=https://archive.org/details/windowspowershel0000jone |first=Don |last=Jones |first2=Jeffery |last2=Hicks |isbn=978-0-9821314-2-8 |year=2010 |edition=3rd |publisher=Sapien Technologies}}
* {{Cite book |title=Windows PowerShell for Developers |first=Douglas |last=Finke |isbn=1-4493-2270-0 |year=2012 |publisher=[[歐萊禮|O'Reilly Media]]}}
* {{Cite book |title=Windows PowerShell 3.0 Step by Step |first=Ed |last=Wilson |isbn=978-0-7356-6339-8 |publisher=[[微软出版社|Microsoft Press]] |year=2013}}
* {{cite book |title=Windows PowerShell Best Practices |last=Wilson |first=Ed |publisher=[[微软出版社|Microsoft Press]] |isbn=978-0-7356-6649-8 |year=2014}}

== 外部連結 ==
;微软官网
* [https://docs.microsoft.com/zh-tw/powershell/scripting/how-to-use-docs 如何使用 PowerShell 文件 - PowerShell | Microsoft Docs]
* [https://github.com/PowerShell/PowerShell GitHub - PowerShell/PowerShell: PowerShell for every system!] {{Wayback|url=https://github.com/PowerShell/PowerShell |date=20200514210658 }}
* [https://technet.microsoft.com/zh-tw/library/dd125460.aspx 易學易用的Windows PowerShell] {{Wayback|url=https://technet.microsoft.com/zh-tw/library/dd125460.aspx |date=20180108233506 }}
* [https://channel9.msdn.com/Series/GetStartedPowerShell3 MSDN视频教程] {{Wayback|url=https://channel9.msdn.com/Series/GetStartedPowerShell3 |date=20210716070446 }}

;其他
* {{GitHub|PowerShell/PowerShell}}
* {{tsl|en|TechNet||TechNet}}[[維基|維基]]：[http://social.technet.microsoft.com/wiki/contents/articles/183.windows-powershell-survival-guide-en-us.aspx Windows PowerShell Survival Guide] {{Wayback|url=http://social.technet.microsoft.com/wiki/contents/articles/183.windows-powershell-survival-guide-en-us.aspx |date=20120915113215 }}

{{-}}
{{視窗元件}}
{{Microsoft APIs}}
{{DotNET}}
{{Microsoft development tools}}
{{程序设计语言}}

[[Category:.NET编程语言|Category:.NET编程语言]]
[[Category:動態編程語言|Category:動態編程語言]]
[[Category:直譯器|Category:直譯器]]
[[Category:Windows管理|Category:Windows管理]]
[[Category:面向对象的编程语言|Category:面向对象的编程语言]]
[[Category:过程式编程语言|Category:过程式编程语言]]
[[Category:脚本语言|Category:脚本语言]]
[[Category:面向文本编程语言|Category:面向文本编程语言]]
[[Category:命令壳层|Category:命令壳层]]
[[Category:2006年建立的程式語言|Category:2006年建立的程式語言]]