{{noteTA
|1=zh:表示层; zh-hans:表示层; zh-hant:展現層;
|2=zh:会话层; zh-hans:会话层; zh-hant:會談層;
|3=zh:网络层; zh-hans:网络层; zh-hant:網路層;
|4=zh:数据链路层; zh-hans:数据链路层; zh-hant:資料鏈結層;
|5=zh:物理层; zh-hans:物理层; zh-hant:實體層;
|6=zh-hans:应用程序; zh-hant:應用程式;
|7=zh-hans:过程控制; zh-hant:程序控制;
|G1=IT
|G2=通訊學
|G3=Unit
}}
{{Infobox Fieldbus Protocol
| Name = PROFIBUS
| Type_of_Network = 設備網路、[[程序控制|程序控制]]
| Physical_Media = [[雙絞線|雙絞線]]、光纖
| Network_Topology = 匯流排（Bus）
| Device_Addressing = [[指撥開關|指撥開關]]或使用硬體/軟體
| Governing_Body = PROFIBUS & PROFINET International (PI)
| URL = [http://www.profibus.com/ www.profibus.com]
}}
[[File:0x-pb-stecker-verschieden.jpg|thumb]]
'''PROFIBUS'''是一個用在[[自動化技術|自動化技術]]的[[現場總線|現場總線]]標準，在1987年由德國[[西门子公司|西门子公司]]等十四家公司及五個研究機構所推動<ref name="history">{{Cite web
|url= http://www.cechina.cn/Company/21501_136302/messagedetail.aspx
|title= PROFIBUS 20年回顾：从科研项目到世界市场的主导者
|date= 2009-08-03
|accessdate= 2010-12-14
|publisher= 控制工程網
|archive-date= 2015-09-14
|archive-url= https://web.archive.org/web/20150914221926/http://www.cechina.cn/Company/21501_136302/messagedetail.aspx
|dead-url= no
}}</ref>，PROFIBUS是程序總線網路（'''PRO'''cess '''FI'''eld '''BUS'''）的簡稱<ref name="fieldbus">{{cite book
  | author = 李正軍
  | title = 《現場總線及其應用技術》
  | publisher = 機械工業出版社
  | year = 2005
  | pages = p301-326
  | isbn = 7-111-15510-6
}}</ref>。PROFIBUS和用在[[工業乙太網路|工業乙太網路]]的[[PROFINET|PROFINET]]是二種不同的通訊協定。

== 起源 ==
PROFIBUS的歷史可追溯到1987年聯邦德國開始的一個合作計劃，此計劃有十四家公司及五個研究機構參與，目標是要推動一種串列現場總線，可滿足現場設備介面的基本需求。為了這個目的，參與的成員同意支持有關工廠生產及程序自動化的共通技術研究<ref name="history"/>。

PROFIBUS中最早提出的是PROFIBUS FMS（FMS代表Field bus Message Specification）<ref>{{Cite web
|url= http://a.gongkong.com/sort/bus/profibus/standard_detail.asp?id=2
|title= PROFIBUS标准
|accessdate= 2010-12-14
|publisher= 中國工控網
|archive-date= 2012-04-14
|archive-url= https://web.archive.org/web/20120414020927/http://a.gongkong.com/sort/bus/profibus/standard_detail.asp?id=2
|dead-url= no
}}</ref>，是一個複雜的通訊協定，為要求嚴苛的通信任務所設計，適用在车间级通用性通信任务<ref>{{Cite web|author=陈景文|url=http://www.autooo.net/html/Bus/bus-use/2007-3/24/0732412422.html|title=PROFIBUS总线通信协议在造纸中的应用|date=2007-03-24|accessdate=2010-12-14|publisher=自動化在線|deadurl=yes|archiveurl=https://web.archive.org/web/20111101123930/http://autooo.net/html/Bus/bus-use/2007-3/24/0732412422.html|archivedate=2011-11-01}}</ref>。後來在1993年提出了架構較簡單，速度也提昇許多的PROFIBUS DP（DP代表Decentralized Peripherals）。PROFIBUS FMS是用在PROFIBUS主站之間的非確定性通訊。PROFIBUS DP主要是用在PROFIBUS主站和其遠端從站之間的確定性通訊，但仍允許主站及主站之間的通訊。

目前的PROFIBUS可分為二種，分別是大多數人使用的PROFIBUS DP和用在过程控制的PROFIBUS PA：
* '''PROFIBUS DP'''（分散式週邊，Decentralized Peripherals）用在工廠自動化的應用中，可以由中央控制器控制許多的感測器及致動器，也可以利用標準或選用的診斷機能得知各模組的狀態。
* '''PROFIBUS PA'''（过程自動化，Process Automation）應用在過程自動化系統中，由过程控制系統監控量測設備控制，是[[本質安全|本質安全]]的通訊協定<ref name="fieldbus"/>，可適用於防爆區域（工业防爆危险区分类中的Ex-zone 0及Ex-zone 1）。其物理層（纜線）符合IEC 61158-2，允許由通訊纜線提供電源給現場設備，即使在有故障時也可限制電流量，避免製造可能導致爆炸的情形。因為使用網路供電，一個PROFIBUS PA網路所能連接的設備數量也就受到限制。PROFIBUS PA的通訊速率為31.25 kbit/s。PROFIBUS PA使用的通訊協定和PROFIBUS DP相同，只要有轉換裝置就可以和PROFIBUS DP網路連接，由速率較快的PROFIBUS DP作為網路主幹，將信號慱遞給控制器。在一些需要同時處理自動化及程序控制的應用中就可以同時使用PROFIBUS DP及PROFIBUS PA。

2009年底時PROFIBUS網路上的設備已經有三千萬個，其中五百萬個設備是用在程序控制。

==技術==

<center> 
'''PROFIBUS通訊協定（[[OSI模型|OSI模型]]）'''
{| border="0" cellspacing="3"
|-----
! colspan="2" | OSI模型
! colspan="3" align="center" | PROFIBUS
|-----
| align="center" bgcolor="#ffff99" | 7
| align="center" bgcolor="#ffff99" | 應用層
| align="center" bgcolor="#ffcc99" | DPV0
| align="center" bgcolor="#ffcc99" | DPV1
| align="center" bgcolor="#ffcc99" | DPV2
| rowspan="7" align="center" bgcolor="#cccccc" | 網路管理
|-----
| align="center" bgcolor="#ffff99" | 6
| align="center" bgcolor="#ffff99" | 表示層
| colspan="3" rowspan="4" align="center" bgcolor="#dddddd" | --
|-----
| align="center" bgcolor="#ffff99" | 5
| align="center" bgcolor="#ffff99" | 會談層
|-----
| align="center" bgcolor="#ffff99" | 4
| align="center" bgcolor="#ffff99" | 傳播層
|-----
| align="center" bgcolor="#ffff99" | 3
| align="center" bgcolor="#ffff99" | 網路層
|-----
| align="center" bgcolor="#ffff99" | 2
| align="center" bgcolor="#ffff99" | 資料鏈結層
| colspan="3" align="center" bgcolor="#ffcc99" | FDL
|-----
| align="center" bgcolor="#ffff99" | 1
| align="center" bgcolor="#ffff99" | 物理層
| align="center" bgcolor="#ffcc99" | [[EIA-485|EIA-485]]
| align="center" bgcolor="#ffcc99" | 光纖
| align="center" bgcolor="#ffcc99" | MBP*
|}
<br />
</center>

備註：*MBP為曼彻斯特总线电力传输（Manchester Bus Powered）的縮寫。

=== 應用層 ===
為了有效利用PROFIBUS DP的機能，PROFIBUS DP定義了幾種不同的服務等級：
* DP-V0：循環式的資料交換，診斷機能。
* DP-V1：循環式及非循環式的資料交換，警告處理。
* DP-V2：{{le|時鐘同步數據|isochronous}}模式，從機和從機之間的資料廣播。

=== 資料鏈結層 ===
資料鏈結層'''FDL'''（總線資料鏈結層）混合了一般主站（master）－從站（slave）之間的通訊及[[令牌傳遞|令牌傳遞]]的訊息。在PROFIBUS網路中，控制器或控制系統為主站，感測器及致動器為從站。

傳送的訊息不止一種，依其起始字元（start delimiter, SD）可以識別是哪一種訊息：
<ref name="fieldbus"/>

無資料：SD1 = 0x10
{| border = "1"
|bgcolor="#ffff99"|SD1
|bgcolor="#ffcc99"|DA
|bgcolor="#ffcc99"|SA
|bgcolor="#77ffff"|FC
|bgcolor="#ff7777"|FCS
|bgcolor="#ffff99"|ED
|}

變動長度資料：SD2 = 0x68
{| border = "1"
|bgcolor="#ffff99"|SD2||LE||LEr||bgcolor="#ffff99" |SD2
|bgcolor="#ffcc99"|DA
|bgcolor="#ffcc99"|SA
|bgcolor="#77ffff"|FC
|bgcolor="#99ff99"|DSAP
|bgcolor="#99ff99"|SSAP
||PDU
|bgcolor="#ff7777"|FCS
|bgcolor="#ffff99"|ED
|}

固定長度資料：SD3 = 0xA2
{| border = "1"
|bgcolor="#ffff99"|SD3
|bgcolor="#ffcc99"|DA
|bgcolor="#ffcc99"|SA
|bgcolor="#77ffff"|FC
||PDU
|bgcolor="#ff7777"|FCS
|bgcolor="#ffff99"|ED
|}

令牌（Token）：SD4 = 0xDC
{| border = "1"
|bgcolor="#ffff99"|SD4
|bgcolor="#ffcc99"|DA
|bgcolor="#ffcc99"|SA
|bgcolor="#ffff99"|ED
|}

簡單的收到告知（acknowledgement）：SC = 0xE5
{| border = "1"
|bgcolor="#ffff99"|SC
|}

SD:起始字元

LE:協定資料單位（protocol data unit, PDU）及DA、SA、FC、DSAP及SSAP所有資料的長度

LEr:重複LE的內容（因PROFIBUS的[[漢明距離|漢明距離]]HD=4，不在FCS檢查碼範圍內的資料需重覆一次，因此需重複LE內容）

FC:功能碼

DA：目的設備位址

SA：來源設備位址

DSAP：目的設備的{{le|服務點|Service Access Point}}（SAP）

SSAP：來源設備的服務點

{| class="wikitable" border="1"
|-
! SAP（十進位）
! 服務
|-
| 預設值0
| 循環資料交換（Write_Read_Data）
|-
| 54
| 主站至主站服務點（M-M Communication）
|-
| 55
| 更改從站位址（Set_Slave_Add）
|-
| 56
| 讀取輸入（Rd_Inp）
|-
| 57
| 讀取輸出（Rd_Outp）
|-
| 58
| 給DP從站的控制命令（Global_Control）
|-
| 59
| 讀取組態（Configuration）資料（Get_Cfg）
|-
| 60
| 讀取診斷資料（Slave_Diagnosis）
|-
| 61
| 寫入參數設定資料（Set_Prm）
|-
| 62
| 檢查組態資料（Chk_Cfg）
|}

除了SAP55之外的其他服務點都是必備的，若設備中沒有[[非揮發性記憶體|非揮發性記憶體]]，可以不支援更改從站位址的SAP55服務。

PDU: [[協議數據單元|協議數據單元]]（Protocol Data Unit）

FCS:框架檢查碼，是直接將訊息中的位元組相加而得，包括PDU、DA、SA、FC、DSAP及SSAP，不考慮溢位。

ED:結束字元，為0x16

傳送位元組時使用非同步的傳送模式，[[奇偶校驗位|奇偶校驗位]]為偶校驗位，啟始位元及停止位元均為1個。當傳送資料時在位元組的停止位元跟下一位元組的啟始位元之間不能有停頓。主站在檢測網路上至少33位元沒有資料（為邏輯狀態1）時，會送出一筆新的訊息。

=== 位元傳輸層 ===
位元傳輸層有三種不同的傳輸方式：
* 若依據[[EIA-485|EIA-485]]規範（舊稱「RS-485」或「RS485」）的電氣傳輸方式<ref>{{cite web|url=http://www.eettaiwan.com/ART_8800495708_644847_TA_241664a7.HTM|title=PROFIBUS工業網路介紹|date=2007-12-29|accessdate=2016-03-14|publisher=UBM Asia 香港商亞洲博聞有限公司台灣分公司|work=EE Times電子工程專輯|archive-url=https://web.archive.org/web/20090717112051/http://www.eettaiwan.com/ART_8800495708_644847_TA_241664a7.HTM|archive-date=2009-07-17|dead-url=yes}}</ref>，會使用阻抗150[[歐姆|歐姆]]的雙絞線，位元速率範圍可以從9.6 kbit/s到12 Mbit/s。兩台[[中繼器|中繼器]]之間的網路線長也有限制，隨[[比特率|-{zh-cn:比特率;zh-tw:位元速率;}-]]的不同，上限從100公尺到1200公尺。這種傳輸方式主要配合PROFIBUS DP使用。
* 若使用[[光纖|光纖]]做為[[介質|介質]]傳輸，可以使用[[星型网|星型]]、[[匯流排拓撲|匯流排]]（bus）或是環型的[[網路拓撲|網路拓撲]]，兩台[[中繼器|中繼器]]之間的網路線長也可以到15公里，也可以使用環型網路拓撲以冗餘的方式使用網路，即使網路中有一點損壞，仍然可以正常的運作。
* 若使用「曼彻斯特总线电力传输」（Manchester Bus Powered，MBP）的传输方式，網路上不但有訊號，也可提供設備電源。因為這種傳輸方式可以減少設備消耗的功率，因此可以在防爆需求的場合下使用。其匯流排拓撲最長可以到1900公尺，而且允許有60公尺的網路枝連接到設備，其位元固定為31.25kbit/s，此傳輸方式特別為用在程序控制的PROFIBUS PA所設計。

許多廠商的產品可以在移動設備或是無線資料傳輸的場合使用PROFIBUS，不過這些產品還沒有對應的技術標準。

== 應用行規 ==
應用行規（profile）是PROFIBUS為了特殊的應用或設備，所事先定義的組態，其中包括特殊的功能及特徵。<ref name="Popp">{{cite book
  | author = Manfred Popp
  | title = 《The New Rapid Way to PROFIBUS-DP》
  | publisher = PROFIBUS Nutzerorganisation e.V
  | year = 2003
  | pages = p139
}}</ref>應用行規是由PROFIBUS國際組織（PROFIBUS international,PI）的各工作小組所訂定，由PROFIBUS國際組織所發佈。應用行規讓使用者可以確定不同廠商提供的類似設備可以有一致的機能，對產品的開放性、互操作性及互換性都很重要。使用者的選擇空間變大，也驅使設備廠商提升產品性能及減低成本。

目前已有許多PROFIBUS的應用行規，例如針對編碼器、量測設備、智慧型泵、機器人及數控工具機等應用行規。也有針對特殊應用的應用行規，如針對[[HART|HART]]、無線PROFIBUS及在程序自動化設備中使用PROFIBUS PA的應用行規。其他的應用行規包括[[運動控制|運動控制]]的PROFIdrive及[[功能安全|功能安全]]（Functional Safety）的PROFIsafe。

== 標準 ==
PROFIBUS在1991/1993年成為德國工業標準DIN 19245，在1996年成為歐洲標準EN 50170 V.2，在1996年成為現場總線國際標準IEC 61158/IEC 61784的組成部份（TYPE 3）。在2006年PROFIBUS也成為中华人民共和国的機械工業GB/T20540-2006。
<ref name="fieldbus"/>

== 組織 ==
PROFIBUS用戶組織（{{lang|de|PROFIBUS Nutzerorganisation e.V}}，簡稱PNO）在1989年成立。這個組織主要是由歐洲的PROFIBUS製造商及用戶所組成。在1992年成立了第一個地区性用户组织（PROFIBUS Schweiz in Switzerland），後來也各地區的地区性用户组织（RPAs）也相繼成立。

在1995年所有的地区性用户组织整合成一個國際性的傘狀組織PROFIBUS & PROFINET國際協會（{{lang|en|PROFIBUS & PROFINET International}}, PI）。至2010年為止，PROFIBUS在全世界有25個地区性用户组织（包括PNO），超過1400個成員<ref>{{Cite web
|url= http://www.profibus.com/community/members/
|title= A COMMUNITY OF 1400
|accessdate= 2010-12-13
|publisher= PROFIBUS & PROFINET international
|archive-date= 2010-12-13
|archive-url= https://web.archive.org/web/20101213071252/http://www.profibus.com/community/members/
|dead-url= no
}}</ref>，包括許多重要的自動化設備服務的廠商及許多終端客戶。

== 參考資料 ==
{{reflist}}

== 參照 ==
* [[現場總線|現場總線]]
* [[自動化通訊協定列表|自動化通訊協定列表]]

== 外部連結 ==
* [http://www.profibus.com PROFIBUS & PROFINET International]{{Wayback|url=http://www.profibus.com/ |date=20101215135045 }}
* [https://web.archive.org/web/20090717112051/http://www.eettaiwan.com/ART_8800495708_644847_TA_241664a7.HTM 電子工程專輯PROFIBUS工業網路介紹]

{{自動化通訊協定}}

[[Category:自動控制|Category:自動控制]]
[[Category:串行总线|Category:串行总线]]
[[Category:工業自動化|Category:工業自動化]]