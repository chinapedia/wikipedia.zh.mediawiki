try {
    var ref, loc;
    try {
        ref = new mw.Uri( document.referrer );
    } catch ( e ) {
        ref = new mw.Uri( document.referrer + '/' );
    }
    loc = new mw.Uri( location.href );
    if (/\.google\./.test(ref.host) && /^\/zh(-[^/]+)?\//.test(loc.path)) {
        loc.path = loc.path.replace(/^\/zh(-[^/]+)?\//, "/wiki/");
        location.replace(loc.toString());
    }
} catch ( e ) {
}