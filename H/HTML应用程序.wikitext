{{noteTA
|G1=IT
}}
{{copyedit|time=2018-10-01T06:23:26+00:00}}
{{roughtranslation|time=2018-10-01T06:23:26+00:00}}
: 本文介绍的为[[微软|微软]]的专利HTA實作。有关HTML5的缓存清单信息(Cache Manifest)，请参考 {{link-en|Cache manifest in HTML5}}。
{{ Infobox file format
| name                   = HTML Application (HTA)
| icon                   = 
| logo                   = 
| screenshot             = 
| caption                = 
| extension              = <tt>.hta</tt>
| mime                   = application/hta
| typecode               = 
| uniform type           = 
| magic                  = <code>%hta</code>
| owner                  = [[Microsoft|Microsoft]]
| released               = {{Start date|1999|4|23|df=yes}}
| latest release version = 
| latest release date    = <!-- {{Start date and age|YYYY|<mm>|dd|df=yes}} -->
| genre                  = 
| container for          = 
| contained by           = 
| extended from          = 
| extended to            = 
| standard               = 
| free                   = 
| url                    = https://msdn.microsoft.com/en-us/library/ms536471(VS.85).aspx
}}

'''HTML應用程式'''（{{lang-en|HTML Application}}，缩写：'''HTA'''）是一个使用[[HTML|HTML]]和动态 HTML的[[Microsoft_Windows|Microsoft Windows]]应用程式，它由[[Internet_Explorer|Internet Explorer]]支持，并且支援的其他脚本语言，像是[[VBScript|VBS]]和[[JScript|JScript]]。HTML用来创建用户介面，脚本语言則用来建構-{zh-hans:程序;zh-cn:程序;zh-hant:程式;zh-tw:程式}-主体。HTA执行当中没有互联网浏览器的安全模型的限制；实际上，它就像是一个被“完全信任”的-{zh-hans:应用;zh-cn:应用;zh-hant:應用程式;zh-tw:應用程式}-。

大部分HTA執行檔的-{zh-hans:后缀;zh-cn:后缀;zh-hant:副檔名;zh-tw:副檔名}-为 <code>.hta</code>。

HTA的可执行能力在1999年被引入Microsoft Windows，同时跟隨著[[Internet_Explorer_5|Microsoft Internet Explorer 5]]被發布出來。<ref>[http://support.microsoft.com/kb/200874 ''Article ID:200874 in Microsoft Support''] {{Wayback|url=http://support.microsoft.com/kb/200874 |date=20121023132318 }}，in Microsoft Support Knowledge Base</ref> 在2003年12月9日这一技术申请了专利。<ref>{{Cite web |url=http://news.cnet.com/2100-1012_3-5119072.html |title=Microsoft wins HTML application patent |accessdate=2016-04-02 |archive-date=2019-10-17 |archive-url=https://web.archive.org/web/20191017064615/https://www.cnet.com/news/microsoft-wins-html-application-patent/ |dead-url=no }}</ref>

== 使用 ==
HTA给予开发者HTML和高级的脚本语言的共同特性。在Microsoft Windows中使用HTA作為系统管理工具，無論从原型到“全面”的应用都非常受微软的系统管理者欢迎，特别是在灵活性和开发的速度非常關鍵的環境中。<ref>[https://msdn.microsoft.com/en-us/library/ms536496(v=vs.85).aspx ''Introduction to HTML Applications (HTAs)''] {{Wayback|url=https://msdn.microsoft.com/en-us/library/ms536496(v=vs.85).aspx |date=20160304202828 }}, in MSDN Library</ref>

== 环境 ==

=== 执行 ===
[[File:HTA-Hello_World_example.png|thumb]]
在圖形化介面下双击HTA文件，或是在-{zh-hans:命令提示符;zh-cn:命令提示符;zh-hant:命令提示字元;zh-tw:命令提示字元}-下鍵入<code>mshta [HTA檔名]</code>皆可以透過<code>mshta.exe</code>执行HTA檔。mshta.exe會与[[Internet_Explorer|Internet Explorer]]同时安装。<code>mshta.exe</code> 通过動態載入[[Internet_Explorer|Internet Explorer]]的HTML渲染引擎mshtml.dll来执行HTA檔，同时运行的还有需要的语言引擎（例如 vbscript.dll）。

HTA被视为带有 <code>[[EXE格式|.exe]]</code>扩展名的可执行文件。 在当该文件被mshta.exe运行 （或该文件被双击），它就会立即运行。当被远程用浏览器运行时，用户将会被询问，在HTA被下载之前，用户可以选择下载或不下载；如果选择保存，它可以简单的被按需运行。<ref>[https://msdn.microsoft.com/en-us/library/ms536496(v=vs.85).aspx ''Why Use HTAs''] {{Wayback|url=https://msdn.microsoft.com/en-us/library/ms536496(v=vs.85).aspx |date=20160304202828 }}, in MSDN Library, Introduction to HTML Applications</ref>

每个HTA被默认和呈现为“标准模式内容（IE7标准模式）和怪癖模式内容（IE5怪癖模式）”，但呈现方式可以被 <code>X-UA-Compatible</code> 标签更改。<ref>[https://msdn.microsoft.com/en-us/library/ms536496%28v=vs.85%29.aspx#Compatibility] {{Wayback|url=https://msdn.microsoft.com/en-us/library/ms536496%28v=vs.85%29.aspx#Compatibility |date=20160304202828 }} Introduction to HTML Applications (HTAs) - Compatibility</ref>

HTA引擎（mshta.exe）依赖于[[Internet_Explorer|Internet Explorer]]。从[[Windows_Vista|Windows Vista]]开始，用户可以从系统中移除Internet Explorer ，但它将使引擎停止工作。

HTA被Internet Explorer 5 至 9完美支持。其他版本，例如10 和 11，仍然支持HTA但被某些小功能关闭。

=== 安全注意事项 ===
当一个常规的HTML文件被执行时，执行权限被限制在[[网页浏览器|网页浏览器]]的[[安全模式|安全模式]]，也就是说，它被限制在与服务器通信的范围，只操纵页面的对象模型 （常常表现为验证表单／创建有趣的视觉效果）并且读／写[[Cookie|Cookie]]。

另一方面，HTA运行为一个完全信任的应用程序，因此具有比普通的HTML文件更多的特权；举一个例子，HTA can 可以创建、重命名、删除、并且注册一个实例。尽管HTA在这个“被信任的”环境中运行，查询[[Active_Directory|Active Directory]]依然可以看到Internet Explorer域的错误信息。

== 开发 ==
要定制一个HTA的特定外观，一个可选的标签 <code>hta:application</code> 在 <code>HEAD</code> 中被加入。这个标签公开了一组属性，可以控制程序外观，程序图标等，并且提供对参数（[[命令行|命令行]]）的控制来启动HTA。<ref>[https://msdn.microsoft.com/en-us/library/aa360681(v=VS.85).aspx ''HTA:APPLICATION Object''] {{Wayback|url=https://msdn.microsoft.com/en-us/library/aa360681(v=VS.85).aspx |date=20160413155756 }}, in MSDN Library, the complete specification of the tag <code>hta:application</code></ref> 除此以外，HTA 和一个[[HTML|HTML]]页面的格式是相同的。

任何[[文本编辑器|文本编辑器]]都可以用来创建HTA。可以从微软获得具有特殊功能的编辑器来开发HTA<ref>{{Cite web |url=http://www.microsoft.com/downloads/details.aspx?FamilyId=231D8143-F21B-4707-B583-AE7B9152E6D9&displaylang=en |title=''HTA Helpomatic'' |accessdate=2016-04-02 |archive-date=2010-03-25 |archive-url=https://web.archive.org/web/20100325113211/http://www.microsoft.com/downloads/details.aspx?FamilyId=231D8143-F21B-4707-B583-AE7B9152E6D9&displaylang=en |dead-url=no }}</ref> 或者从第三方获得。<ref>{{Cite web |url=http://www.htaedit.com/ |title=''HTAEdit, an editor for HTAs with a built-in debugger'' |accessdate=2016-04-02 |archive-date=2016-04-09 |archive-url=https://web.archive.org/web/20160409044908/http://www.htaedit.com/ |dead-url=no }}</ref>

一个存在的HTML文件（例如后缀为<code>.htm</code> 或 <code>.html</code>的文件）可以只将文件后缀更改为 <code>.hta</code>来更改为HTA文件。

== 例子 ==
这是一个Hello World程序在HTA中的实现过程.<syntaxhighlight lang="html4strict">
<HTML>
<HEAD>
<HTA:APPLICATION ID="HelloExample" 
   BORDER="thick" 
   BORDERSTYLE="complex"></HTA:APPLICATION>
<TITLE>HTA - Hello World</TITLE>
</HEAD>
<BODY>
<H2>HTA - Hello World</H2>
</BODY>
</HTML>
</syntaxhighlight>

== 另请参阅 ==
* Active Scripting
* Chromium Embedded Framework
* Google Chrome extension
* [[内部网|Intranet]]
* [[Firefox_OS|Firefox OS]]
* [[XUL|XUL]] 和 XULRunner - 一个Mozilla的跨平台应用程序, 它的语言和环境与HTML应用程序的机制相类似。
* Apache Cordova
* [[弹出式广告|Pop-up ad]]

== 参考资料 ==
{{Reflist|2}}

== 外部链接 ==
* [http://msdn2.microsoft.com/en-us/library/ms531018.aspx HTML Component (HTC) Reference at MSDN]{{Wayback|url=http://msdn2.microsoft.com/en-us/library/ms531018.aspx |date=20080405181017 }}. An HTC encapsulates specific functionality or behavior within HTAs.
* [http://technet.microsoft.com/en-ca/scriptcenter/default.aspx The Script Center]{{Wayback|url=http://technet.microsoft.com/en-ca/scriptcenter/default.aspx |date=20170222080609 }}, The Script Center, home of Hey, Scripting Guy! Blog
* [http://technet.microsoft.com/en-ca/scriptcenter/dd742317.aspx Learn About Scripting for HTML Applications (HTAs)]{{Wayback|url=http://technet.microsoft.com/en-ca/scriptcenter/dd742317.aspx |date=20160306084457 }}, 一个学习HTA的网站

{{Internet_Explorer}}

[[Category:HTML|Category:HTML]]
[[Category:Internet_Explorer|Category:Internet Explorer]]