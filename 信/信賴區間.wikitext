{{Expand English|time = 2016-09-13}}
{{NoteTA
|G1 = Math
|1=zh-hant:參數;zh-cn:参数;zh-tw:母數
|2=zh-cn:水平;zh-tw:水準
|3=zh-cn:置信;zh-tw:信賴
}}
在[[统计学|统计学]]中，一个[[樣本_(統計學)|概率样本]]的'''置信区间'''（{{Lang-en|Confidence interval}}，{{Lang|en|CI}}），是对产生这个样本的[[总体|总体]]的'''参数分布'''（{{Lang|en|Parametric Distribution}}）中的某一个未知[[母數|母數]]值，以'''区间'''形式给出的估计。相对于'''[[点估计|点估计]]'''（{{Lang|en|Point Estimation}}）用'''一个'''样本[[统计量|统计量]]来[[估计量|估计]]参数值，置信区间还蕴含了估计的精确度的信息。在现代机器学习中越来越常用的'''置信集合'''（{{Lang|en|Confidence Set}}）概念是置信区间在多维分析的推广<ref>{{cite journal |author1=Brittany Terese Fasy |author2=Fabrizio Lecci |author3=Alessandro Rinaldo |author4=Larry Wasserman |author5=Sivaraman Balakrishnan |author6=Aarti Singh |title=Confidence sets for persistence diagrams |journal=The Annals of Statistics |date=2014 |volume=42 |issue=6 |pages=2301-2339}}</ref>。

置信区间在频率学派中间使用，其在[[贝叶斯统计|贝叶斯统计]]中的对应概念是{{tsl|en|Credible interval|可信区间}}（{{Lang|en|Credible Interval}}）。两者建立在不同的概念基础上的，贝叶斯统计将分布的位置参数视为[[随机变量|随机变量]]，并对给定观测到的数据之后未知参数的后验分布进行描述，故无论对随机样本还是已观测数据，构造出来的可信区间，其可信水平都'''是'''一个合法的概率<ref>{{cite book |author1=Box, George EP |author2=Tiao, George C |title=Bayesian inference in statistical analysis |date=2011 |publisher=John Wiley & Sons}}</ref>；而置信区间的置信水平，只在考虑随机样本时可以被理解为一个概率。

==定义==

===对随机样本的定义===
定义置信区间最清晰的方式是从一个'''随机样本'''出发。考虑一个一维随机变量<math>{\cal X}</math>服从分布<math>{\cal F}</math>，又假设<math>\theta</math>是<math>{\cal F}</math>的参数之一。假设我们的数据采集计划将要独立地抽样<math>n</math>次，得到一个随机样本<math>\{X_1,\ldots,X_n\}</math>，注意这里所有的<math>X_i</math>都是随机的，我们是在讨论一个尚未被观测的数据集。如果存在'''统计量'''(统计量定义为样本<math>X=\{X_1,\ldots,X_n\}</math>的一个函数，且不得依赖于任何未知参数)<math>u(X_1,\ldots,X_n),v(X_1,\ldots,X_n)</math>满足<math>u(X_1,\ldots,X_n)<v(X_1,\ldots,X_n)</math>使得：

: <math>\mathbb{P}\left(\theta\in\left(u(X_1,\ldots,X_n),v(X_1,\ldots,X_n)\right)\right)=1-\alpha</math>

则称<math>\left(u(X_1,\ldots,X_n),v(X_1,\ldots,X_n)\right)</math>为一个用于估计参数<math>\theta</math>的<math>1-\alpha</math>置信区间，其中的，<math>1-\alpha</math>称为'''置信水平'''，<math>\alpha</math>在假设检验中也称为'''显著性水平'''。

===对观测到的数据的定义===
接续随机样本版本的定义，现在，对于随机变量<math>{\cal X}</math>的一个已经观测到的样本<math>\{x_1,\ldots,x_n\}</math>，注意这里用小写x表记的<math>x_i</math>都是已经观测到的数字，没有随机性了，定义基于数据的<math>1-\alpha</math>置信区间为：

: <math>\left(u(x_1,\ldots,x_n),v(x_1,\ldots,x_n)\right)</math>

注意，置信区间可以是单尾或者双尾的，单尾的置信区间中设定<math>u=-\infty</math>或者<math>v=+\infty</math>，具体前者还是后者取决于所构造的置信区间的方向。

初学者常犯一个概念性错误，是将基于观测到的数据所同样构造的置信区间的置信水平，误认为是它包含真实未知参数的真实值的概率。正确的理解是：置信水平只有在描述这个同样构造置信区间的'''过程'''(或称'''方法''')的意义下才能被视为一个概率。一个基于已经观测到的数据所构造出来的置信区间，其两个端点已经不再具有随机性，因此，类似的构造的间隔将会包含真正的值的比例在所有值中，其包含未知参数的真实值的概率是'''0或者1'''，但我们'''不能知道'''是前者还是后者<ref>{{cite book |author1=Moore, D |author2=McCabe, George P |author3=Craig, B |title=Introduction to the Practice of Statistics |url=https://archive.org/details/introductiontopr0000moor_e4j3 |date=2012 |publisher=San Francisco, CA: Freeman}}</ref>。

==例子==

===例1：正态分布，已知总体方差<math>\sigma^2</math> ===
<math>1-\alpha</math>水平的正态置信区间为：
: <math>\left( \bar{x}-z_{\alpha/2}\frac{\sigma}{\sqrt{n}}, \bar{x}+z_{\alpha/2}\frac{\sigma}{\sqrt{n}} \right)</math>  (双尾)
: <math>\left( -\infty, \bar{x}+z_{\alpha}\frac{\sigma}{\sqrt{n}} \right)</math>  (单尾)
: <math>\left( \bar{x}-z_{\alpha}\frac{\sigma}{\sqrt{n}}, +\infty \right)</math>  (单尾)

以下为方便起见，只列出'''双尾'''置信区间的例子，且区间中用"<math>\pm</math>"进行简记：

===例2：正态分布，未知总体方差<math>\sigma^2</math> ===
<math>1-\alpha</math>水平的'''双尾'''正态置信区间为：
: <math>\left( \bar{x}\pm t_{n-1;\alpha/2}\frac{s}{\sqrt{n}} \right)</math>

===例3：两个独立正态样本===
設有兩個獨立正態樣本<math>x</math>和<math>y</math>，样本大小为<math>m</math>和<math>n</math>，估计总体均值之差<math>\mu_1-\mu_2</math>，假设总体方差'''未知但相等：<math>\sigma_1=\sigma_2</math>'''(如果未知且不等就要应用{{tsl|en|Welch's t-test|Welch公式}}来确定t分布的自由度)
<math>1-\alpha</math>水平的'''双尾'''正态置信区间为：
: <math>\left( \bar{x}-\bar{y}\pm t_{m+n-2;\alpha/2}\cdot s_p\cdot \sqrt{\frac1m+\frac1n} \right)</math>，其中<math>s_p=\sqrt{\frac{(m-1)s_x^2+(n-1)s_y^2}{m+n-2}}</math>且<math>s_x,s_y</math>分别表示<math>x</math>和<math>y</math>的样本标准差。

== 常見誤解 ==
[[File:Neyman_Construction_Confidence_Intervals.png|thumb]]
信賴區間及信心水準常被誤解，出版的研究也顯示出既使是專業的科學家也常做出錯誤的詮釋。<ref>{{cite web|last=Kalinowski|first=Pawel|title=Identifying Misconceptions about Confidence Intervals|url=http://iase-web.org/documents/papers/icots8/ICOTS8_C104_KALINOWSKI.pdf|date=2010|access-date=2021-12-22|archive-date=2022-01-21|archive-url=https://web.archive.org/web/20220121043318/https://iase-web.org/documents/papers/icots8/ICOTS8_C104_KALINOWSKI.pdf}}</ref><ref>{{Cite web |url=http://irt.com.ne.kr/data/researchers%20misunderstand%20ci%20and%20error%20bars.pdf |title=Archived copy |access-date=2014-09-16 |archive-url=https://web.archive.org/web/20160304043241/http://irt.com.ne.kr/data/researchers%20misunderstand%20ci%20and%20error%20bars.pdf |archive-date=2016-03-04 |url-status=dead }}</ref><ref>Hoekstra, R., R. D. Morey, J. N. Rouder, and E-J. Wagenmakers, 2014. Robust misinterpretation of confidence intervals. Psychonomic Bulletin Review, in press. [http://www.ejwagenmakers.com/inpress/HoekstraEtAlPBR.pdf] {{Wayback|url=http://www.ejwagenmakers.com/inpress/HoekstraEtAlPBR.pdf |date=20211223134953 }}</ref><ref>[https://www.sciencenews.org/blog/context/scientists-grasp-confidence-intervals-doesnt-inspire-confidence Scientists’ grasp of confidence intervals doesn’t inspire confidence] {{Wayback|url=https://www.sciencenews.org/blog/context/scientists-grasp-confidence-intervals-doesnt-inspire-confidence |date=20220326094617 }}, [[Science_News|Science News]], July 3, 2014</ref><ref name=":2">{{Cite journal|last1=Greenland|first1=Sander| last2=Senn|first2=Stephen J.|last3=Rothman|first3=Kenneth J.|last4=Carlin|first4=John B.|last5=Poole|first5=Charles| last6=Goodman|first6=Steven N.|last7=Altman|first7=Douglas G.|date= April 2016 |title=Statistical tests, P values, confidence intervals, and power: a guide to misinterpretations|journal=European Journal of Epidemiology |volume=31|issue=4|pages=337–350| doi=10.1007/s10654-016-0149-3|issn=0393-2990|pmc=4877414|pmid=27209009}}</ref><ref name="Helske Helske Cooper Ynnerman pp. 3397–3409">{{cite journal | last1=Helske | first1=Jouni | last2=Helske | first2=Satu | last3=Cooper | first3=Matthew | last4=Ynnerman | first4=Anders | last5=Besancon | first5=Lonni | title=Can Visualization Alleviate Dichotomous Thinking? Effects of Visual Representations on the Cliff Effect | journal=IEEE Transactions on Visualization and Computer Graphics | publisher=Institute of Electrical and Electronics Engineers (IEEE) | volume=27 | issue=8 | date=2021-08-01 | issn=1077-2626 | doi=10.1109/tvcg.2021.3073466|arxiv=2002.07671 | pages=3397–3409| pmid=33856998 | s2cid=233230810 | url=http://urn.fi/URN:NBN:fi:jyu-202105213110 }}</ref>

* 以95%的信賴區間來說，建構出一個信賴區間，不代表分佈的參數有95%的機率會落在該信賴區間內（也就是說該區間有95%的機率涵蓋了分佈參數）。 <ref name="Morey" />依照嚴格的頻率學派詮釋，一旦信賴區間被建構完全，此區間不是涵蓋了參數就是沒涵蓋參數，已經沒有機率可言。95%機率指的是建構信賴區間步驟的可靠性，不是針對一個特定的區間。<ref>{{cite web|url=http://www.itl.nist.gov/div898/handbook/eda/section3/eda352.htm|title=1.3.5.2. Confidence Limits for the Mean|work=nist.gov|access-date=2014-09-16|archive-url=https://web.archive.org/web/20080205120031/http://www.itl.nist.gov/div898/handbook/eda/section3/eda352.htm|archive-date=2008-02-05|url-status=dead}}</ref>[[耶日·內曼|內曼]]本人（信賴區間的原始提倡者）在他的原始論文提出此點：<ref name="Neyman" /><blockquote>「在上面的敘述中可以注意到，機率是指統計學家在未來關心的估計問題。事實上，我已多次說明，正確結果的頻率會趨向於''α''。考慮到一個樣本已被抽取，[特定端點]也已被計算完成。我們能說在這個特定的例子裡真值[落到端點中]的機率等於''α''嗎？答案明顯是否定的。參數是未知的常數，無法做出對其值的機率敘述……」</blockquote>
:Deborah Mayo針對此點進一步說道：<ref name="Mayo" /><blockquote>「無論如何必須強調，在看到[資料的]數值後，Neyman–Pearson理論從不允許做出以下結論，特定產生的信賴區間涵蓋了真值的機率或信心為(1 − ''α'')100%。Seidenfeld的評論似乎源於一種（並非不尋常的）期望，Neyman–Pearson信賴區間能提供他們無法合理提供的，也就是未知參數落入特定區間的機率大小、信心高低或支持程度的測度。隨著Savage (1962)之後，參數落入特定區間的機率可能是指最終精密度的測度。最終精密度的測度令人嚮往而且信賴區間又常被(錯誤地)解釋成可提供此測度，然而此解釋是不被保證的。無可否認的，『信賴』二字助長了此誤解。」</blockquote>
* 95%信賴區間不代表有95%的樣本資料落在此信賴區間。
* 信賴區間不是樣本參數的可能值的確定範圍，雖然它常被啟發為可能值的範圍。
* 從一個實驗中算出的一個95%信賴區間，不代表從不同實驗得到的樣本參數有95%落在該區間中 <ref name=":2" />

==构造法==
一般来说，置信区间的构造需要先找到一个'''枢轴变量'''（{{Lang|en|Pivotal quantity}}，或称{{Lang|en|Pivot}}），其表达式依赖于样本以及待估计的未知参数(但'''不能'''依赖于总体的其它未知参数)，其分布'''不依赖于'''任何未知参数。

下面以上述例2为例，说明如何利用枢轴变量构造置信区间。对于一个正态分布的随机样本<math>{X_1,\ldots,X_n}</math>，可以证明(此证明对初学者并不容易)如下统计量'''互相独立'''：
: <math>\bar{X}=\frac1n \sum_{i=1}^n X_i </math>  和   <math>S^2=\frac{\sum_{i=1}^n\left(X_i-\bar{X}\right)^2}{n-1}</math>
它们的分布是：
: <math>\frac{\bar{X}-\mu}{\sigma/\sqrt{n}}\sim N(0,1)</math>  和  <math>(n-1)\frac{S^2}{\sigma^2} \sim \chi^2_{n-1}</math>
所以根据[[t分布|t分布]]的定义，有
:<math>t = \frac{\bar{X}-\mu}{S/\sqrt{n}}\sim t_{n-1}</math>
于是反解如下等式左边括号中的不等式
:<math>\mathbb{P}\left( -t_{n-1;\alpha/2}<t=\frac{\bar{X}-\mu}{S\sqrt{n}}<t_{n-1;\alpha/2} \right)=1-\alpha</math>
就得到了例2中双尾置信区间的表达式。

==与参数检验的联系==
有时，置信区间可以用来进行[[母數|母數]][[假說檢定|检验]]。例如在上面的例1中构造的'''双尾'''<math>1-\alpha</math>水平置信区间，可以用来检验具有相应的'''[[显著性差异|显著水平]]为<math>\alpha</math>'''的'''双尾'''[[對立假說|對立假說]]，具体地说是如下检验：
正态分布总体，知道总体方差<math>\sigma^2</math>，'''在<math>\alpha</math>显著水平下'''检验：
: <math>H_0: \mu=\mu_0</math> vs <math>H_1: \mu \neq\mu_0</math>
检验方法是：当（且仅当）相应的<math>1-\alpha</math>水平置信区间不包含<math>\mu_0</math>时拒绝零假设<math>H_0</math>

例1中构造的'''双尾'''<math>1-\alpha</math>水平置信区间也可以用来检验如下两个显著水平为'''<math>\alpha/2</math>'''的'''单尾'''对立假设：
: <math>H_0: \mu\leq \mu_0</math> vs <math>H_1: \mu >\mu_0</math>
和
: <math>H_0: \mu\geq \mu_0</math> vs <math>H_1: \mu <\mu_0</math>
检验方法是完全类似的，比如对于上述第一个单尾检验<math>H_1: \mu >\mu_0</math>，当且仅当双尾置信区间的左端点大于<math>\mu_0</math>时拒绝零假设。

==参考文献==
{{Reflist|refs=
<ref name=Morey>{{cite journal |last1= Morey|first1=R. D. |last2=Hoekstra|first2= R.|last3=Rouder|first3=J. N. | last4=Lee|first4=M. D.|last5=Wagenmakers|first5=E.-J.|date= 2016|title= The Fallacy of Placing Confidence in Confidence Intervals |journal= Psychonomic Bulletin & Review|volume= 23|issue= 1|pages= 103–123|doi= 10.3758/s13423-015-0947-8|pmid=26450628 |pmc=4742505 }}</ref>

<ref name=Neyman>{{cite journal | last1 = Neyman | first1 = J. | author-link = Jerzy Neyman | year = 1937 | title = Outline of a Theory of Statistical Estimation Based on the Classical Theory of Probability | jstor = 91337 | journal = [[Philosophical_Transactions_of_the_Royal_Society_A|Philosophical Transactions of the Royal Society A]] | volume = 236 | issue = 767| pages = 333–380 | doi=10.1098/rsta.1937.0005| bibcode = 1937RSPTA.236..333N | doi-access = free }}</ref>

<ref name=Mayo>Mayo, D. G. (1981) [http://www.phil.vt.edu/dmayo/PhilStatistics/In%20Defense%20of%20the%20Neyman-Pearson%20Theory%20of%20Confidence%20Intervals.pdf "In defence of the Neyman–Pearson theory of confidence intervals"], ''Philosophy of Science'', 48 (2), 269–280. {{JSTOR|187185}}</ref>
}}

==参考书目==
{{Refbegin}}
* [[羅納德·費雪|羅納德·費雪]] (1956) ''Statistical Methods and Scientific Inference.'' Oliver and Boyd, Edinburgh. (See p. 32.)
* 弗罗因德 (1962) ''Mathematical Statistics'' Prentice Hall, Englewood Cliffs, NJ. (See pp. 227–228.)
* [[伊安·海金|伊安·海金]] (1965) ''Logic of Statistical Inference.'' Cambridge University Press, Cambridge
* 齐平 (1962) ''Introduction to Statistical Inference.'' D. Van Nostrand, Princeton, NJ.
* [[杰克·基弗|杰克·基弗]](1977) [http://links.jstor.org/sici?sici=0162-1459%28197712%2972%3A360%3C789%3ACCSACE%3E2.0.CO%3B2-9 "Conditional Confidence Statements and Confidence Estimators (with discussion)"] ''Journal of the American Statistical Association,'' '''72,''' 789–827.
* [[泽西·内曼|泽西·内曼]] (1937) [http://links.jstor.org/sici?sici=0080-4614%2819370830%29236%3A767%3C333%3AOOATOS%3E2.0.CO%3B2-6 "Outline of a Theory of Statistical Estimation Based on the Classical Theory of Probability"] ''Philosophical Transactions of the Royal Society of London A,'' '''236,''' 333–380. (Seminal work.)
* G.K.罗宾逊 (1975) [http://links.jstor.org/sici?sici=0006-3444%28197504%2962%3A1%3C155%3ASCTTTO%3E2.0.CO%3B2-4 "Some Counterexamples to the Theory of Confidence Intervals."] ''Biometrika,'' '''62,''' 155–161.
{{Refend}}

{{-}}
{{Statistics}}

[[Category:统计学|Category:统计学]]
[[Category:计量经济学|Category:计量经济学]]
[[Category:市場調查|Category:市場調查]]
[[Category:选举学|Category:选举学]]
[[Category:生物统计学|Category:生物统计学]]
[[Category:測量学|Category:測量学]]