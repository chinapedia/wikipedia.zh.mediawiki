{{NoteTA|G1=IT}}
[[File:Certified_USB4_40Gbps_Logo.svg|缩略图]]
'''USB4''' 是 USB4 规范中指定的 [[USB|USB]] 系统，[[USB開發者論壇|USB开发者论坛]]于 2019 年 8 月 29 日发布了其 1.0 版本。<ref name="auto1">{{Cite web|title=USB Promoter Group USB4 Specification|url=https://www.usb.org/sites/default/files/USB4%20Specification.zip|date=2019-08-29|work=usb.org|archiveurl=https://web.archive.org/web/20210213071426/https://www.usb.org/sites/default/files/USB4%20Specification.zip|archivedate=2021-02-13|access-date=2020-07-22|dead-url=no}}</ref> 

与以往的 USB 协议标准不同，USB4 需要 [[USB_Type-C|USB-C]] 连接器，并且要需要 [[USB_Power_Delivery|USB PD]] 的支持以进行供电。与 USB 3.2 相比，它允许建立 [[DisplayPort|DisplayPort]] 和 [[PCI_Express|PCI Express]] 隧道。这种架构定义了一种与多个终端设备类型动态共享单个高速链路的方法，该方法能够最好地按类型和应用处理数据传输。USB4 产品必须支持 20 Gbit/s 的吞吐量，可支持 40 Gbit/s 的吞吐量。但由于进行了[[隧道协议|隧道传输]]，当传输混合数据时，即使只以 20 Gbit/s 的速率传输数据，实际的数据传输速率可能比 [[USB_3.2|USB 3.2]] 更高。

USB4 规范基于 [[Thunderbolt|Thunderbolt 3]] 协议规范。<ref>{{Cite web|title=Thunderbolt 3 becomes USB4, as Intel’s interconnect goes royalty-free|url=https://arstechnica.com/gadgets/2019/03/thunderbolt-3-becomes-usb4-as-intels-interconnect-goes-royalty-free/|accessdate=2019-03-04|author=Bright|date=2019-03-04|first=Peter|work=Ars Technica|language=en-us|archive-date=2021-02-13|archive-url=https://web.archive.org/web/20210213071427/https://arstechnica.com/gadgets/2019/03/thunderbolt-3-becomes-usb4-as-intels-interconnect-goes-royalty-free/|dead-url=no}}</ref>

== 总览 ==

=== 名称 ===
USB4 规范版本 1.0（于 2019 年 8 月 29 日发布）使用“Universal Serial Bus 4”（“通用串行总线 4”）和“USB4”的名称。该版本发布之前的一些新闻报道使用术语“USB 4.0”和“ USB 4”。<ref>{{Cite web|title=With USB 4, Thunderbolt and USB will converge|url=https://social.techcrunch.com/2019/03/04/with-usb-4-thunderbolt-and-usb-will-converge/}}</ref><ref>{{Cite web|title=USB 4.0 Will Arrive In Late 2020|url=https://www.guru3d.com/news-story/usb-4-will-arrive-in-late-2020.html|author=Hagedoorn|first=Hilbert|work=Guru3D.com|access-date=2020-07-22|archive-date=2021-10-26|archive-url=https://web.archive.org/web/20211026182556/https://www.guru3d.com/news-story/usb-4-will-arrive-in-late-2020.html|dead-url=no}}</ref> 即使在修订版1.0发布之后，有些人还是故意写了“USB 4”，声称是“为了反映读者搜索的方式”。<ref name="auto">{{Cite web|title=USB 4: Everything We Know So Far|url=https://www.tomshardware.com/news/usb-4-faq,38766.html|author=September 2019|first=Avram Piltch 03|work=Tom's Hardware|access-date=2020-07-22|archive-date=2021-06-30|archive-url=https://web.archive.org/web/20210630140440/https://www.tomshardware.com/news/usb-4-faq,38766.html|dead-url=no}}</ref> 

== 技术规范 ==

=== USB4 规范 ===

==== 历史 ====
2019 年 3 月，USB4 首次正式宣布。<ref>{{Cite web|title=USB4 Leverages Thunderbolt 3 Protocol Doubling Speeds To 40Gbps|url=https://hothardware.com/news/usb4-40-gbps-royalty-free-intel-thunderbolt-3|author=Hill|date=March 4, 2019|first=Brandon|work=HotHardware|access-date=2020-07-22|archive-date=2021-10-23|archive-url=https://web.archive.org/web/20211023152301/https://hothardware.com/news/usb4-40-gbps-royalty-free-intel-thunderbolt-3|dead-url=yes}}</ref><ref>{{Cite web|title=USB4 announced with 40Gbps bandwidth, it's based on Thunderbolt 3|url=https://www.gsmarena.com/usb4_announced_with_40gbps_bandwidth_its_based_on_thunderbolt_3-news-35841.php|work=GSMArena.com|access-date=2020-07-22|archive-date=2022-01-15|archive-url=https://web.archive.org/web/20220115155541/https://www.gsmarena.com/usb4_announced_with_40gbps_bandwidth_its_based_on_thunderbolt_3-news-35841.php|dead-url=no}}</ref> 

==== 贡献者 ====
在 USB4 的 1.0 版发布时，[[苹果公司|苹果]]（Apple）、[[惠普公司|惠普]]（hp）、[[英特尔公司|英特尔]]（Intel）、[[微软公司|微软]]（Microsoft）、[[瑞薩電子|瑞萨电子]]（Renesas）、[[意法半导体|意法半导体]]（ST）、[[德州仪器|德州仪器]]（TI）这些公司的员工参加了标准技术工作组。

==== 设计目标 ====
USB4 规范中阐明的目标是更高的传输带宽，帮助融合 USB-C 连接器的生态并“最大程度地减少终端用户的困惑”。实现此目的的一些关键领域是使用单个类型的 USB-C 连接器，同时保持与现有 USB 和 Thunderbolt 产品的兼容性。<ref>USB4 Spec. p.1</ref> 

==== 数据传输方式 ====
USB4 本身不提供任何的通用数据传输机制或设备类（这不像 USB 3.x），而是主要用于提供隧道以传输其他协议（如 [[USB_3.2|USB 3.2]]，[[Displayport|Displayport]] 和可选的 PCIe）。尽管它确实提供了原生的“主机到主机”协议，但顾名思义，它仅在两个连接的主机之间可用，并用于实现主机IP网络。因此，当主机与设备不支持可选的PCIe隧道传输时，最大非显示带宽被限制为USB 3.2 20Gbps，而仅有USB 3.2 10Gbps是强制实现。

USB4支持如下的隧道传输协议： 

* [[USB_3.0|USB 3.2]]（“增强型超高速”）隧道 
* 基于[[DisplayPort|DisplayPort 1.4a]]的隧道 
* 基于[[PCI_Express|PCI Express]]（PCIe的隧道

USB4还需要支持[[DisplayPort|DisplayPort]] Alternate Mode（备选模式）。因此可以使用USB4隧道或该备选模式传送DisplayPort信号。<ref>{{Cite web|title=USB4 - No more Mr. Nice Guy, your USB-C connector has to do it all! - #38|url=https://www.youtube.com/watch?v=Nax50U18iyo|accessdate=2020-05-01|date=2019-11-21|publisher=YouTube|archive-date=2021-11-25|archive-url=https://web.archive.org/web/20211125043215/https://www.youtube.com/watch?v=Nax50U18iyo|dead-url=no}}</ref> 

USB-C连接器中的专用线始终支持[[USB_2.0|USB 2.0]]。

===== 数据传输模式支持 =====
某些传输模式是所有 USB4 设备都支持的，但 USB4 对其他传输模式的支持是可选的。这取决于设备的类型。

{| class="wikitable"
|+ 数据传输模式的支持情况<ref name="auto1"/>
|-
! 类型
! 主机
! 集线器
! 外设
|-
| USB 2.0 (480 Mbit/s)|| {{yes}} || {{yes}} || {{yes}}
|-
| USB4 20 Gbit/s 传输 || {{yes}} || {{yes}} || {{yes}}
|-
| USB4 40 Gbit/s 传输 || {{optional}} || {{yes}} || {{optional}}
|-
| USB 3.2 (10 Gbit/s) 隧道 || {{yes}} || {{yes}} || {{optional}}
|-
| USB 3.2 (20 Gbit/s) 隧道<ref> USB4 Spec 1.0 Sect 9 specifically mentions the requirement of "Superspeed Plus (=Gen 2x1) support for hubs and devices, the latter only if they optionally support USB3 tunneling. The rest of the spec doesn't mention the speed at all and more generically just refers to the whole USB3.2 architecture as "Enhanced Superspeed". Section 9.2.1 states the requirement to only support Gen 2x1 for the USB3 tunneling adapter, with Gen 2x2 being optional.</ref>|| {{optional}} || {{optional}} || {{optional}}
|-
| [[DisplayPort|DisplayPort]] 隧道 || {{yes}} || {{yes}} || {{optional}}
|-
| [[PCI_Express|PCI Express]] 隧道 || {{optional}} || {{yes}} || {{optional}}
|-
| 主机到主机（Host-to-Host）通信 || {{yes}} || {{yes}} || {{n/a}} 
|-
| DisplayPort Alternate Mode || {{yes}} || {{yes}} || {{optional}}
|-
| Thunderbolt Alternate Mode || {{optional}} || {{yes}} || {{optional}} 
|-
| USB-C Alternate Modes || {{optional}} || {{optional}} || {{optional}}
|}

===== USB 数据传输模式 =====
{| class="wikitable"
|+USB4 数据传输模式
! rowspan="2" |名称
! rowspan="2" |图标
! colspan="4" |规范
! rowspan="2" |双通道
! rowspan="2" |[[线路码|编码]]
! colspan="2" |速率
|-
! USB4
! USB 3.2
! USB 3.1<ref>{{cite web|url=https://www.msi.com/blog/new-usb-standard-usb-3-2-gen-1-gen2-explained|archiveurl=https://web.archive.org/web/20200220000242/https://www.msi.com/blog/new-usb-standard-usb-3-2-gen-1-gen2-explained|archivedate=2020-02-20|title=The New USB standard: USB 3.2 Explained|date=February 20, 2020|website=web.archive.org|accessdate=2020-07-22|dead-url=no}}</ref>
! USB 3.0
! {{Abbr|Gbit/s|Gigabit per second}}
! {{Abbr|GB/s|Gigabyte per second}}
|-
| SuperSpeed USB 5Gbps
|[[File:USB_SuperSpeed_5_Gbps_Trident_Logo.svg|50px]]
| rowspan=4 {{CNone}}
| USB 3.2 Gen 1×1
| USB 3.1 Gen 1
| USB 3.0
| {{No}}
| [[8b/10b|8b/10b]]
| 5
| 0.5
|-
| SuperSpeed USB 10Gbps
|[[File:USB_SuperSpeed_10_Gbps_Trident_Logo.svg|50px]]
| USB 3.2 Gen 2×1
| USB 3.1 Gen 2
| rowspan=7 {{CNone}}
| {{No}}
| 128b/132b
| 10
| 1.2
|-
| colspan=2 {{N/A}}
| USB 3.2 Gen 1×2
| rowspan=6 {{CNone}}
| {{Yes}}
| 8b/10b
| 10
| 1.0
|-
| SuperSpeed USB 20Gbps
|[[File:USB_SuperSpeed_20_Gbps_Trident_Logo.svg|50px]]
| USB 3.2 Gen 2×2
| {{Yes}}
| 128b/132b
| 20
| 2.4
|-
| colspan=2 {{N/A}}
| USB4 Gen 2×1
| rowspan=4 {{CNone}}
| {{No}}
| 64b/66b{{efn|name=rs-fec}}
| 10
| 1.2
|-
| colspan=2 {{N/A}}
| USB4 Gen 3×1
| {{No}}
| 128b/132b{{efn|name=rs-fec}}
| 20
| 2.4
|-
| USB4 20Gbps
|[[File:USB4_20Gbps_Logo.svg|50px]]
| USB4 Gen 2×2
| {{yes}}
| 64b/66b{{efn|name=rs-fec}}
| 20
| 2.4
|-
| USB4 40Gbps
|[[File:USB4_40Gbps_Logo.svg|50px]]
| USB4 Gen 3×2
| {{Yes}}
| 128b/132b{{efn|name=rs-fec}}
| 40
| 4.8
|}

{{notelist|refs=
{{efn|name=rs-fec| USB4 能够使用可选的[[里德-所罗门码|里德-所罗门码]]进行[[前向錯誤更正|前向纠错]]（RS FEC）。}}
}}

USB4 Gen 2 与 USB 3.2 Gen 2 是不同的。它们仅有传输速率（10 Gbps）是相同的，但二者在电气层上的编码方式不同。

尽管 USB4 需要支持双通道模式，但在其双通道连接的初始化期间仍使用了单通道操作。如果此时发生通道绑定错误，单通道连接也可以用作备选模式。

在 Thunderbolt 兼容模式下，根据 Thunderbolt 规格的要求，通道以 10.3125 Gbps（Gen 2）或 20.625 Gbps（Gen 3）的更高速率工作。

==== 供电 ====
在 USB4 连接的建立前，需要先完成 [[USB_Power_Delivery|USB Power Delivery]]（USB PD）协商。USB4 电源的每个接口必须提供至少 7.5W（5V，1.5A）的供电。在 USB PD 协商之前，USB4 设备的耗电需要小于 250mA（默认）、1.5A 或 3A，5V （这取决于 [[USB_Type-C|USB-C]] 的电阻配置）。USB PD 最高可提供 100 W 的功率。<ref> USB Type-C Spec 2.0 Section 5.3</ref>

==== Thunderbolt 3 兼容性 ====
USB4 标准指出，USB4 的设计目标是“保持与 USB 和 Thunderbolt 产品的现有生态系统的兼容性”。但是与 Thunderbolt 3 的兼容性仅对于 USB4 主机和 USB4 外设是可选的。

=== 备用模式合作伙伴规格 ===

==== DisplayPort Alt Mode 2.0 ====
2020年4月29日，DisplayPort Alt Mode 2.0 发布，它支持基于 USB4 的 DisplayPort 2.0。<ref>{{Cite web|title=VESA Releases Updated DisplayPort™ Alt Mode Spec to Bring DisplayPort 2.0 Performance to USB4™ and New USB Type-C® Devices|url=https://www.prnewswire.com/news-releases/vesa-releases-updated-displayport-alt-mode-spec-to-bring-displayport-2-0-performance--to-usb4-and-new-usb-type-c-devices-301049114.html|author=Association (VESA)|first=Video Electronics Standards|work=www.prnewswire.com|access-date=2020-07-22|archive-date=2021-11-24|archive-url=https://web.archive.org/web/20211124132947/https://www.prnewswire.com/news-releases/vesa-releases-updated-displayport-alt-mode-spec-to-bring-displayport-2-0-performance--to-usb4-and-new-usb-type-c-devices-301049114.html|dead-url=no}}</ref>

== 软件支持 ==
2020 年 3 月 29 日发布的 [[Linux|Linux]] 5.6 支持 USB4。<ref>{{Cite web|title=Linux 5.6 Kernel Released With WireGuard, USB4, New AMD + Intel Hardware Support - Phoronix|url=https://www.phoronix.com/scan.php?page=news_item&px=Linux-5.6-Released|work=www.phoronix.com|access-date=2020-07-22|archive-date=2021-11-02|archive-url=https://web.archive.org/web/20211102223627/https://www.phoronix.com/scan.php?page=news_item&px=Linux-5.6-Released|dead-url=no}}</ref> 

== 硬体支持 ==
在 [[消費電子展|2020 年国际消费电子展]]（CES 2020）期间，[[USB-IF|USB-IF]] 和[[英特尔|英特尔]]表示打算允许支持了所有可选功能的 USB4 产品作为 [[Thunderbolt|Thunderbolt 4]]  产品。预计首批与 USB4 兼容的产品将是英特尔的 [[老虎湖（微体系结构）|Tiger Lake]] 系列和 [[超威半导体|AMD]] 的 [[禅宗3|Zen 3]] 系列CPU，这些产品将于2020年末发布。

支持 USB4 的设备有望在 2020 年出现。<ref>{{Cite web|title=USB4 devices are clear to roll out next year|url=https://www.engadget.com/2019-09-03-usb4-devices-next-year.html|work=Engadget|access-date=2020-07-22|archive-date=2021-11-24|archive-url=https://web.archive.org/web/20211124132956/https://www.engadget.com/2019-09-03-usb4-devices-next-year.html|dead-url=no}}</ref><ref>{{Cite web|title=First USB 4 devices to be launched at the end of 2020|url=https://www.pcbuildersclub.com/en/2019/06/first-usb-4-devices-to-be-launched-at-the-end-of-2020/|author=Maislinger|date=June 14, 2019|first=Florian|access-date=2020-07-22|archive-date=2021-11-24|archive-url=https://web.archive.org/web/20211124151515/https://www.pcbuildersclub.com/en/2019/06/first-usb-4-devices-to-be-launched-at-the-end-of-2020/|dead-url=no}}</ref> 

USB Promoter Group 首席执行官 Brad Saunders 预计，大多数带有 USB4 的个人电脑将支持 Thunderbolt 3。但对于手机，制造商不太可能实现对 Thunderbolt 3 的支持。<ref name="auto"/> 

2020 年 3 月 3 日，[[赛普拉斯半导体|赛普拉斯半导体]]宣布推出支持 USB4 的新控制器。其中包括双端口的 CCG6DF 和单端口的 CCG6SF。<ref>{{Cite web|title=Cypress Announces USB 3.2 & USB4-Ready Controllers: EZ-PD CCG6DF & CCG6SF|url=https://www.anandtech.com/show/15567/cypress-announces-usb-32-usb4-controllers-ezpd-ccg6df-ccg6sf|author=Shilov|first=Anton|work=www.anandtech.com|access-date=2020-07-22|archive-date=2021-12-06|archive-url=https://web.archive.org/web/20211206152338/https://www.anandtech.com/show/15567/cypress-announces-usb-32-usb4-controllers-ezpd-ccg6df-ccg6sf|dead-url=no}}</ref>

== 参考文献 ==
{{reflist|3}}

== 外部链接 ==

* [https://www.usb.org/usb4 USB4™ | USB-IF] {{Wayback|url=https://www.usb.org/usb4 |date=20211124132948 }}
* [https://www.usb.org/taxonomy/term/61 USB4 | USB-IF] {{Wayback|url=https://www.usb.org/taxonomy/term/61 |date=20211124133003 }}
* USB4 specifications can be downloaded from [https://www.usb.org/documents usb.org] {{Wayback|url=https://www.usb.org/documents |date=20210213071500 }}.
** [https://www.usb.org/document-library/usb4tm-specification USB4™ Specification | USB-IF] {{Wayback|url=https://www.usb.org/document-library/usb4tm-specification |date=20210812082434 }} 2019-08-29
** [https://www.usb.org/document-library/usb4-adopters-agreement USB4 Adopters Agreement | USB-IF] {{Wayback|url=https://www.usb.org/document-library/usb4-adopters-agreement |date=20211124132950 }} 2019-08-29
* Podcast with Jit Lim from [[是德科技|Keysight]], 2019-11-21 [https://www.youtube.com/watch?v=Nax50U18iyo] {{Wayback|url=https://www.youtube.com/watch?v=Nax50U18iyo |date=20211125043215 }}

{{USB}}

[[Category:USB|Category:USB]]