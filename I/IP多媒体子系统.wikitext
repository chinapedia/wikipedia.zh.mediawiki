{{unreferenced|time=2019-06-11T23:42:41+00:00}}
{{noteTA
|G1=IT
}}
{{Refimprove|time=2016-07-30T05:07:28+00:00}}
'''IP多媒体子系统'''（IP Multimedia Subsystem，IMS）或'''IP多媒体核心网络子系统'''（IP Multimedia Core Network Subsystem, IMCNS）是一个基于互联网协议提供多媒体业务的体系架构。传统移动电话使用类[[电路交换|电路交换]]网络提供语音通话服务，而非使用计算机[[分组交换|分组交换]]通信方式的网络。虽然已有很多方式在智能手机上提供[[网络协议通话技术|网络电话]]与其他互联网多媒体服务，但并未形成行业标准，IMS则为此提供了一个标准化体系架构。

IMS的最初的版本（3GPP Rel-5）主要是给出了一种基于[[GPRS|GPRS]]来实现互联网协议多媒体业务的方法。在这个版本的基础上，3GPP、[[3GPP2|3GPP2]]以及[[TISPAN|TISPAN]]进行了进一步的更新，以支持GPRS之外，诸如[[WLAN|WLAN]]、[[CDMA2000|CDMA2000]]和固定电话线等其他接入方式。

IMS在设计时优先使用属于[[互联网工程任务组|IETF]]的协议，比如，[[会话发起协议|会话发起协议]]。援引3GPP的说法，IMS并非刻意将应用标准化，而是帮助无线和有线终端的多媒体和通话应用提供一个接入方法，借此，辅助[[移动固网融合|移动固网融合]]。方式是使用一个独立的控制层将网络接入的工作从服务层剥离出来。理论上讲，服务不再需要控制器，因为有单独的控制层负责统筹。但从实践情况看，此举并未对布网开销与复杂程度有太大帮助。

有线与无线网络中功能与IMS重叠的服务包括[[通用访问网络|通用访问网络]]、[[软交换|软交换]]和SIP，可将上述服务混合使用达到替代IMS的效果。

现今有太多内容获取/绕过传统网络运营商与他人联系的方式，因此IMS的作用受到挑战。

基于IMS达成全球标准的例子可见多媒体通话，这是[[VoLTE|VoLTE]]和[[富通讯解决方案|富通讯解决方案]]（又被称作joyn或进阶消息服务）的基础。

== 历史 ==
* IMS最初是由一个名为[[3G.IP|3G.IP]]的行业论坛组织所定义的，并于1999年的成型。3G.IP开发的IMS架构后来被带入[[3GPP|3GPP]]，成为其[[3G|3G]]移动系统标准化工作的一部分。IMS的第一次出现是在3GPP标准版本5中，首次在3G网络中引入了分组域的多媒体业务，但主要是基于GPRS。
* [[3GPP2|3GPP2]]（另一个3G标准化组织）基于3GPP IMS构建了他们的CDMA2000多媒体域（Multimedia Domain，MMD），为IMS增加了[[CDMA2000|CDMA2000]]接入。
* 3GPP标准第6版加入了与[[WLAN|WLAN]]的交互，支持用户通过WLAN接入IMS。
* 3GPP标准第7版，与[[TISPAN|TISPAN]] R1.1版本一起，增加了对固定网络的支持。AGCF（Access Gateway control function）和PES（PSTN Emulation Service）被引入，以继承PSTN的业务和终端。

== 架構 ==
[[File:Ims_overview.png|frame]]

以下將簡述上圖所列的各個功能組。

IP多媒體核心子系統是由一系統功能組組成的。各個功能組之間由一組標準接口聯鏈起來，組成一個IMS管理網絡。一個功能組並非是一個節點（即硬件實體）：它的實現方式是開放的，允許將多個功能組布署在一個節點，亦允許一個功能組由多個節點實現。考慮到容量、負載均衡和管理等方面，還允許在一個網絡存在有多個相同的功能組。

=== 網絡訪問 ===
使用者有多種途徑訪問IMS，最普遍的是使用[[網際網路協議|網際網路協議（IP）]]。IMS終端（如[[移動電話|移動電話]]、[[個人數位助理|個人數位助理（PDA）]]以及[[電腦|電腦]]）只需要使用IP協議並且運行[[會話發起協議|會話發起協議（SIP）]][[用戶代理|用戶代理]]，就可以直接訪問IMS，即使他們已經漫游到其它國家或網絡。

IMS支援網絡訪問途徑有：

固定線路訪問（如[[DSL|數位用戶線路（DSL）]]、[[纜線數據機|纜線數據機]]以及[[以太網|以太網]]），移動訪問（如[[WCDMA|WCDMA]]、[[CDMA2000|CDMA2000]]、[[GSM|GSM]]以及[[GPRS|GPRS]]），無線訪問（如[[WLAN|WLAN]]和[[WiMAX|WiMAX]]）。

另外像[[普通老式電話服務|普通老式電話服務]]，[[H.323|H.323]]和非IMS兼容的[[网络电话|网络电话]]系統等電話系統可以通過[[閘道器|閘道器]]接入IMS。

=== 核心網絡 ===
==== 归属用户服务器（HSS - Home Subscriber Server） ====
归属用户服务器是一個核心的用戶數據庫。它為IMS網絡中實際管理通話的實體提供支持。如存取用戶相關的信息（稱之為用戶配置），對用戶認證和授權以及 提供用戶位置IP地址等相關信息。它和GSM的[[网络交换子系统#归属位置寄存器（HLR）|歸屬位置寄存器（HLR - Home Location Regiser）]]和[[网络交换子系统#鉴权中心（AuC）|認證中心（AuC - Authentication Centre）]]相似。

在同時使用多個HSS時，需要用戶位置功能組（SLF - Subscriber Location Function）映射用戶保存的位置。即當查詢某個用戶配置時，由SLF指出哪個HSS保存了這個用戶配置。

===== 用戶標識 =====
IMS可以使用多種用戶標識：IP多媒體私有標識（IMPI - IP Multimedia Private Identity），IP多媒體公共標識（IMPU - IP Multimedia PUblic Identity），全局可路游用戶代理統一資源標識符（GRUU - Globally Routable User Agent URI），通配公共用戶標識（Wildcarded PUblic User Identity）。IMPI和IMPU是一種[[統一資源標識符|統一資源標識符（URI）]]，它可以是數字（Tel URI，如 tel: +1-555-123-4567），也可以是字符標識符（SIP URI，如<nowiki>sip:john.doe@example.com</nowiki>）。

===== IP多媒體私有標識（IMPI） =====
IP多媒體私有標識是一種由主網絡操作者永久性分派的全局性標識，它可以用於註冊、認證、管理和计費等用途。每個IMS使用者可以有多個IMPI。

===== IP多媒體公有標識（IMPU） =====
當IMS使用者想要和其他使用者通訊時，需要使用IP多媒體公有標識（它可以寫在那個人的名片上）。IMS允許一個IMPI上綁定多個IMPU。IMPU也可以和其它電話共享（就像一個家庭使用一個電話號碼）。

===== 全局可路由用戶代理統一資源標識符（GRUU） =====
全局可路由用戶代理統一資源標識符是一個由IMPU和UE實例組成的標識符。IMS中有兩類GRUU：公共GRUU(P-GRUU)和臨時GRUU(T-GRUU)
* P-GRUU 明示了用戶的IMPU並且長期有效
* T-GRUU 隱藏了用戶的IMPU。當用戶顯式注銷T-GRUU或者過了有效期時，T-GRUU就會失效。

===== 通配公共用戶標識（Wildcarded PUblic User Identity） =====
通配公共用戶標識表示一組相似的IMPU。

HSS用戶數據庫保存用戶的IMPU，IMPI，[[國際移動用戶識別碼|國際移動用戶識別碼（IMSI）]]，[[MSISDN|MSISDN]]，用戶服務配置，服務開關和其它信息。

==== 呼叫会话控制功能（CSCF - Call Session Control Function） ====

[[會話發起協議|會話發起協議]]（SIP）伺服器和代理共同實現通話控制功能，稱之為CSCF。它們在IMS系統中處理SIP信號數據包。
* 代理-CSCF（P-CSCF）是一個SIP代理，作為與IMS終端直聯通訊點。它可以設置在公網中也可以設置在IMS本網中。某些網絡在這個功能組中可能使用了[[會談邊界控制器|會談邊界控制器]]（SBC）。P-CSCF其核心是一個特殊的SBC。該SBC使用的用戶網絡接口不僅保護網絡，也保護了IMS終端。在IMS終端和P-CSCF之間傳遞加密信號時，使用附加的SBC是毫無意義同時也是不可用的。終端可以使用[[动态主机設定協定|DHCP協議]]來找到它的P-CSCF，也可以使用配置（如出廠設定、3GPP IMS管理對象）、或是記錄在ISIM中、或是在PDP環境（[[GPRS|GPRS]] PDP Context）中賦值。
** 它在IMS終端註冊之前就被分派給IMS終端，並且在註冊期間不會改變。
** 它位於所有信號的通路，可以檢查所有的信號。IMS終端必須忽略任何其它未加密的信號。
** 它提供用戶的認證，並且為IMS終端建立一個[[IPsec|IPsec]]或[[TLS|TLS]]連接。這樣可以阻止[[欺騙攻擊|欺騙攻擊]]和[[重放攻擊|重放攻擊]]，並且保護用戶的隱私。
** 它檢查信號，確保IMS終端沒有企圖作弊（比如改變通常信號路游，不遵守IMS網絡路游策略）。
** 它也可以使用{{link-en|SigComp|SigComp}}壓縮和解壓縮SIP信息，以降低較慢的無線電鏈路的負載。
** 它也可以加入策略決擇功能（PDF - Policy Decision Function）。它可以允許媒體水平的資源（如[[QoS|QoS]]）可以達到媒體水平。它也可以用作策略控制、帶寬管理等等。PDF也可以作為獨立的功能組。
** 它也產生費用記錄。
* 服務-CSCF（S-CSCF）。從信號層面的來看，S-CSCF是IMS子系統的核心節點。它雖然是SIP伺服器，但也負責會話的控制。它永遠設置在IMS本網絡中，徑直地使用Cx和Dx接口訪問HSS。它從HSS下載用戶配置並且上傳用戶與S-CSCF關聯信息。（出於對處理用戶配置效率的考慮，S-CSCF會在其本地緩存用戶配置。但它不會在本地對用戶配置進行更改。）所有必要的用戶配置信息都會從HSS那裡加載。
** 它負責處理SIP註冊。它會將用戶位置（如終端的IP地址）和SIP地址進行綁定。
** 它位於所有在它那裡註冊的用戶所發出的信號信息的通路上，可以檢查所有的信息。
** 它負責決定SIP信息將抵達哪一個應用服務處理，以完成應用服務。
** 它提供路游服務，通常是使用{{link-en|電子號碼|Electronic Numbering}}（ENUM - Electronic Numbering）查找
** 它執行網絡運營商的策略
** 出於分布式負載和高可靠性的原因，IMS網絡中允許設置多個S-CSCF。這種情況下，由HSS在用戶配置記錄哪一個S-CSCF被關聯到該用戶，而後由I-CSCF來查詢這些記錄。
* 詢問-CSCF（I-CSCF）是另一個位於管理域邊緣的功能組。它的IP地址通過[[DNS|DNS]]發布，所以遠程伺服器可以查找到它，並把它作為向它所在的域傳遞SIP包的跳點。
** 它查詢HSS，獲取S-CSCF的地址並且分派給用戶以完成SIP註冊。
** 它也為S-CSCF傳遞SIP請求和回應。
** 直到IMS第6版，它是可以用來把內網隱藏起來，使外部網絡無法獲取內部網絡的信息（加密部分SIP信息）。這裡稱之為隱藏內部網絡拓扑閘道器（THIG - Topology Hiding Inter-network Gateway）。從第7版開始，這個功能從I-CSCF移走，作為互聯邊界控制功能組（IBCF - Interconnection Border Control Function）的一部分。IBCF被用作外部網絡的閘道器，提供[[网络地址转换|NAT]]和[[防火墙_(计算机)|防火墻]]功能。IBCF實際上是{{tsl|en|NNI|NNI}}的[[會談邊界控制器|會談邊界控制器]]的裁剪版本。

==== 應用伺服器（AS - Application Server） ====

SIP應用伺服器負責和提供服務。它與S-CSCF之間使用[[會話發起協議|會話發起協議（SIP）]]。由[[3GPP|3GPP]]開發的{{tsl|en|Voice call continuity|語音持續呼叫功能}}（VCC Server）就是一個應用伺服器的典型案例。基於具體的服務不同，AS可以選擇不同的SIP模式，如SIP代理模式，SIP用戶代理（UA - [[User_agent|User agent]]）模式和SIP {{tsl|en|B2BUA|B2BUA}}模式。AS可以設置在IMS本网內也可以設置在外部的第三方網絡。如果位於本網，它還可以使用Sh或Si接口查詢HSS。
* SIP AS：負責和提供IMS具體服務
* IP多媒體切換功能（IM-SSF - IP Multimedia Service Switching Function）：SIP和[[CAP|CAP]]之間的接口，用以與{{tsl|en|CAMEL|CAMEL}}應用伺服器通訊。
* OSA服務性能伺服器（OSA SCS - OSA Service Capability Server）：SIP和OSA框架之間的接口。

===== 功能模型 =====
AD-ILCM和AS-OLCM用來保存事務狀態並且可以根據特定服務的需要保存會話狀態。對於S-CSCF來說，AS-ILCM接口是輸入端，AS-OLCM接口是輸出端。應用邏輯提供服務和AS-ILCM、AS-OLCM之間的交互。

===== 公共服務標識（PSI - Public Service Identity）=====
公共服務標識是用來標識應用服務提供的服務。作為用戶標識，PSI可以提供SIP和Tel URI兩種標識格式。PSI通常被HSS以完整PSI或通配PSI保存。
* 完整PSI包含完整的PSI標識，可以直接用來路游。
* 通配PSI表達一組PSI標識。

==== 媒體伺服器 ====
媒體資源功能組（MRF - Media Resource Function）提供與媒體相關的功能，包括媒體處理（如混音）、播放撥號音和語音提示。

MRF可以進一步劃分為媒體資源功能控制器（MRFC - Media Reource Function Controller）和媒體資源功能處理器（MRFP - Media Resource Function Processor）。
* MRFC是信號層面的節點，它根據來自AS和S-CSCF的信息來操控MRFP。
* MRFP是媒體層面的節點，用來混合、產生或者處理媒體流。它也可以管理共享資源的訪問權限。

媒體資源協商器（MRB - Media Resource Broker）是一個功能實體。負責收集已經發布的MRF信息，並且向AS這樣的信息消費實體提供適當的MRF信息。MRB通常有兩個模式：
* 查詢模式：AS主動查詢MRB相應的媒體並且建立使用MRB回應的呼叫。
* 線性模式：AS向MRB發送SIP INVITE，由MRB建立呼叫。

==== 出口网关控制功能 ====
出口网关控制功能（BGCF - Breakout Gateway Control Function）是一個SIP代理，它處理來自S-CSCF的路由請求。BGCF有基於電話號碼的路由功能，用来选择与PSTN网络的接口点。当BGCF发现被叫网络位于一个PSTN网络时，BGCF就选择一个媒体网关控制功能(MGCF)，将会话路由到MGCF，MGCF负责与PSTN网络交互。

==== 媒体网关控制功能 ====
媒体网关控制功能（MGCF - Media Gateway Control Function）完成IMS网络与PSTN网络之间的呼叫控制协议转换。主要是将SIP消息转换成ISUP消息。并控制IM-MGW中媒体信道，管理PSTN网络的承载和与IMS网络的IP流间的连接。

=== 介面描述 ===
{| class="wikitable"
!介面名稱
!IMS entities
!描述
!協定
|-
|
Cr
|
MRFC, AS
|
Used by MRFC to fetch documents (scripts and other resources) from an AS
|
[[Hypertext_Transfer_Protocol|HTTP]] over dedicated [[Transmission_Control_Protocol|TCP]]/[[Stream_Control_Transmission_Protocol|SCTP]] channels
|-
|
Cx
|
I-CSCF, S-CSCF, HSS
|
Used to communicate between I-CSCF/S-CSCF and HSS
|
[[Diameter_(protocol)|Diameter]]
|-
|
Dh
|
SIP AS, OSA, SCF, IM-SSF, HSS
|
Used by AS to find a correct HSS in a multi-HSS environment
|
[[Diameter_(protocol)|Diameter]]
|-
|
Dx
|
I-CSCF, S-CSCF, SLF
|
由 I-CSCF/S-CSCF 使用於 找尋正確的 HSS 在 multi-HSS environment
|
[[Diameter_(protocol)|Diameter]]
|-
|
Gm
|
UE, P-CSCF
|
用於 UE 與 CSCFs 之間交換訊息
|
[[Session_Initiation_Protocol|SIP]]
|-
|
Go
|
PDF, GGSN
|
Allows operators to control QoS in a user plane and exchange charging correlation information between IMS and GPRS network
|
[[Common_Open_Policy_Service|COPS]] (Rel5), [[Diameter_(protocol)|Diameter]] (Rel6+)
|-
|
Gq
|
P-CSCF, PDF
|
Used to exchange policy decisions-related information between P-CSCF and PDF
|
[[Diameter_(protocol)|Diameter]]
|-
|
ISC
|
S-CSCF, I-CSCF, AS
|
用於 CSCF 與 AS 之間交換訊息
|
[[SIP|SIP]]
|-
|
Ma
|
I-CSCF -> AS
|
Used to directly forward SIP requests which are destinated to a Public Service Identity hosted by the AS
|
[[Session_Initiation_Protocol|SIP]]
|-
|
Mg
|
MGCF -> I-CSCF
|
MGCF converts [[ISDN_User_Part|ISUP]] signalling to [[Session_Initiation_Protocol|SIP]] signalling and forwards [[Session_Initiation_Protocol|SIP]] signalling to I-CSCF
|
[[Session_Initiation_Protocol|SIP]]
|-
|
Mi
|
S-CSCF -> BGCF
|
用於 S-CSCF 與 BGCF 之間交換訊息
|
[[Session_Initiation_Protocol|SIP]]
|-
|
Mj
|
BGCF -> MGCF
|
Used to exchange messages between BGCF and MGCF in the same IMS network
|
[[Session_Initiation_Protocol|SIP]]
|-
|
Mk
|
BGCF -> BGCF
|
Used to exchange messages between BGCFs in different IMS networks
|
[[Session_Initiation_Protocol|SIP]]
|-
|
Mm
|
I-CSCF, S-CSCF, external IP network
|
Used for exchanging messages between IMS and external IP networks
|
[[Session_Initiation_Protocol|SIP]]
|-
|
Mn
|
MGCF, IM-MGW
|
允許 user-plane resources 的控制
|
[[Megaco|H.248]]
|-
|
Mp
|
MRFC, MRFP
|
用於 MRFC 與 MRFP 之間交換訊息
|
[[Megaco|H.248]]
|-
|
Mr
|
S-CSCF, MRFC
|
S-CSCF and MRFC 之間交換訊息
|
[[Session_Initiation_Protocol|SIP]]
|-
|
Mw
|
P-CSCF, I-CSCF, S-CSCF
|
Used to exchange messages between CSCFs
|[[Session_Initiation_Protocol|SIP]]
|-
|
Rf
|
P-CSCF, I-CSCF, S-CSCF, BGCF, MRFC, MGCF, AS
|
Used to exchange offline charging information with CCF
|
[[Diameter_(protocol)|Diameter]]
|-
|
Ro
|
AS, MRFC
|
Used to exchange online charging information with ECF
|
[[Diameter_(protocol)|Diameter]]
|-
|
Sh
|
SIP AS, OSA SCS, HSS
|
Used to exchange information between SIP AS/OSA SCS and HSS
|
[[Diameter_(protocol)|Diameter]]
|-
|
Si
|
IM-SSF, HSS
|
用於 IM-SSF 與 HSS 之間交換訊息
|
[[Mobile_Application_Part|MAP]]
|-
|
Sr
|
MRFC, AS
|
Used by MRFC to fetch documents (scripts and other resources) from an AS
|
[[Hypertext_Transfer_Protocol|HTTP]]
|-
|
Ut
|
UE, AS (SIP AS, OSA SCS, IM-SSF)
|
Facilitates the management of subscriber information related to services and settings
|
[[Hypertext_Transfer_Protocol|HTTP]](s), [[XCAP|XCAP]]
|}

另外，IMS要求一组垂直的接口规范来提供以下特性：
* 普遍的接口，在应用服务器上用于帐务、安全、签订服务的数据、业务控制以及用来给诸如presence functions等的“积木”提供服务。
* 协调后的和加强的[[QoS|QoS]]
* 在操作员控制下的基于[[会话|会话]]的媒体关守
* 在各种业务、[[会话|会话]]和[[传输层|传输层]]间关联的帐务和付费

以上这些能力导致IMSs有别于通常的会话控制的[[互联网应用|互联网应用]]。一个IMS是一种模型，在这种模型中，网络操作员和业务分别提供方控制网络和业务的接入，与此同时消费者会有消费账单。网络是完全透明的，并且所有的服务由终点（endpoint）提供——这与通常的[[互联网模型|互联网模型]]相反。至少在理论上，这种更易控制的环境导致的结果是：用户因为QoS、单点登录和客户服务而享受到了更好的体验。

<!--以下为原文部分内容
An IP multimedia subsystem (IMS) is a set of core network FEs and interfaces used by a network
service provider to offer SIP-based services to subscribers, where SIP is the Session Initiation Protocol defined by the Internet Engineering Task Force (IETF). For the most part, an IMS is independent of the access network technology, although there are some links between the IMS and the underlying transport functionality, and these may be access specific. An IMS is built on IETF protocols, with specific profiles and enhancements to provide a complete, robust multimedia system.<ref name="NGNAG">2</ref>

The enhancements and operational profiles provide support for operator control, charging
and billing, and security. In addition to the enhancements and profiles, an IMS requires a set of vertical interfaces to provide the following:
*Common interfaces to application servers for accounting, security, subscription data, service control, and to service building blocks such as presence functions 
*Coordinated and enforced QoS (session layer negotiation can be matched with resources granted at the transport layer, per operator policy)
*Session-based media gating under operator control
*Correlated accounting and charging among the service, session, and transport layers

These capabilities make IMSs different from the usual Internet applications for session
control. An IMS is based on a model where a network operator and service provider control access to the network and services, respectively, for which customers are billed. This is in contrast to the usual Internet model, where the network is transparent and all services
are provided by endpoints. As a result of this more controlled environment, users get an improved experience with managed QoS, single-sign-on security, and customer support, at least in theory.<ref name="NGNAG">3</ref>
-->

== 参见 ==
* [[下一代网络|下一代网络]]（NGN）
* [[IMS-2000|IMS-2000]]

== 参考文献 ==
{{reflist}}

[[Category:多媒体|Category:多媒体]]
[[Category:網路結構|Category:網路結構]]