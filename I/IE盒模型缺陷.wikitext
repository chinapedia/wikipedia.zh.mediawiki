{{POV|time=2020-09-28T10:41:03+00:00}}
{{更新|time=2020-09-28T10:41:03+00:00}}
[[File:W3C_and_Internet_Explorer_box_models.svg|thumb]]{{CSS}}

'''IE盒模型缺陷'''（{{lang-en|Internet Explorer box model bug}}）是指早期版本的[[Internet_Explorer|Internet Explorer]]调整网页元素大小的方法，和[[W3C|W3C]]为[[层叠样式表|层叠样式表]]（CSS）语言推荐的标准方式不同。在[[Internet_Explorer_6|Internet Explorer 6]]中，浏览器支持一种解决了这种差异的可选的渲染模式（叫做「遵从标准模式」）。然而，出于向后兼容的原因，所有版本的IE（截至IE 9及IE 10 Developer Preview）仍然默认表现为通常的，非标准的模式{{NoteTag|参见：[[怪异模式|quirks mode]]}}。[[Internet_Explorer_for_Mac|Internet Explorer for Mac]]不受这种非标准行为影响。此外，[[Internet_Explorer_10|Internet Explorer 10]]于其Consumer Preview之中也改变其默认[[怪异模式|怪异模式]]为一种更加符合规范的类似于非IE浏览器的怪异模式<ref>[http://blogs.msdn.com/b/ie/archive/2011/12/14/interoperable-html5-quirks-mode-in-ie10.aspx Interoperable HTML5 Quirks Mode in IE10] {{Wayback|url=http://blogs.msdn.com/b/ie/archive/2011/12/14/interoperable-html5-quirks-mode-in-ie10.aspx |date=20120314102131 }}, IE Blog, [[MSDN|MSDN]]</ref>。

==背景==
CSS的规范描述了[[网页|网页]]的元素如何被图形浏览器展现。CSS1的规范第四节定义了一个给块级元素 - 比如说<code>p</code>和<code>blockquote</code> - 一个宽度和高度，和3个级别的环绕它的框 - <code>padding</code>, <code>border</code>,和<code>margin</code> - 的「格式化模型」<ref name="CSS-19990111">{{Cite web | url=http://www.w3.org/TR/1999/REC-CSS1-19990111#formatting-model | title=Cascading Style Sheets, level 1 | author=Håkon Wium Lie | coauthors=Bert Bos | date=1999-01-11 | publisher=[[World_Wide_Web_Consortium|World Wide Web Consortium]] | accessdate=2007-06-24 | archive-date=2014-04-09 | archive-url=https://web.archive.org/web/20140409234430/http://www.w3.org/TR/1999/REC-CSS1-19990111#formatting-model | dead-url=yes }}</ref>。尽管该规范从来没有明确使用过「盒模型」一词，这个词已经被网页开发人员和网页浏览器供应商广泛使用。

在HTML 4和CSS之前，很少HTML元素既支持border也支持padding，所以对一个元素的宽度和高度的定义并不是很有争议。然而，它取决于元素的不同而变化。在HTML，table的width属性定义了一个表格 - 包括其边框 - 的宽度<ref>{{Cite web|first=Dave|last=Raggett|url=http://www.w3.org/TR/WD-tables-960123|title=The HTML3 Table Model|publisher=[[World_Wide_Web_Consortium|World Wide Web Consortium]]|date=1996-01-23|accessdate=210-07-27|archive-date=2012-01-03|archive-url=https://web.archive.org/web/20120103004240/http://www.w3.org/TR/WD-tables-960123|dead-url=no}}{{Cite web|url=http://www.ietf.org/rfc/rfc1942.txt|title=RFC 1942 HTML Tables|quote=The default table width is the space between the current left and right margins.|publisher=[[IETF|IETF]]|accessdate=2012-02-06|archive-date=2012-01-29|archive-url=https://web.archive.org/web/20120129131633/http://www.ietf.org/rfc/rfc1942.txt|dead-url=no}}</ref>。另一方面，图像（<code>img</code>）的width属性定义的则是这个图像本身（在任何边框之内）的宽度<ref>{{Cite web|last=Raggett|first=Dave|title=13 Objects, Images, and Applets # Width and height|url=http://www.w3.org/TR/1999/REC-html401-19991224/struct/objects.html#h-13.7.1|publisher=[[World_Wide_Web_Consortium|World Wide Web Consortium]]|accessdate=2010-07-27|coauthors=Arnaud Le Hors, Ian Jacobs|date=1999-12-24|archive-date=2008-03-12|archive-url=https://web.archive.org/web/20080312073553/http://www.w3.org/TR/1999/REC-html401-19991224/struct/objects.html#h-13.7.1|dead-url=no}}</ref>。在早期的那些日子，唯一支持padding属性的元素就是表单元格。表单元格的宽度被定义为「以像素为单位的单元格内容的建议宽度，不包括填充」<ref>{{Cite web|url=http://www.w3.org/TR/REC-html32|first=Dave|last=Raggett|date=1997-01-14|title=HTML 3.2 Reference Specification|publisher=[[World_Wide_Web_Consortium|World Wide Web Consortium]]|accessdate=2010-07-07|archive-date=2010-06-19|archive-url=https://web.archive.org/web/20100619054311/http://www.w3.org/TR/REC-html32|dead-url=yes}}</ref>。

在1996年，CSS<ref>{{Cite web|title=Cascading Style Sheets, level 1|url=http://www.w3.org/TR/CSS1/|publisher=[[World_Wide_Web_Consortium|World Wide Web Consortium]]|accessdate=2010-07-27|author=Håkon Wium Lie|coauthors=Bert Bos|date=Dec 1996|archive-date=2009-04-01|archive-url=https://web.archive.org/web/20090401074955/http://www.w3.org/TR/CSS1/|dead-url=no}}</ref>为多得多的元素引入了margin, border和padding属性。它通过了一个对margin, border和padding的处理类似于表单元格的，相对于内容的宽度定义<ref>{{Cite web |url=http://www.w3.org/TR/REC-CSS1-961217 |title=Cascading Style Sheets, level 1 |publisher=[[World_Wide_Web_Consortium|World Wide Web Consortium]] |accessdate=2010-07-07 |archive-date=2010-05-27 |archive-url=https://web.archive.org/web/20100527220439/http://www.w3.org/TR/REC-CSS1-961217 |dead-url=no }}</ref>。从此这已成为著名的W3C盒模型。

在那时，非常少浏览器供应商严格地实施了W3C盒模型。当时的两种主要浏览器，[[Netscape|Netscape]] 4.0和[[Internet_Explorer_4|Internet Explorer 4.0]]均定义宽度和高度为边框到边框的距离<ref>{{Cite web |url=http://www.xs4all.nl/~ppk/css2tests/box.html |title=Box model tweaking |work=CSS2 tests |publisher=Xs4all.nl |accessdate=2010-07-07 |archive-date=2009-08-23 |archive-url=https://web.archive.org/web/20090823124005/http://www.xs4all.nl/~ppk/css2tests/box.html |dead-url=no }}</ref>。这已被称为''传统''<ref name="CSS2 - Box model tweaking">{{Cite web |url=http://www.quirksmode.org/css/box.html |title=CSS2 - Box model tweaking |publisher=Quirksmode.org |accessdate=2010-07-07 |archive-date=2010-06-29 |archive-url=https://web.archive.org/web/20100629063230/http://www.quirksmode.org/css/box.html |dead-url=no }}</ref>或者''Internet Explorer盒模型''。<ref>{{Cite web | url=http://www.456bereastreet.com/archive/200612/internet_explorer_and_the_css_box_model/ | title=Internet Explorer and the CSS box model | date=2006-12-21 | accessdate=2008-11-12 | last=Johansson | first=Roger | archive-date=2008-11-07 | archive-url=https://web.archive.org/web/20081107094110/http://www.456bereastreet.com/archive/200612/internet_explorer_and_the_css_box_model/ | dead-url=no }}</ref>

==缺陷==
根据由[[万维网联盟|万维网联盟]]（W3C）于1996年发行并于1999年修订的CSS1所指定的，当任意一个块级元素的宽度或高度被显式指定，它应当只确定这个可见元素自身的宽度或高度，而padding, border和margin随后被应用。<ref name="CSS-19990111" /><ref>{{Cite web | url=http://www.w3.org/TR/REC-CSS1-961217#formatting-model | title=Cascading Style Sheets, level 1 | author=Håkon Wium Lie | coauthors=Bert Bos | date=1996-12-17 | publisher=[[World_Wide_Web_Consortium|World Wide Web Consortium]] | accessdate=2006-12-09 | archive-date=2006-12-19 | archive-url=https://web.archive.org/web/20061219204240/http://www.w3.org/TR/REC-CSS1-961217#formatting-model | dead-url=no }}</ref>[[Internet_Explorer|Internet Explorer]]在「[[怪异模式|怪异模式]]」（[[怪异模式|怪异模式]]）则把内容，内边距（padding）和边框（border）全部包括在一个指定的宽度或高度之内；这导致它呈现出一个比遵从标准行为的结果更窄或者更短的盒子。<ref>{{Cite web | url=http://msdn2.microsoft.com/en-us/library/bb250395.aspx#cssenhancements_topic3 | title=CSS Enhancements in Internet Explorer 6 | author=Lance Silver | publisher=[[Microsoft|Microsoft]] | work=[[Microsoft_Developer_Network|Microsoft Developer Network]] | accessdate=2007-06-24 | date=March 2001 | archive-date=2007-07-01 | archive-url=https://web.archive.org/web/20070701224233/http://msdn2.microsoft.com/en-us/library/bb250395.aspx#cssenhancements_topic3 | dead-url=no }}</ref>

==解决方法==
如果页面包含某些[[HTML|HTML]][[文件类型描述|文件类型描述]]，则[[Internet_Explorer_6|Internet Explorer 6]]及以上版本不受该缺陷的影响。然而这些版本由于向后兼容的原因，在quirks模式下维持这种错误的行为。<ref name="msdn IE7 blog">{{Cite web | url=http://msdn2.microsoft.com/en-us/library/bb250496.aspx | title=Cascading Style Sheet Compatibility in Internet Explorer 7 | accessdate=2007-06-24 | author=Markus Mielke | date=2006-09-26 | publisher=[[Microsoft|Microsoft]] | work=[[Microsoft_Developer_Network|Microsoft Developer Network]] | archive-date=2007-06-29 | archive-url=https://web.archive.org/web/20070629034354/http://msdn2.microsoft.com/en-us/library/bb250496.aspx | dead-url=no }} "Pages authored under non-strict mode (quirks)will not change behavior in IE7 and will not be affected by broken CSS filters.Pages authored under non-strict mode（or“quirks mode”）will not change behavior in IE7."</ref>例如，如下会触发quirks模式：

*[[文件类型描述|文件类型描述]]缺失或不完整时；
*遇到一个HTML 3或者更早的文档时；
*使用HTML 4.0 Transitional或Frameset的文件类型描述且系统标识符（[[URI|URI]]）不存在时；
*在DOCTYPE声明之前出现SGML注释或者其它无法识别的内容时；
*文档任何地方有错误时；
*注释符相遇时出现末尾文字重复；
*Internet Explorer 6也会在DOCTYPE声明之前出现[[XML|XML]]声明时使用quirks模式。<ref>{{Cite web | url=http://msdn.microsoft.com/en-us/library/ms535242(VS.85).aspx | title=!DOCTYPE | accessdate=2007-01-13 | publisher=[[Microsoft|Microsoft]] | work=[[Microsoft_Developer_Network|Microsoft Developer Network]] | archive-date=2008-05-06 | archive-url=https://web.archive.org/web/20080506103742/http://msdn.microsoft.com/en-us/library/ms535242(VS.85).aspx | dead-url=no }} "The following examples show how to use the !DOCTYPE declaration to specify the DTD a document conforms to, and to switch Internet Explorer 6 and later to standards-compliant mode."</ref>

各种解决方法已被制定以迫使Internet Explorer 5以及更早版本使用W3C盒模型显示网页。这些解决方法一般是利用Internet Explorer的CSS选择器作用的无关的缺陷以从浏览器中隐藏某些规则。这些解决方法中，最为熟知的是由[[坦塔克·塞里克|Tantek Çelik]]，一个工作于IE for Mac时发现这个主意的前微软员工，开发的「盒模型hack」。它涉及到为IE for Windows指定一个宽度声明，随后使用另一个为CSS-兼容的浏览器指定的宽度重写它。第二条声明通过利用IE for Windows解析CSS规则的其它缺陷而从该浏览器中隐藏。这些CSS「hacks」的实施直到Internet Explorer 7的公开发行为止都被进一步兼容。IE 7只修复了一部分问题，而不是其它的，这导致使用这些hacks的页面出现一些意想不到的问题。<ref name="msdn IE7 blog"/>

盒模型hacks已证明是不可靠的，因为它们依赖于浏览器对CSS支持的缺陷，而这些缺陷可能会在以后的版本中被修复。由于这个原因，一些网页开发者改以推荐避免对同一个元素既指定width也指定padding或者使用[[条件注释|条件注释]]以及/或[[CSS_filter|CSS filter]]s以解决在较旧版本Internet Explorer上的盒模型缺陷。<ref>{{Cite web | url=http://www.456bereastreet.com/archive/200612/internet_explorer_and_the_css_box_model/ | title=Internet Explorer and the CSS box model | author=Roger Johansson | date=2006-12-21 | publisher=456 Berea Street | accessdate=2007-01-14 | archive-date=2007-01-15 | archive-url=https://web.archive.org/web/20070115212800/http://www.456bereastreet.com/archive/200612/internet_explorer_and_the_css_box_model/ | dead-url=no }}</ref><ref>{{Cite web | url=http://virtuelvis.com/archives/2004/02/css-ie-only | title=Hack-free CSS for IE | author=Arve Bersvendsen | work=Arve Bersvendsen's weblog | accessdate=2007-01-16 | date=February 2004 | deadurl=yes | archiveurl=https://web.archive.org/web/20070115183512/http://virtuelvis.com/archives/2004/02/css-ie-only | archivedate=2007-01-15 }}</ref>

==对Internet Explorer盒模型的支持==
网页设计者Doug Bowman说过起初的Internet Explorer盒模型代表了一个更好，更有逻辑性的方法。<ref>{{Cite web |url=http://www.vorsprungdurchwebstandards.de/interviews/fallinginlovewithcss/douglas-bowman/ |title=Vorsprung durch Webstandards | Douglas Bowman declares his love to CSS |publisher=Vorsprungdurchwebstandards.de |accessdate=2010-07-07 |archive-url=https://web.archive.org/web/20100614070042/http://www.vorsprungdurchwebstandards.de/interviews/fallinginlovewithcss/douglas-bowman/ |archive-date=2010-06-14 |dead-url=yes }}</ref> Peter-Paul Koch则给出了一个物理上盒子的例子，其尺寸总是指盒子自身的，包括可能的内边距 - padding，但是从来不是它的内容。<ref name="CSS2 - Box model tweaking"/>他说这种盒模型对图形化设计者来说更有用，他们创造基于盒子的可见宽度而不是其内容的宽度的设计。<ref>{{Cite web |url=http://www.vorsprungdurchwebstandards.de/interviews/fallinginlovewithcss/peter-paul-koch/ |title=Vorsprung durch Webstandards | Peter-Paul Koch declares his love to CSS |publisher=Vorsprungdurchwebstandards.de |accessdate=2010-07-07 |archive-url=https://web.archive.org/web/20100227061437/http://www.vorsprungdurchwebstandards.de/interviews/fallinginlovewithcss/peter-paul-koch/ |archive-date=2010-02-27 |dead-url=yes }}</ref>（使用过 VS 窗体设计器或类似工具的开发者会很容易理解 IE 盒模型的用意所在。）Bernie Zimmermann说Internet Explorer盒模型更接近于HTML表格模型中单元格的尺寸和填充。<ref>{{Cite web |url=http://www.bernzilla.com/item.php?id=33 |title=Box Model Enlightenment, Bernie Zimmermann |publisher=Bernzilla.com |date=2003-04-04 |accessdate=2010-07-07 |deadurl=yes |archiveurl=https://web.archive.org/web/20101227135212/http://www.bernzilla.com/item.php?id=33 |archivedate=2010-12-27 }}</ref>

W3C已在CSS3内包括了一个box-sizing属性。当为一个元素指定<code>box-sizing: border-box;</code>时，该元素的任意padding或border都在指定的width和height的''内部''，「就像通常旧版HTML用户代理所实施的那样」。<ref>{{Cite web | url=http://www.w3.org/TR/css3-ui/#box-sizing | title=CSS3 Basic User Interface Module | publisher=[[World_Wide_Web_Consortium|World Wide Web Consortium]] | accessdate=2012-02-09 | archive-date=2010-12-01 | archive-url=https://web.archive.org/web/20101201143323/http://www.w3.org/TR/css3-ui/#box-sizing | dead-url=no }}</ref> [[Internet_Explorer_8|Internet Explorer 8]]，[[WebKit|WebKit]]浏览器如[[Safari|Safari]] 5.1+和[[Google_Chrome|Google Chrome]]，[[Opera|Opera]] 7.0和以后版本，和[[Konqueror|Konqueror]] 3.3.2和以后版本均支持CSS3的box-sizing属性。基于[[Gecko|Gecko]]的浏览器如[[Mozilla_Firefox|Mozilla Firefox]]使用[[专有软件|厂商指定]]的<code>-moz-box-sizing</code>属性以支持相同功能<ref>{{Cite web |url=https://developer.mozilla.org/en/CSS/box-sizing |title=-moz-box-sizing |accessdate=2009-04-11 |work=[[Mozilla_Developer_Center|Mozilla Developer Center]] |publisher=[[Mozilla|Mozilla]] |date=2009-04-11 |quote=It is possible to use this property to emulate the behavior of browsers that do not correctly support the CSS box model specification. |archive-date=2010-06-26 |archive-url=https://web.archive.org/web/20100626234602/https://developer.mozilla.org/en/CSS/box-sizing |dead-url=no }}</ref>。

== 注释 ==
{{NoteFoot}}

== 参考文献 ==
{{Reflist|30em}}

==外部链接==
* [http://tantek.com/CSS/Examples/boxmodelhack.html Tantek Çelik's description of the "box model hack"]{{Wayback|url=http://tantek.com/CSS/Examples/boxmodelhack.html |date=20110716192750 }}
* [https://web.archive.org/web/20061209090244/http://webdesign.about.com/od/css/a/aaboxmodelhack.htm Getting Internet Explorer to Play Well with CSS] - 在about.com的概述了避开盒模型缺陷和其它IE问题的各种方式的文章。
* [http://msdn2.microsoft.com/en-us/library/Bb250496 Cascading Style Sheet Compatibility in Internet Explorer 7]{{Wayback|url=http://msdn2.microsoft.com/en-us/library/Bb250496 |date=20191017105259 }} - MSDN article, July 2006.
* [https://web.archive.org/web/20100103111556/http://renownedmedia.com/blog/css-box-model-differences-in-firefox-and-internet-explorer/ CSS Box Model differences in Firefox and Internet Explorer] - 对Mozilla Firefox与Internet Explorer之间渲染方式的差异的进一步解释。

{{-}}
{{Internet Explorer}}

[[category:Internet_Explorer|category:Internet Explorer]]
[[category:程式錯誤|category:程式錯誤]]
[[category:层叠样式表|category:层叠样式表]]