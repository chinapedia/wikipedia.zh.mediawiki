{{NoteTA
|G1=Math
}}
[[File:Regression_pic_assymetrique.gif|thumb]]
'''曲線擬合'''（{{lang-en|curve fitting}}），簡稱'''擬合'''，俗稱'''拉曲線'''，是一種構建一個[[函数|函数]][[函数图形|曲線]]，使之最佳地吻合現有{{tsl|en|data points|數據點}}的過程<ref>S.S. Halli, K.V. Rao. 1992. Advanced Techniques of Population Analysis. {{ISBN|0306439972}} Page 165 (''cf''. ... functions are fulfilled if we have a good to moderate fit for the observed data.)</ref>，該過程可能附加若干條件限制。<ref>[https://books.google.com/books?id=SI-VqAT4_hYC ''The Signal and the Noise: Why So Many Predictions Fail-but Some Don't.''] By Nate Silver</ref><ref>[https://books.google.com/books?id=hhdVr9F-JfAC Data Preparation for Data Mining]: Text. By Dorian Pyle.</ref>通俗地說，[[科学|科学]]和[[工程|工程]]问题通过诸如[[采样|采样]]、[[实验|实验]]等方法获得了若干[[离散|离散]]的数据点。根据这些数据，我们往往希望得到一个[[连续函数|连续的函数]]（也就是[[曲线|曲线]]）或者更加密集的离散方程与已知数据相吻合，该过程就叫做拟合。

曲線擬合中可以使用[[插值|插值]]<ref>Numerical Methods in Engineering with MATLAB®. By Jaan Kiusalaas. Page 24.</ref><ref>[https://books.google.com/books?id=YlkgAwAAQBAJ&printsec=frontcover#v=onepage&q=%22curve%20fitting%22&f=false Numerical Methods in Engineering with Python 3] {{Wayback|url=https://books.google.com/books?id=YlkgAwAAQBAJ&printsec=frontcover#v=onepage&q=%22curve%20fitting%22&f=false |date=20220608091120 }}. By Jaan Kiusalaas. Page 21.</ref>（需要精確吻合某數據時）或[[平滑|平滑]]<ref>[https://books.google.com/books?id=UjnB0FIWv_AC&printsec=frontcover#v=onepage&q=smoothing&f=false Numerical Methods of Curve Fitting] {{Wayback|url=https://books.google.com/books?id=UjnB0FIWv_AC&printsec=frontcover#v=onepage&q=smoothing&f=false |date=20220608091110 }}. By P. G. Guest, Philip George Guest. Page 349.</ref><ref>See also: [[柔化函数|Mollifier]]</ref>（構造一個平滑的函數曲線，近似符合數據點）。[[迴歸分析|迴歸分析]]是與擬合密切相關的一個話題<ref>[https://books.google.com/books?id=g1FO9pquF3kC&printsec=frontcover#v=snippet&q=%22regression%20analysis%22&f=false Fitting Models to Biological Data Using Linear and Nonlinear Regression] {{Wayback|url=https://books.google.com/books?id=g1FO9pquF3kC&printsec=frontcover#v=snippet&q=%22regression%20analysis%22&f=false |date=20220608091153 }}. By Harvey Motulsky, Arthur Christopoulos.</ref><ref>[https://books.google.com/books?id=Us4YE8lJVYMC&printsec=frontcover#v=onepage&q=%22regression%20analysis%22&f=false Regression Analysis] {{Wayback|url=https://books.google.com/books?id=Us4YE8lJVYMC&printsec=frontcover#v=onepage&q=%22regression%20analysis%22&f=false |date=20220608091059 }} By Rudolf J. Freund, William J. Wilson, Ping Sa. Page 269.</ref>，它更關注的是[[推論統計學|統計推斷]]，例如一條擬合到有隨機誤差的一組觀測數據的曲線有多大的不確定性。擬合曲線可以用作數據視覺化的一種輔助手段，<ref>Visual Informatics. Edited by Halimah Badioze Zaman, Peter Robinson, Maria Petrou, Patrick Olivier, Heiko Schröder. Page 689.</ref><ref>[https://books.google.com/books?id=rdJvXG1k3HsC&printsec=frontcover#v=onepage&q=%22Curve%20fitting%22&f=false Numerical Methods for Nonlinear Engineering Models] {{Wayback|url=https://books.google.com/books?id=rdJvXG1k3HsC&printsec=frontcover#v=onepage&q=%22Curve%20fitting%22&f=false |date=20201020231256 }}. By John R. Hauser. Page 227.</ref>以表示數據缺失的函數區間的取值，<ref>Methods of Experimental Physics: Spectroscopy, Volume 13, Part 1. By Claire Marton. Page 150.</ref>也可概括兩個或多個變量之間的關係。<ref>Encyclopedia of Research Design, Volume 1. Edited by Neil J. Salkind. Page 266.</ref>[[外推|外推]]（{{Lang|en|extrapolation}}）指的是使用曲線來擬合觀察數據[[全距|取值範圍]]以外的取值，<ref>[https://books.google.com/books?id=ba0hAQAAQBAJ&printsec=frontcover#v=snippet&q=%22Curve%20fitting%22%20OR%20extrapolation&f=false Community Analysis and Planning Techniques] {{Wayback|url=https://books.google.com/books?id=ba0hAQAAQBAJ&printsec=frontcover#v=snippet&q=%22Curve%20fitting%22%20OR%20extrapolation&f=false |date=20220608091045 }}. By Richard E. Klosterman. Page 1.</ref>往往因採取的構建函數的方式不同而有較大的[[不确定性|不确定性]]<ref>An Introduction to Risk and Uncertainty in the Evaluation of Environmental Investments. DIANE Publishing. [https://books.google.com/books?id=rJ23LWaZAqsC&pg=PA69 Pg 69] {{Wayback|url=https://books.google.com/books?id=rJ23LWaZAqsC&pg=PA69 |date=20161125095246 }}</ref>

== 將函數擬合至數據點 ==
最常見的是擬合成函數 {{math|''y''{{=}}''f''(''x'')}} 的形式。

[[File:Curve_fitting.svg|alt=用各種多項式曲線來擬合一段正弦函數生成的數據點]]
===將直線或多項式曲線擬合至數據點===
{{Main|多项式回归}}
{{See|多项式插值}}
一次多项式方程<math>y = ax + b\;</math>在[[笛卡尔平面|笛卡尔平面]]上是一條直線，而這條直線的[[斜率|斜率]]是{{Mvar|a}}。因為任何兩點可以決定一條直線，因此總能找到次數不多於1的多項式來串起任何兩個{{Mvar|x}}值相異的點。

如果把多次式的次數增加到2：

:<math>y = ax^2 + bx + c\; </math>

那麼只要給定{{Mvar|x}}值各異的3點，總會有次數不多於2的多項式可以把它們串起。

如果把多次式的次數再增加到3：

:<math>y = ax^3 + bx^2 + cx + d\;</math>

那麼只要給定{{Mvar|x}}值各異的4點，總會有次數不多於3的多項式可以把它們串起。

更準確而言，這條多項式能夠符合任何4個'''限制'''。限制可以是一點{{Math|(''x'', ''y'')}}、[[角度|角度]]或[[曲率|曲率]]（即{{Link-en|密切圆|osculating circle}}半徑的倒數{{Math|1/''R''}}）。角度和曲率的限制通常用在曲線的終端，此時稱為'''終端條件''' 。兩條不同多項式擬合曲線的轉換處通常會用到相同的終端條件，以確保[[樣條|樣條]]（{{lang|en|spline}}）平滑交接。也可以增加如曲率变化率等高阶约束。例如，在高速公路立体交叉点[[交匯處|苜蓿葉型]]的设计中，可以理解为汽车沿着苜蓿葉立交运动时作用在汽车上的力的变化率（[[加加速度|加加速度]]），并依此设定合理的限速。

一次多项式也可以拟合一个单点和一个角度的限制；三次多项式也可以拟合两点、一个角度约束以及一个曲率约束。许多其它类型的约束组合也同样可以用低阶或者高阶多项式来拟合。

在有超过{{Math|''n''+1}}个约束（{{Mvar|n}}是多项式的阶次）的情况下，多项式拟合可能仍然能满足所有约束。满足所有约束的精确拟合不一定能够得到（但是有可能得到，例如一次多项式拟合中的三点[[共線_(幾何)|共线]]）。通常，我们需要使用一些方法来评价拟合的好坏。[[最小平方法|最小平方法]]就是用来评价偏离的一种常用的方法。

虽然提高多项式的次数可能可以获得精确拟合，但有时我们仍会采用近似拟合，其原因有下：

*存在精确的拟合并也不意味着能很容易地得到这个拟合。根据使用的算法不同，可能遇到发散的情形，要么无法得到精确拟合，要么需要太长的计算时间才能获得精确拟合。不管哪种情况，最终都会以得到近似拟合而结束。
*通常人們會希望得到一个近似的拟合以抹平数据点的随机波动，而不是为了“精确”拟合数据而扭曲拟合曲线。
*[[龙格现象|龙格现象]]：高次多项式往往有高度波动的特性。如果通过两点A和B作一条曲线，可以期望该曲线也大概会通过AB中点附近的某处。但是对于高次多项式，情况就不是如此了，高次多项式曲线往往可能有绝对值很大的[[幅值|幅值]]。对于低次多项式，曲线波动不大，因此能通过中点附近（对于一次多项式，能保证肯定通过中点）。

===將其他函數擬合至數據點===
[[File:Gohana_inverted_S-curve.png|thumb]]

其他類型的曲線在特定條件下也可使用，諸如[[三角函数|三角函数]]（如[[正弦|正弦]]或[[餘弦|餘弦]]函數）。

在光譜學中，數據可以使用[[常態分布|高斯]]、[[柯西分布|柯西]]、[[福格特函數|福格特]]等相關函數來擬合。

在生物學、生態學、人口學、傳染病學等學科中，生物個體數增長、傳染病擴散等數據可以用[[逻辑斯谛函数|逻辑斯谛函数]]（一种[[S型函數|S型函數]]）來擬合。

在農業中，倒[[S型函數|S型函數]]被用於描述作物產量和生長因子之間的關係。右方藍色的圖表是將農田中的測量數據進行[[邏輯迴歸|S形回歸]]得出的。可以看出作物產量在土壤鹽度增加時先緩慢降低，之後降得更快，最終又趨於緩和。

== 代數擬合與幾何擬合 ==
在数据的代数分析中，“拟合”通常意味着试图找到使点的垂直（y轴）方向偏移最小的曲线（例如[[普通最小二乘法|普通最小二乘法]]）。然而，对于图形和图像应用，几何拟合可以提供最佳的视觉拟合；它通常试图使到曲线的正交距离最少（例如{{tsl|en|total least squares|整体最小二乘法}}），或以其他方式将点和曲线之间两个轴的方向上的偏移都考虑在内。由于往往需要非线性和/或迭代运算，尽管几何拟合的结果有更美观和几何上更准确的优势，但实际上较少使用。<ref>{{citation |first=Sung-Joon |last=Ahn |title=Geometric Fitting of Parametric Curves and Surfaces |journal=Journal of Information Processing Systems |volume=4 |issue=4 |pages=153–158 |date=December 2008 |doi=10.3745/JIPS.2008.4.4.153 |url=http://jips-k.org/dlibrary/JIPS_v04_no4_paper4.pdf |url-status=dead |archiveurl=https://web.archive.org/web/20140313084307/http://jips-k.org/dlibrary/JIPS_v04_no4_paper4.pdf |archivedate=2014-03-13 }}</ref><ref>{{citation |first1=N. |last1=Chernov |first2=H. |last2=Ma |year=2011 |contribution=Least squares fitting of quadratic curves and surfaces |title=Computer Vision |editor-first=Sota R. |editor-last=Yoshida |publisher=Nova Science Publishers |isbn=9781612093994 |pages=285–302 |url=<!-- http://people.cas.uab.edu/~mosya/papers/CM1nova.pdf No indication of copyright --> }}</ref><ref>{{citation |first1=Yang |last1=Liu |first2=Wenping |last2=Wang |year=2008 |contribution=A Revisit to Least Squares Orthogonal Distance Fitting of Parametric Curves and Surfaces |editor1-first=F. |editor1-last=Chen |editor2-first=B. |editor2-last=Juttler |title=Advances in Geometric Modeling and Processing |series=Lecture Notes in Computer Science |volume=4975 |pages=384–397 |doi=10.1007/978-3-540-79246-8_29 |isbn=978-3-540-79245-1|citeseerx=10.1.1.306.6085 }}</ref>

== 將平面曲線擬合至數據點 ==

==软件==
很多{{tsl|en|List of statistical packages|统计软件包列表|统计软件包}}，例如[[R语言|R语言]]，以及{{tsl|en|List of numerical-analysis software|数值分析软件列表|数值分析软件}}，例如[[gnuplot|gnuplot]]、[[GNU科学库|GNU科学库]]、{{tsl|en|MLAB|MLAB}}、[[Maple|Maple]]、[[MATLAB|MATLAB]]、TK Solver 6.0、[[Scilab|Scilab]]、[[Wolfram_Mathematica|Mathematica]]、[[GNU_Octave|GNU Octave]]和[[SciPy|SciPy]]，都可以用命令行进行不同情景下的曲线拟合。

== 参见 ==
{{div col|3}}
* [[测量平差|测量平差]]
* {{tsl|en|Curve-fitting compaction|曲线配适紧密}}
* [[估计理论|估计理论]]
* {{tsl|en|Function approximation|函数逼近}}
* {{tsl|en|Goodness of fit|拟合优度}}
* [[遗传编程|遗传编程]]
* [[莱文伯格-马夸特方法|莱文伯格-马夸特方法]]
* {{tsl|en|Line fitting|直线拟合}}
* {{tsl|en|Multi expression programming|多表达式编程}}
* [[非线性回归|非线性回归]]
* [[過適|過適]]
* [[平面曲线|平面曲线]]
* {{tsl|en|Distribution fitting|分布拟合}}
* {{tsl|en|Sinusoidal model|正弦模型}}
* [[平滑|平滑]]
* [[样条函数|样条函数]]（[[样条插值|样条插值]]、{{tsl|en|Smoothing spline|平滑样条}}）
* [[時間序列|時間序列]]
* {{tsl|en|Total least squares|整体最小二乘法}}
* {{tsl|en|Trend estimation|趋势估计}}
{{div col end}}

==参考文献==
{{Reflist|2}}

==外部連結==
*[https://web.archive.org/web/20060507151227/http://www.ebicom.net/~dhyams/cftp.htm Curve Expert (shareware)] fits functions to data (limited to one dependant and one independent variable.) 
*[https://web.archive.org/web/20190923083507/http://zunzun.com/ Zunzun.com] Online curve and surface fitting
*[http://www.systat.com TableCurve2D and TableCurve3D by Systat] {{Wayback|url=http://www.systat.com/ |date=20060126204341 }} automates curve fitting
<!--*[http://intrepid.mcs.kent.edu/~blewis/stat/lsq.html  LMS applet]-->
*[http://www.softintegration.com/chhtml/lang/lib/libch/numeric/CGI_Curvefit.html another choice] {{Wayback|url=http://www.softintegration.com/chhtml/lang/lib/libch/numeric/CGI_Curvefit.html |date=20090723224517 }}
*[http://curvefit.com/ online curve-fitting textbook] {{Wayback|url=http://curvefit.com/ |date=20090721185419 }}
*[https://web.archive.org/web/20060325083538/http://www.savetman.com/curvefit/index.html Interactive curve fitting using Least Squares with Weights on savetman.com]

[[Category:統計學|Category:統計學]]
[[Category:插值论|Category:插值论]]
[[Category:回归分析|Category:回归分析]]