{{NoteTA|G1=IT|G2=Windows}}
{{Distinguish|特殊文件夹|卷挂载点|NTFS符号链接|NTFS junction点}}
{{校对翻译}}
在计算机领域，'''虚拟文件夹'''（{{lang-en|Virtual folder}}）通常指管理一批文件的一个虚拟的[[文件夹|文件夹]]，它不依赖于[[目录|目录]][[树_(数据结构)|树层级]]中的位置，而是由软件将数据存储中的结果合并显示。这可能是一个数据库或自定义索引，然后在文件夹视图中以可视方式呈现它们。虚拟文件夹可以被认为是列出具有特定标记文件的一个视图，在需要时即时将动态内容模拟为一个文件夹并呈现。在[[计算机科学|计算机科学]]中有几个相似的理念，包括已保存的搜索、已保存的查询和过滤等。

== 技术 ==
虚拟文件夹为用户提供一种更方便方法管理一批内容相关的文件。根据用户所需的特定标准的或所有的文件被聚合到一个虚拟文件夹。虚拟文件夹中的文件不限于硬盘上的某个物理位置，也可能其他形式。事实上，虚拟文件夹中的文件甚至可以并未存储在硬盘上，它们可以是网络共享或自定义应用数据库中的内容，例如邮件或其他数据库。<span class="cx-segment" data-segmentid="30"></span>

文件“不能”被存储在虚拟文件夹中，因为那本质上只是一个文件存储的搜索查询。尝试存储文件到虚拟文件夹可能遇到多种情况，取决于软件实现，文件可能被重定向到某个物理存储空间。<span class="cx-segment" data-segmentid="33"></span>

大多数实现都会预先索引硬盘或特定位置上的文件以加速搜索，这样在搜索开始时可以查询索引以快速展现和完成搜索任务，避免等待索引和查询整个文件夹结构。<span class="cx-segment" data-segmentid="37"></span>

== 实现 ==
虚拟文件夹可以是[[操作系统|操作系统]]中的一种结构。[[BeOS|BeOS]]包含一种被称为“已保存查询”的虚拟文件夹，这对虚拟文件夹在操作系统中的开发产生了影响（包括Mac OS X、Windows和Linux）。虚拟文件夹会在整个文件系统上执行搜索以动态填充内容，及使用子集或[[缓存|已缓存]]的搜索结果。

== 历史 ==

=== BeOS ===
此操作系统的首个开发者预览版发布于1995年10月，包括类似数据库的功能，使用户能更方便地管理自己的文件。为了此功能，文件系统会索引特定文件属性以帮助快速搜索。默认情况下，文件系统会自动索引文件名、大小和最后修改日期，当其他应用程序或用户告知时还可创建其他属性的索引。<ref>{{Cite book|title=The BeOS Bible|publisher=Peachpit Press|year=1999|isbn=0-201-35377-6|author=Scot Hacker}}</ref>

当用户执行文件搜索时，在文件夹 "/boot/home/queries" 中会创建一个文件，文件名称根据查询内容和搜索的日期时间派生，例如“Name = Western Infirmary - Mar 21, 11:59:40 PM”。搜索的查询条件存储在被称为“qrystr”文件的一个属性中。<ref>{{Cite web|url=http://betips.net/1997/09/09/show-formula-query-strings-in-tracker/|title=Show formula query strings in Tracker|accessdate=2007-03-22|author=Chris Herborth|work=The BeOS Tip Server|archive-url=https://web.archive.org/web/20081121051208/http://betips.net/1997/09/09/show-formula-query-strings-in-tracker/|archive-date=2008-11-21|dead-url=yes}}</ref>当该文件被打开时，文件系统会查询索引和打开一个跟踪窗口，保持最新的匹配条件的文件列表。

更多搜索功能被添加到后续的版本中。Release 2引入了编辑已保存查询的功能，<ref>{{Cite web|url=http://www.beatjapan.org/mirror/www.be.com/aboutbe/pressreleases/97-10-07_Preview2Ship.html|title=Be Ships BeOS Preview Release 2|accessdate=2006-12-24|author=Be Inc.|date=October 7, 1997|publisher=Be Inc.|archive-date=2007-09-28|archive-url=https://web.archive.org/web/20070928030007/http://www.beatjapan.org/mirror/www.be.com/aboutbe/pressreleases/97-10-07_Preview2Ship.html|dead-url=yes}}</ref>Release 3允许用户自己定义已保存查询的名称<ref>{{Cite web|url=http://www.beatjapan.org/mirror/www.be.com/users/tips/tip41.html|title=Searching on the BeOS|accessdate=2006-12-24|author=Be Inc.|work=The BeOS Tip of the Week|publisher=Be Inc.|archive-date=2002-07-24|archive-url=https://web.archive.org/web/20020724192405/http://www.beatjapan.org/mirror/www.be.com/users/tips/tip41.html|dead-url=yes}}</ref>在1998年的Release 4之前，所有查询都会无限期存储。但从R4开始，BeOS开发者为所有查询引入了7天的时间限制。如果用户想将一个查询保留下来，他们可以在“查找”对话框取消“临时”标记。<ref>{{Cite web|url=http://betips.net/1997/09/09/self-destructing-queries/|title=Self-destructing queries|accessdate=2007-03-22|author=Scot Hacker|work=The BeOS Tip Server|archive-url=https://web.archive.org/web/20080423225244/http://betips.net/1997/09/09/self-destructing-queries/|archive-date=2008-04-23|dead-url=yes}}</ref>

=== Mac OS X ===
BeOS文件系统的领头开发者之一Dominic Giampaolo曾参与[[蘋果公司|苹果公司]]的[[OS_X|Mac OS X]]操作系统并为其添加了虚拟文件夹系统。<ref>{{Cite web|url=http://www.nobius.org/~dbg/|title=Personal homepage|accessdate=2006-09-10|author=Dominic Giampaolo|archive-date=2017-10-22|archive-url=https://web.archive.org/web/20171022190902/http://www.nobius.org/~dbg/|dead-url=no}}</ref>

2005年4月，苹果公司发布[[Mac_OS_X_Tiger|Mac OS X v10.4]]，其中就包括被称为“'''智能文件夹'''”的虚拟文件夹。这些文件夹实质上由[[Spotlight|Spotlight]]引擎动态更新以包含匹配特定条件的内容。例如，这可以给你带来一个特殊文件夹，其中包含所有包含关键词“shpadoinkle”且在最近7天曾经编辑的[[Microsoft_Word|Word]]文档。智能文件夹是通过保存一个Spotlight搜索来创建，搜索条件记录在一个.'''savedSearch'''后缀的[[Plist|属性列表]]文件中，默认情况下保存在“/Users/username/Library/Saved Searches”文件夹。

在许多Spotlight引擎的应用程序中可以看到“智能文件夹”概念的变种，通常以紫色色调的齿轮图标标记。例如：[[郵件_(OS_X)|邮件]]中的智能邮箱和通讯录中的智能组。

在没有Spotlight的[[OS_X|Mac OS X]]早期版本中，iApps（[[iTunes|iTunes]]和[[iPhoto|iPhoto]]）有一个类似的概念，但它们没有使用系统级的Spotlight引擎。

=== Windows {{Anchor|Windows Vista}} ===
2006年11月，微软发布[[Windows_Vista|Windows Vista]]，其中允许用户保存任何搜索查询为“搜索文件夹”，这就是一种虚拟文件夹。搜索文件夹的设计目的是用户不需要记住自己的文件存储在哪里。<ref name="WindowsVistaVirtualFolders">{{Cite web|url=http://www.microsoft.com/betaexperience/nlarchive/bexp2/issue_7/WindowsVistaSearch.aspx|title=Windows Vista Virtual Folders and Search|accessdate=October 23, 2015|last=Price|first=John|work=[[MSDN|MSDN]]|publisher=[[Microsoft|Microsoft]]|archive-date=2016-03-05|archive-url=https://web.archive.org/web/20160305021914/http://www.microsoft.com/betaexperience/nlarchive/bexp2/issue_7/WindowsVistaSearch.aspx|dead-url=no}}</ref><ref name="TechRepublicID">{{Cite web|url=http://www.techrepublic.com/article/an-in-depth-look-at-windows-vistas-virtual-folders-technology/|title=An in-depth look at Windows Vista's Virtual Folders technology|accessdate=November 15, 2015|date=October 12, 2005|last=Shultz|first=Greg|work=[[TechRepublic|TechRepublic]]|publisher=[[CBS_Interactive|CBS Interactive]]|archive-date=2015-11-17|archive-url=https://web.archive.org/web/20151117022434/http://www.techrepublic.com/article/an-in-depth-look-at-windows-vistas-virtual-folders-technology/|dead-url=no}}</ref>搜索文件夹不是物理文件夹，它本质上是一个XML文件，为[[Windows搜索|Windows搜索]]子系统提供一个已定义查询的存储。<ref name="SavedSearchFileFormat">{{Cite web|url=https://msdn.microsoft.com/en-us/library/windows/desktop/bb892885%28v=vs.85%29.aspx|title=Saved Search File Format|accessdate=November 11, 2015|author=[[Microsoft|Microsoft]]|work=[[Microsoft_Developer_Network|MSDN]]|archive-date=2015-12-10|archive-url=https://web.archive.org/web/20151210223435/https://msdn.microsoft.com/en-us/library/windows/desktop/bb892885(v=vs.85).aspx|dead-url=no}}</ref>正因如此，搜索文件夹可以在任何可创建普通文件夹的地方创建。类似的方法[[Windows_XP|Windows XP]]中也存在，当Windows索引服务启用时，搜索可以保存为.fnd文件。<ref name="WindowsVistaVirtualFolders"/><ref name="TechRepublicID"/>但是，在Windows XP中的已保存搜索查询只保存了用户的搜索条件；用户仍需指定搜索位置并再次执行搜索，并且搜索结果非动态呈现。<ref name="TechRepublicID"/>

无论何时访问“搜索文件夹”，它都会返回与已保存搜索查询相关的结果；结果清单中呈现的是实际的文件和文件夹。搜索查询的定义可基于许多参数和属性，包括文件名、指定日期、文件本身内容、相关[[元数据|元数据]]、文件类型、文件所在位置及其他各种属性。<ref name="TechRepublic">{{Cite web|url=http://www.techrepublic.com/blog/how-do-i/how-do-i-save-and-refine-desktop-searches-in-microsoft-windows-vista/|title=How do I... Save and refine desktop searches in Microsoft Windows Vista?|accessdate=November 11, 2015|date=July 17, 2007|last=Kaelin|first=Mark|work=[[TechRepublic|TechRepublic]]|publisher=[[CBS_Interactive|CBS Interactive]]|archive-date=2015-11-17|archive-url=https://web.archive.org/web/20151117063919/http://www.techrepublic.com/blog/how-do-i/how-do-i-save-and-refine-desktop-searches-in-microsoft-windows-vista/|dead-url=no}}</ref>被称为“查询组件”的功能允许搜索者基于其他“搜索文件夹”进一步细分结果。<ref name="QueryComposition">{{Cite web|url=http://shellrevealed.com/blogs/shellblog/archive/2006/10/31/Query-Composition_3A00_-Building-a-search-upon-another-search.aspx|title=Query Composition: Building a search upon another search|accessdate=October 20, 2015|date=October 31, 2006|last=Bentz|first=Ben|work=Shell: Revealed Blog|publisher=[[Microsoft|Microsoft]]|archiveurl=https://web.archive.org/web/20061215210717/http://shellrevealed.com/blogs/shellblog/archive/2006/10/31/Query-Composition_3A00_-Building-a-search-upon-another-search.aspx|archivedate=2006-12-15|dead-url=yes}}</ref><ref name="SchultzQueryComposition">{{Cite web|url=http://www.techrepublic.com/blog/windows-and-office/narrow-a-saved-search-with-vistas-query-composition-feature/|title=Narrow a saved search with Vista's Query Composition feature|accessdate=November 11, 2015|date=December 11, 2007|last=Shultz|first=Greg|work=[[TechRepublic|TechRepublic]]|publisher=[[CBS_Interactive|CBS Interactive]]|archive-date=2017-03-11|archive-url=https://web.archive.org/web/20170311222731/http://www.techrepublic.com/blog/windows-and-office/narrow-a-saved-search-with-vistas-query-composition-feature/|dead-url=no}}</ref>

Windows Vista在默认情况下， references the profile of the user who originally created a saved search as part of the query's scope, which includes the [[硬盘分区|disk partition]].<ref name="SearchMelt">{{Cite web|url=http://windowsvistablog.com/blogs/windowsvista/archive/2007/05/14/searching-part-iii-do-you-know-what-a-searchmelt-is.aspx|title=Searcing, part III: Do you know what a SearchMelt is?|accessdate=October 20, 2015|date=May 14, 2007|last=White|first=Nick|work=Windows Vista Team Blog|publisher=[[Microsoft|Microsoft]]|archiveurl=https://web.archive.org/web/20070516034547/http://windowsvistablog.com/blogs/windowsvista/archive/2007/05/14/searching-part-iii-do-you-know-what-a-searchmelt-is.aspx|archivedate=2007年5月16日|deadurl=yes}}</ref> This design choice does not prevent saved searches from being shared with other users, but it prevents them from operating on different partitions or user profiles. 虽然用户可以手动修改已保存搜索的内容将引用范围改为%USERPROFILE%[[环境变量|环境变量]]， which will enable it to operate on other machines or profiles regardless of the original author or location, 微软已发布一个“SearchMelt Creator”实用工具允许用户自动执行此流程。<ref name="SearchMelt">{{Cite web|url=http://windowsvistablog.com/blogs/windowsvista/archive/2007/05/14/searching-part-iii-do-you-know-what-a-searchmelt-is.aspx|title=Searcing, part III: Do you know what a SearchMelt is?|accessdate=October 20, 2015|date=May 14, 2007|last=White|first=Nick|work=Windows Vista Team Blog|publisher=[[Microsoft|Microsoft]]|archiveurl=https://web.archive.org/web/20070516034547/http://windowsvistablog.com/blogs/windowsvista/archive/2007/05/14/searching-part-iii-do-you-know-what-a-searchmelt-is.aspx|archivedate=2007年5月16日|deadurl=yes}}</ref>

在Windows Vista的早期开发版本中，这些为默认的[[Special_Folders|用户配置文件夹]]预配置的“搜索文件夹”（例如[[我的文件|文档]]、音乐和图片）取代了Windows[[开始选单|开始菜单]]上的那些文件夹链接。<ref name="DisplayDrivers">{{Cite web|url=http://winsupersite.com/article/product-review/working-with-display-drivers-in-windows-vista-beta-1|title=Working with Display Drivers in Windows Vista Beta 1|accessdate=November 11, 2015|date=October 6, 2010|last=Thurrott|first=Paul|authorlink=Paul Thurrott|work=SuperSite for Windows|publisher=[[Penton_(company)|Penton]]|archive-url=https://web.archive.org/web/20160404093108/http://winsupersite.com/article/product-review/working-with-display-drivers-in-windows-vista-beta-1|archive-date=2016-04-04|dead-url=yes}}</ref><ref name="OReilly">{{Cite web|url=http://www.windowsdevcenter.com/pub/a/windows/2005/08/02/vista.html?page=2|title=An In-Depth Look at Vista, Part 2|accessdate=November 11, 2015|date=August 2, 2005|last=Lee|first=Wei-Meng|publisher=[[O'Reilly_Media|O'Reilly Media]]|archive-date=2016-03-04|archive-url=https://web.archive.org/web/20160304071443/http://www.windowsdevcenter.com/pub/a/windows/2005/08/02/vista.html?page=2|dead-url=no}}</ref>在Windows文件资源浏览器中浏览时，导航面板会动态填充与当前查看视图相关的“搜索文件夹”；举一个例子，当查看“文档”文件夹时，导航面板会基于文档的作者、关键词、类型和最近更改的文档生成一个“搜索文件夹”。这些预发布版本的操作系统也包括其他虚拟文件夹，<ref name="WindowsVistaVirtualFolders"/>搜索都通过主要的“库”搜索文件夹聚合。<ref name="QueryComposition"/> 微软的表示这种做法的目标是完全超越传统的物理文件夹概念，<ref name="VirtualFolders">{{Cite web|url=http://winsupersite.com/reviews/winvista_5270.asp|title=Windows Vista December 2005 CTP (Build 5270) Review Part 1: Setup and User Interface|accessdate=October 13, 2015|date=December 21, 2005|last=Thurrott|first=Paul|authorlink=Paul Thurrott|work=SuperSite for Windows|publisher=[[Penton_(company)|Penton]]|archiveurl=https://web.archive.org/web/20051223080047/http://winsupersite.com/reviews/winvista_5270.asp|archivedate=2005-12-23|deadurl=yes}}</ref>但公司收到的反馈显示大量用户对新的方式感到困惑/混乱。<ref name="QueryComposition"/>尤其是“搜索文件夹”被放在开始菜单导致人们相信它们是具有类似名称和内容的多个物理文件夹。<ref name="VirtualFolders"/>

基于这种反馈，公司决定恢复在开始菜单上放置物理文件夹的链接，方法类似以前Windows版本的显示方式，并移除几个至Windows Vista[[軟件版本週期|发布到制造商]]时可用的“搜索文件夹”。尽管在界面上不那么明显，该操作系统仍包含几个预配置的搜索文件夹：最近的文档、最近的电子邮件、最近的音乐、最近的图片和视频、最近的更改以及“与我共享”，这些都是由一个“索引位置”搜索文件夹提供，实现了早期的“库”概念。<ref name="QueryComposition"/>

在Windows 7中，虚拟文件夹的概念被显著实现为“库”功能。类似“已保存的搜索”，“库”在本质上只是一个扩展名为 <code>.library-ms</code> 的XML文件，功能是收集具有特定属性的一批文件并在熟悉的文件夹风格界面上显示它们。库在[[文件资源管理器|文件资源管理器]]上进行了命名空间扩展，其XML文件可以在各Windows或网络上重用。

=== GNOME ===
在GNOME 2.14中，已保存的搜索是一个虚拟文件夹，内容是[[Nautilus檔案瀏覽器|Nautilus]]的搜索结果，内容来自多个后端。这些文件夹的内容在文件夹打开时会动态确定，并在文件被创建或修改时自动更新。<span class="cx-segment" data-segmentid="170"></span>

=== 其他实现 ===

==== 电子邮件客户端 ====
虚拟文件夹是[[電子郵件用戶端|电子邮件客户端]]的一种常见设计结构。在1991年初，基于Emacs的邮件阅读器VM在其5.09版本中就已提供虚拟文件夹设计。<ref>{{Cite web|url=http://www.wonderworks.com/vm/user-manual/vm_15.html#SEC28|title=VM User's Manual - Virtual Folders|accessdate=2010-01-26|author=Kyle Jones|publisher=Wonderworks|archive-date=2020-10-01|archive-url=https://web.archive.org/web/20201001090805/http://www.wonderworks.com/vm/user-manual/vm_15.html#SEC28|dead-url=no}}</ref><ref>{{Cite web|url=http://web.psung.name/emacstips/vm.html|title=VM Configuration and Workflow|accessdate=2010-03-13|author=Phil Sung|archive-date=2020-09-22|archive-url=https://web.archive.org/web/20200922053055/http://web.psung.name/emacstips/vm.html|dead-url=no}}</ref> VM允许用户使用规则定义虚拟文件夹，这可涉及一个或多个物理文件夹中的邮件内容，并可基于特定选择条件，如日期、作者、收件人、主题、邮件正文等。虚拟文件夹还可基于以前定义的虚拟文件夹创建，这样可以根据标准重复筛选Helix Code在2000年创建的[[Novell_Evolution|Evolution]]邮件客户端也纳入了虚拟文件夹。可以创建文件夹并自动列出与用户定义规则匹配的邮件，例如列出所有涉及特定地址的邮件，或者所有包含特定关键词的邮件。<ref>{{Cite web|url=http://linuxplanet.com/linuxplanet/previews/2013/1/|title=You Say You Want an Evolution|accessdate=2006-12-24|author=Michael Hall|date=June 30, 2000|publisher=Linux Planet|archive-date=2019-02-09|archive-url=https://web.archive.org/web/20190209180115/http://www.linuxplanet.com/linuxplanet/previews/2013/1/|dead-url=no}}</ref><ref>{{Cite web|url=http://www.linuxtoday.com/news_story.php3?ltsn=1999-07-08-002-10-NW-LF|title=Dave Whitinger and Miguel de Icaza at the ZD Open Source Forum|accessdate=2006-12-24|author=Dave Whitinger|date=July 8, 1999|publisher=Linux Today|archive-date=2012-02-08|archive-url=https://web.archive.org/web/20120208075802/http://www.linuxtoday.com/news_story.php3?ltsn=1999-07-08-002-10-NW-LF|dead-url=no}}</ref>[[Opera|Opera]]网络浏览器提供的新邮件客户端（2002年11月发布测试版，2003年1月发布正式版）同样提供虚拟文件夹（称之为访问点）用于电子邮件的管理。它的虚拟文件夹会自动基于活跃联系人、附件和已分配标签创建。虚拟文件夹也会因执行搜索而创建，并且手动虚拟文件夹可以使用多个逻辑邮件头完成自动分类（包括使用[[正则表达式|正则表达式]]）。[[Microsoft_Outlook|Microsoft Outlook 2003]]添加了类似功能，称之为“搜索文件夹”。2004年[[Gmail|Gmail]]的首个发布版本中，其所有邮件的管理就基于“标签”实现的虚拟文件夹。[[Mozilla_Thunderbird|Mozilla Thunderbird]]也可以创建搜索文件夹，并允许搜索多个电子邮件账户。<ref>{{Cite web|url=http://kb.mozillazine.org/Saved_Search|title=Saved Search - MozillaZine Knowledge Base|accessdate=2010-01-22|archive-date=2021-02-11|archive-url=https://web.archive.org/web/20210211183904/http://kb.mozillazine.org/Saved_Search|dead-url=no}}</ref>

==== 音乐客户端 ====
2002年7月，苹果公司宣布[[iTunes|iTunes]] 3提供“智能播放列表”功能，这可以被认为是一种虚拟文件夹。唯一的区别是搜索不是在文件系统的文件夹结构，而是在其内部的存储区。微软在2003年也在Windows XP的<ref>{{Cite web|url=http://www.apple.com/pr/library/2002/jul/17itunes.html|title=Apple Announces iTunes 3|accessdate=2006-12-25|author=Apple|date=July 17, 2002|publisher=Apple|deadurl=yes|archiveurl=https://web.archive.org/web/20070530162245/http://www.apple.com/pr/library/2002/jul/17itunes.html|archivedate=2007-05-30}}</ref>[[Windows_Media_Player|Windows Media Player]] 9中添加类似功能，称之为“自动播放列表”。<ref>{{Cite web|url=http://www.microsoft.com/presspass/press/2003/jan03/01-07moviemakerplayerfinalpr.mspx|title=Microsoft Announces Digital Media Upgrade for Windows XP With Final Release of Windows Media Player 9 Series and Windows Movie Maker 2|accessdate=2006-12-25|author=Microsoft|date=January 3, 2003|publisher=Microsoft|archive-url=https://web.archive.org/web/20070309035519/http://www.microsoft.com/presspass/press/2003/jan03/01-07moviemakerplayerfinalpr.mspx|archive-date=2007-03-09|dead-url=yes}}</ref>

== 参考资料 ==
{{Reflist|2}}

== 参见 ==
* [[Windows_Vista新功能|Windows Vista新功能]]
* [[WinFS|WinFS]]
[[Category:文件系统|Category:文件系统]]
[[Category:Windows_Vista|Category:Windows Vista]]
[[Category:微软磁盘文件系统|Category:微软磁盘文件系统]]