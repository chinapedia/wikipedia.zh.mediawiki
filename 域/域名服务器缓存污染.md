{{Refimprove|time=2013-01-08T07:56:35+00:00}}
{{Globalize/Mainland China|time=2016-06-22T09:39:17+00:00}}
{{Copyedit}}
{{NoteTA
|G1 = IT
|1 = zh-cn:污染; zh-tw:汙染; zh-hk:污染;
|2 = zh-cn:局域; zh-tw:區域;
}}
'''網域伺服器快取污染'''（DNS cache pollution），又称'''域名服务器缓存投毒'''（DNS cache poisoning）、'''DNS缓存投毒'''，是指一些刻意製造或無意中製造出來的域名伺服器[[封包|封包]]，把域名指往不正確的IP位址。一般來說，在[[互聯網|互聯網]]上都有可信賴的[[網域伺服器|網域伺服器]]，但為減低網絡上的流量壓力，一般的域名服务器都會把从上游的域名服务器获得的解析记录暫存起來，待下次有其他機器要求解析域名時，可以立即提供服務。一旦有關網域的局域域名服务器的缓存受到污染，就會把網域內的電腦導引往錯誤的服务器或伺服器的網址。

域名服务器快取污染可能是因为域名伺服器軟件的設計錯誤而產生，但亦可能由別有用心者透過研究開放架構的域名伺服器系統來利用當中的漏洞。
[[File:FixDNSPoisoningWin2K3-20080821.png|thumb]]的某些域名封包設定，可以摒除有可疑的封包。<ref name=mskb>{{cite web|url=http://support.microsoft.com/kb/241352|publisher=Microsoft 技術支援服務|title=如何防止 DNS 快取侵害|date=2007-02-28|accessdate=2008-08-21}}</ref>]]

為防止局域的域名伺服器缓存污染除了要定時更新伺服器的軟件以外，可能還需要人手變更某些設定，以控制伺服器對可疑的域名封包作出篩選。<ref name=mskb />

== 缓存污染攻擊 ==
一般來說，一部連上了互聯網的電腦都會使用[[互聯網服務供應商|互聯網服務供應商]]提供的域名伺服器。這個服务器一般只會服務供應商的客戶，通常都會將部分客戶曾經請求過的域名暫存起來，這種伺服器被稱為非權威伺服器，其應答稱非權威應答。快取污染攻擊就是針對這一種伺服器，以影響服务器的使用者或下游服務。

=== 中国防火長城 ===
在中國大陆，對所有经过[[防火長城|防火長城]]的在UDP的53端口上的域名查询进行IDS[[入侵检测|入侵检测]]，一經發現與黑名單關鍵詞相匹配的域名查詢請求，會馬上伪装成目标域名的解析服务器返回虚假的查詢结果。由于通常的域名查询没有任何认证机制，而且域名查詢通常基于无连接不可靠的[[UDP協議|UDP協議]]，查询者只能接受最先到达的格式正确结果，并丢弃之后的结果。<ref name=gfw>{{cite web|url=http://gfwrev.blogspot.com/2009/11/gfwdns.html|title=深入了解GFW：DNS污染|date=2009-11-27|accessdate=2011-02-06}}</ref>

* 对于不了解相关知识的网民来说，由于系统默认使用的[[ISP|ISP]]提供的域名查詢服务器查询国外的权威服务器时即被防火長城污染，進而使其缓存受到污染，因此默认情况下查询ISP的服务器就会获得虚假IP地址；而用户直接查询境外域名查詢伺服器（比如 [[Google_Public_DNS|Google Public DNS]]）時有可能會直接被防火長城污染，-{zh-cn:从而;zh-tw:進而}-在没有任何防范机制的情况下仍然不能获得目標網站正确的IP地址。<ref name=gfw/>

* 因為TCP连接的機制可靠，防火长城理论上未对TCP协议下的域名查询进行污染，故现在能透過强制使用TCP协议查询真实的IP地址。而-{zh-hans:现实;zh-tw:目前}-的情况是，防火长城对於真实的IP地址也可能会采取其它的手段进行封锁，或者对查询行为使用[[连接重置|连接重置]]的方法进行拦截，故能否真正访问可能还需要其它[[翻墙|翻墙]]的手段。

* 通常情况下无论使用设置在中国大陆的DNS服务还是使用设置在外国的DNS服务，因为解析结果都需要穿过GFW，所以都会被GFW污染。但是仍有一些设置在中国大陆的小型DNS使用技术手段回避GFW的污染并提供不受污染的结果，通常使用这些小型DNS也能够访问其他被封锁的网站。

* 根据互联网上长期收集到的污染目标的虚假IP地址列表，可以发现污染的无效IP在一段时间后会更新，最后一次更新在2017年10月。防火长城会将黑名单内的域名重新導向至不限于以下列表的IP地址：<ref>{{cite web||url=https://www.v2ex.com/t/531721|title=查 dns 污染的时候发现了一个有趣的事情|date=2019-01-31|accessdate=|author=|publisher=V2EX}}</ref>

==== IPv4环境 ====
<div style="{{column-count|3}}">
* 8.7.198.45
* 31.13.64.1 
*31.13.64.33 
*31.13.64.49 
*31.13.65.1 
*31.13.65.17 
*31.13.65.18 
*31.13.66.1 
*31.13.66.6 
*31.13.66.23 
*31.13.68.1 
*31.13.68.22
*31.13.69.33 
*31.13.69.86 
*31.13.69.129 
*31.13.69.160 
*31.13.70.1 
*31.13.70.20 
*31.13.71.7 
*31.13.71.23 
*31.13.72.1 
*31.13.72.17 
*31.13.72.23 
*31.13.72.34 
*31.13.72.54 
*31.13.73.1 
*31.13.73.17 
*31.13.73.23 
*31.13.74.1 
*31.13.74.17 
*31.13.75.17 
*31.13.75.18 
*31.13.76.8 
*31.13.76.16
*31.13.77.33 
*31.13.77.55 
*31.13.78.65 
*31.13.78.66 
*31.13.79.1 
*31.13.79.17 
*31.13.80.1 
*31.13.80.17 
*31.13.81.1 
*31.13.81.17 
*31.13.82.1 
*31.13.82.17 
*31.13.82.23 
*31.13.83.1 
*31.13.83.8 
*31.13.83.16 
*31.13.84.1 
*31.13.84.8 
*31.13.84.16 
*31.13.85.1 
*31.13.85.8 
*31.13.85.16 
*31.13.86.1 
*31.13.86.8 
*31.13.86.16 
*31.13.97.245 
*31.13.97.248 
*46.82.174.68 
*59.24.3.173 
*64.13.192.74 
*64.13.192.76 
*64.13.232.149 
*66.220.146.94 
*66.220.147.11 
*66.220.147.44 
*66.220.147.47 
*66.220.149.18 
*66.220.149.32 
*66.220.149.99 
*66.220.151.20 
*66.220.152.17 
*66.220.152.28 
*66.220.155.12 
*66.220.155.14 
*66.220.158.32 
*67.15.100.252 
*67.15.129.210 
*67.228.37.26 
*67.228.74.123 
*67.228.102.32 
*67.228.126.62 
*67.228.221.221 
*67.228.235.91 
*67.228.235.93 
*69.63.176.15 
*69.63.176.59 
*69.63.176.143 
*69.63.178.13 
*69.63.180.173 
*69.63.181.11 
*69.63.181.12 
*69.63.184.14 
*69.63.184.30 
*69.63.184.142 
*69.63.186.30 
*69.63.186.31 
*69.63.187.12 
*69.63.189.16 
*69.63.190.26 
*69.171.224.12 
*69.171.224.40 
*69.171.224.85 
*69.171.225.13 
*69.171.227.37 
*69.171.228.20 
*69.171.228.74 
*69.171.229.11 
*69.171.229.28 
*69.171.229.73 
*69.171.230.18 
*69.171.232.21 
*69.171.233.24 
*69.171.233.33 
*69.171.233.37 
*69.171.234.18 
*69.171.234.29 
*69.171.234.48 
*69.171.235.16 
*69.171.235.64 
*69.171.235.101 
*69.171.237.16 
*69.171.237.26 
*69.171.239.11 
*69.171.240.27 
*69.171.242.11 
*69.171.242.30 
*69.171.244.11 
*69.171.244.12 
*69.171.244.15 
*69.171.245.49 
*69.171.245.53 
*69.171.245.84 
*69.171.246.9 
*69.171.247.20 
*69.171.247.32 
*69.171.247.71 
*69.171.248.65 
*69.171.248.112 
*69.171.248.128 
*74.86.3.208 
*74.86.12.172 
*74.86.12.173 
*74.86.17.48 
*74.86.118.24 
*74.86.142.55 
*74.86.151.162 
*74.86.151.167 
*74.86.226.234 
*74.86.228.110 
*74.86.235.236 
*75.126.2.43 
*75.126.33.156 
*75.126.115.192 
*75.126.124.162 
*75.126.135.131 
*75.126.150.210 
*75.126.164.178 
*75.126.215.88 
*78.16.49.15 
*88.191.249.182 
*88.191.249.183 
*88.191.253.157 
*93.46.8.89 
*173.252.73.48 
*173.252.100.21 
*173.252.100.32 
*173.252.102.16 
*173.252.102.241 
*173.252.103.64 
*173.252.110.21 
*174.36.196.242 
*174.36.228.136 
*174.37.54.20 
*174.37.154.236 
*174.37.175.229 
*199.16.156.7 
*199.16.156.40 
*199.16.158.190 
*199.59.148.14 
*199.59.148.97 
*199.59.148.140 
*199.59.148.209 
*199.59.149.136 
*199.59.149.244 
*199.59.150.11 
*199.59.150.49 
*205.186.152.122 
*208.43.170.231 
*208.43.237.140 
*208.101.21.43 
*208.101.48.171 
*208.101.60.87 
*243.185.187.39
</div>

==== IPv6环境 ====
<div style="{{column-count|3}}">
* 1.2.3.4
* 10.10.10.10
* 20.20.20.20
* 255.255.255.255
* ::90xx:xxxx:0:0
* 10::2222
* 21:2::2
* 101::1234
* 2001::212
* 2001:DA8:112::21AE
* 2003:FF:1:2:3:4:5FFF:xxxx
* 2123::3E12
* 200:2:253d:369e::
* 200:2:4e10:310f::
* 200:2:2e52:ae44::
* 200:2:807:c62d::
* 200:2:cb62:741::
* 200:2:f3b9:bb27::
* 200:2:5d2e:859::
* 200:2:9f6a:794b::
* 200:2:3b18:3ad::
* 50a7:26ed::64:ceef:0:0
</div>

==== 污染攻击大事记 ====
* {{來源請求|2010年3月，当美国和智利的用户试图访问热门社交网站如facebook.com和youtube.com还有twitter.com等域名，他们的域名查询请求转交给中国控制的[[根域名服务器|DNS根镜像服务器]]处理，由于这些网站在中国被封锁，结果用户收到了错误的DNS解析信息，这意味着防火长城的DNS域名污染域名劫持已影响国际互联网。}}

* {{來源請求|2010年4月8日，中国大陆一个小型ISP的错误路由数据，经过中国电信的二次传播，扩散到了整个国际互联网，波及到了[[AT&T|AT&T]]、[[Level3|Level3]]、[[Deutsche_Telekom|Deutsche Telekom]]、[[Qwest_Communications|Qwest Communications]]和[[Telefónica|Telefónica]]等多个国家的大型ISP。}}

* {{來源請求|2012年11月9日下午3点半开始，[[防火长城|防火长城]]对[[Google|Google]]的泛域名 '''.google.com''' 进行了-{zh-hans:大面积; zh-tw:大規模}-的污染，所有以 '''.google.com''' 结尾的域名均遭到污染而解析错误不能正常访问，其中甚至包括不存在的域名，而Google为各国定制的域名也遭到不同程度的污染（因为Google通过使用[[CNAME|CNAME]]记录来平衡访问的流量，CNAME记录大多亦为 '''.google.com''' 结尾），但Google拥有的其它域名如 .googleusercontent.com 等则不受影响。有网友推测这也许是自防火长城创建以来最大规模的污染事件，而Google被-{zh-hans:大面积; zh-tw:大規模}-阻碍连接则是因为[[中国共产党|中共]]正在召开的[[中国共产党第十八次全国代表大会|十八大]]。}}

* 2014年1月21日下午三点半，中国互联网顶级域名解析不正常，出錯網站解析到的網址是65.49.2.178，這個IP位於美国加利福尼亚州费利蒙市Hurricane Electric公司，被Dynamic Internet Technology（即[[自由门|自由门]]的开发公司）租用于翻墙软件连接节点<ref>[http://www.cna.com.tw/news/acn/201401210456-1.aspx 大陸網路遭駭百度也停擺]，中央社</ref>。
* 2015年1月2日起，污染方式升级，不再是解析到固定的无效IP，而是随机地指向境外的有效IP。刚开始只是对YouTube影片域名（*.googlevideo.com）进行处理，之后逐渐扩大到大多数被污染的域名。<ref>{{cite web|url=http://www.solidot.org/story?sid=42606 |title=防火长城使用有效IP投毒DNS，其中包括色情网站IP |date=2015-01-09 }}</ref>这导致了境外服务器遭受来自中国的DDoS攻击，部分网站因此屏蔽中国IP。<ref>{{cite web|url=http://www.solidot.org/story?sid=42803 |title=遭DNS投毒DDoS攻击的服务器屏蔽中国IP |date=2015-01-23 }}</ref>
* 2016年3月29日起，[[防火长城|防火长城]]针对[[Google|Google]]升级了污染方式。在一开始升级过后，所有包含google, gmail等关键词的域名查询均被污染，导致很多用户一时间完全无法正常使用[[Gmail|Gmail]]服务。之后，[[防火长城|防火长城]]对规则进行了调整。其中，对于*.google.com域名污染主域名（google.com，不包括www）及部分服务域名（drive.google.com, plus.google.com等），而针对地区域名则选择性地污染泛域名（*.google.com.hk, *.google.co.kr, *.google.ru等），其他地区的域名则不受影响（*.google.us等）。<ref>{{Cite web|url=https://www.v2ex.com/t/267233|title=针对 Google 的 dns 污染又开始了|accessdate=2016年3月30日|author=|date=|publisher=}}{{dead link|date=2017年12月 |bot=InternetArchiveBot |fix-attempted=yes }}</ref>
* 目前大部分网站污染方式已恢复为解析到固定的无效IP，但小部分网站和新疆地区访问google.com时仍会污染至有效IP（203.208.*.*IP段）

=== ISP域名劫持 ===
[[File:ChinaTelecom114.jpg|thumb]]在當用戶輸入錯誤或無法解釋的網址時就會顯示旗下互聯星空114網站。此乃2007年劫持[[Bloglines|Bloglines]]時的畫面。]]
中国大陆的互联网服务提供商经常劫持部分域名，转到自己指定的网站，以提供自己的广告，污染方式为劫持域名不存在时返回的NXDOMAIN记录（Non-existent domain）返回自己服务器的ip，从而跳转至自己的服务器上显示广告等内容。

== 參見 ==
* [[名称服务器|名称服务器]]
* [[根域名伺服器|根域名伺服器]]
* [[DNSSEC|DNSSEC]]
* [[金盾工程|金盾工程]]
* [[防火長城|防火長城]]

== 参考文献 ==
{{Reflist|35em}}

== 外部連結 ==
* [https://web.archive.org/web/20080511204328/http://www.trusteer.com/docs/bind9dns.html BIND 9 DNS Cache Poisoning - Discovered by Amit Klein (Trusteer)]
* [https://web.archive.org/web/20080326233700/http://www.scanit.be/advisory-2007-11-14.html Predictable transaction IDs in Microsoft DNS server allow cache poisoning]
* [http://isc.sans.org/diary.php?date=2005-04-07 SANS DNS cache poisoning update]
* [http://www.dnssec.net/dns-threats.php DNS Threats & Weaknesses: research and presentations]
* [http://www.hackernotcracker.com/2007-01/blocking-unwanted-domain-names-creative-usage-of-the-hosts-file.html Blocking Unwanted Domain Names] Creative Usage of the Hosts File
* [http://member.dnsstuff.com/includes/ToolHandler.php?ToolFormName=vu800113 Dnsstuff.com's DNS Vulnerability Check]{{dead link|date=2017年12月 |bot=InternetArchiveBot |fix-attempted=yes }} Test to see if you are Vulnerable
* [http://www.security-database.com/toolswatch/PorkBind-1-2-Yet-another-Cache-DNS.html Security-Database Tools Watch] PorkBind Scanner for 13 DNS Flaws including the DNS Poisoning
* [http://www.checkpoint.com/defense/advisories/public/dnsvideo/index.html Movie explaining DNS Cache Poisioning]

{{-}}
{{Hacking}}
{{翻牆技術}}

[[Category:网络安全|Category:网络安全]]
[[Category:域名|緩存污染]]
[[Category:保全漏洞|Category:保全漏洞]]