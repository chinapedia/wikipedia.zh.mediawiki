{{cleanup-jargon|time=2016-07-12T04:39:09+00:00}}
{{NoteTA
|G1 = IT
|G2 = Math
}}
[[File:Limiteperiodicite.svg|thumb]]
'''周期性边界条件'''('''PBCs''')是[[分子模拟|分子模拟]]与[[数学模型|数学模型]]中的常用近似方法之一，其思想是用一个称为元胞的周期性盒子来描述宏观的体系。在一个元胞周围有紧密堆积的完全相同的元胞。例如在二维体系中，一个方形元胞四周有相同的元胞(称为"镜像")，若一个粒子从右边边界穿出，操作上左边边界对应位置有相同粒子进入，由此保证了元胞中粒子数目即物理量如动量与能量的守恒。

尽管计算机的计算能力发展迅速，但用其模拟[[阿佛加德罗常数|阿佛加德罗常数]]数量级的粒子仍然是不现实的。当今计算机能模拟数百万乃至千万个粒子的体系，要用这有限个粒子反映宏观相的热力学性质，只能借助于周期性边界来实现，使用有限个粒子的体系近似地描述宏观体系。[[分子动力学|分子动力学]]模拟中，常使用PBC描述气体、液体、溶液及晶态的行为。

==实现==
PBC算法主要体现在两部分。其一：对体系内粒子坐标的约束。x_size是一个方向上的元胞边长，则粒子坐标区间为[-0.5*x_size, 0.5x_size)，代码如下： 

<syntaxhighlight lang="fortran">
if (periodic_x) then
  if (x <  -x_size * 0.5) x = x + x_size
  if (x >=  x_size * 0.5) x = x - x_size
end if
</syntaxhighlight>
其二，粒子间距离计算使用最小镜像法则，代码如下：
<syntaxhighlight lang="fortran">
if (periodic_x) then
  dx = x(j) - x(i)
  if (dx >   x_size * 0.5) dx = dx - x_size
  if (dx <= -x_size * 0.5) dx = dx + x_size
end if
</syntaxhighlight>
利用取整运算可写出更为紧凑的代码实现：
<syntaxhighlight lang="fortran">
! 此时坐标x(i)已更新，但尚未使用PBC
x(i) = x(i) - nint(x(i) / x_size) * x_size  ! 坐标x(i)的PBC校验
! 粒子i与j间的最小镜像距离
dx = x(j) - x(i)
dx = dx - nint(dx / x_size) * x_size
</syntaxhighlight>
这样两粒子在一个坐标轴方向上的距离总是小于等于半个盒子边长。

==元胞的几何==
上述PBC算法的元胞是{{en-link|整数晶格|Integer lattice}}。一般地，PBC选择的元胞需要能填充整个空间，因此球形或椭圆形的晶格是不能用作周期性边界的元胞的。三维下，正方体或长方体是最直观的选择。考虑到立方体边角可能浪费空间，或者说简单立方堆积并不是密堆积，使用[[截角八面体|截角八面体]]元胞可以在更少体积的元胞内包含相同数量的粒子。

===高维情况===
通常，二维和三维的分子模拟，因为实现简单，简单正方/立方元胞是最常用的周期性边界条件。然而，高维的模拟中，[[超方形|超方形]]边角占总体的体积随维度增加而显著增大，因此简单立方元胞的效率越来越低。从另一个角度看，元胞可被视作某种晶格堆积的[[维格纳－赛兹原胞|维格纳－赛兹原胞]]<ref name="kundu2020glass">{{cite journal |last1=Berthier |first1=Ludovic |last2=Charbonneau |first2=Patrick |last3=Kundu |first3=Joyjit |title=Finite Dimensional Vestige of Spinodal Criticality above the Dynamical Glass Transition |journal=Physical Review Letters |date=31 August 2020 |volume=125 |issue=10 |pages=108001 |doi=10.1103/PhysRevLett.125.108001}}</ref>。例如，超方形晶格的周期性边界条件对应着高维下的简单立方堆积。使用{{en-link|球的密堆积|Close-packing of equal spheres|最密堆积}}构建高维下的周期性边界条件元胞可获得理论最优效率。例如，四维的最密堆积是[[正十六胞体堆砌|正十六胞体堆砌]]，八维下则是{{en-link|E8晶格|E8 lattice}}。高维周期性边界条件的实现等价于[[信息论|信息论]]中基于高维密堆积的[[纠错码|纠错码]]算法<ref name="conway1982quantization">{{cite journal |last1=Conway |first1=J. |last2=Sloane |first2=N. |title=Fast quantizing and decoding and algorithms for lattice quantizers and codes |journal=IEEE Transactions on Information Theory |date=March 1982 |volume=28 |issue=2 |pages=227–232 |doi=10.1109/TIT.1982.1056484}}</ref>。

==性质==
PBC的引入不影响体系的动量守恒与能量守恒，但是[[角动量|角动量]]不再守恒。

PBC作为一种人为的近似，不可避免地对模拟引入偏差，影响计算结果的有效范围。即使对于最简单的[[兰纳-琼斯势|兰纳-琼斯流体]]，PBC的引入对[[微正则系综|NVE]][[系综|系综]]下的模拟的取样也有轻微影响，从而对物理量的统计值引入系统误差，<ref name="Erpenbeck">Erpenbeck JJ, Wood WW. (1977). ''Statistical Mechanics, Part B: Time-dependent Processes'', Modern Theoretical Chemistry Vol 6. ed. Berne BJ. Plenum, New York, USA. See pp1-40.</ref>故而引入PBC的NVE系综被建议称作NVEPG系综。<ref name="Shirts">Shirts RB, Burt SR, Johnson AM. (2006). Periodic boundary condition induced breakdown of the equipartition principle and other kinetic effects of finite sample size in classical hard-sphere molecular dynamics simulation. ''J Chem Phys'' 125(16):164102. PMID 17092058</ref>[[径向分布函数|径向分布函数]]g('''''r''''')在'''''r'''''大于半个盒子边长时是不准确的，'''''r'''''等于盒子边长时更是有人为的尖峰。在固体体系中，涉及振动的研究，声音，冲击波或[[声子|声子]]的波长范围受体系大小的限制。对于长程力例如电磁相互作用的计算，需要使用特殊的方法(如Edwald加和，PPPM方法等)。<ref>{{Cite book|author = [荷]Frenkel & Smit 汪文川等译|year=2002|origyear=1996|title=Understanding Molecular Simulation -- From Algorithms to Applications|trans_title=分子模拟-从算法到应用|publisher=[[化学工业出版社|化学工业出版社]]|location=北京|isbn=7-5025-3952-2}}</ref>相行为研究中，连续相的取向由于界面能的影响常常沿着盒子边长，体系受限甚至可能得出错误的结论，因此即使引入PBC，体系的大小也应当足够大以尽可能减小引入近似造成的非物理干扰。

==参考资料==
{{Reflist}}
[[Category:分子建模|Category:分子建模]]