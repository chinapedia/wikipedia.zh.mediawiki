{{Lowercase}}
在[[数学|数学]]领域，'''[[圆周率|π]]的莱布尼茨公式'''说明

:<math>\; \frac{\pi}{4}\!=1 \,-\, \frac{1}{3} \,+\, \frac{1}{5} \,-\, \frac{1}{7} \,+\, \frac{1}{9} \,-\, \cdots \;</math>

右边的展式是一个[[无穷级数|无穷级数]]，被称为'''莱布尼茨级数'''，这个级数[[收敛级数|收敛]]到<math>\frac{\pi}{4}</math>。它通常也被称为'''格雷戈里-莱布尼茨级数'''用以纪念莱布尼茨同时代的天文学家兼数学家[[詹姆斯·格雷戈里|詹姆斯·格雷戈里]]。使用[[求和|求和]]符号可记作：
:<math>\;\frac{\pi}{4}=\sum_{n=0}^\infty \, \frac{(-1)^n}{2n+1} </math>

== 证明 ==
考虑下面的[[幾何數列|幾何數列]]：

:<math>1 \,-\, x^2 \,+\, x^4 \,-\, x^6 \,+\, x^8 \,-\, \cdots \;=\; \frac{1}{1+x^2}, \qquad |x| < 1.\!</math>

对等式两边[[积分|积分]]可得到[[反正切|反正切]]的[[幂级数|幂级数]]：

:<math>x \,-\, \frac{x^3}{3} \,+\, \frac{x^5}{5} \,-\, \frac{x^7}{7} \,+\, \frac{x^9}{9} \,-\, \cdots \;=\; \tan^{-1} x , \qquad |x| < 1.\!</math>

将''x'' = 1 代入，便得莱布尼兹公式(1的反正切是π ⁄ 4)。这种推理产生的一个问题是1不在幂级数的[[收敛半径|收敛半径]]以内。因此，需要额外论证当''x'' = 1时级数收敛到tan<sup>−1</sup>(1)。一种方法是利用[[交替级数判别法|交替级数判别法]]，然后使用[[阿贝尔定理|阿贝尔定理]]证明级数收敛到tan<sup>−1</sup>(1)。然而，也可以用一个完全初等的证明。

=== 初等证明 ===
考虑如下分解

:<math>\frac{1}{1+x^2} \;=\;1 \,-\, x^2 \,+\, x^4 \,-\, \cdots \,+\, (-1)^n x^{2n} \;+\; \frac{(-1)^{n+1}\,x^{2n+2} }{1+x^2}.\!</math>

对于|''x''| < 1，右侧的分式是余下的几何级数的和。然而，上面的方程并没有包含无穷级数，并且对任何实数''x''成立。上式两端从0到1积分可得：

:<math>\frac{\pi}{4} \;=\; 1 \,-\, \frac{1}{3} \,+\, \frac{1}{5} \,-\, \cdots \,+ \frac{(-1)^n}{2n+1} \;+\; (-1)^{n+1}\!\! \int_0^1 \frac{x^{2n+2}}{1+x^2}\,dx.\!</math>

当<math>n \rightarrow \infty\!</math>时，除积分项以外的项收敛到莱布尼茨级数。同时，积分项收敛到0：

:<math>0 \le \int_0^1 \frac{x^{2n+2}}{1+x^2}\,dx \le \int_0^1 x^{2n+2}\,dx \;=\; \frac{1}{2n+3} \;\rightarrow\; 0\!</math> 当 <math>n \rightarrow \infty\!</math>

这便证明了莱布尼茨公式。

=== 格点与数论证明 ===

通过以<math>(0,0)</math>为圆心，<math>R</math>为半径的圆上及圆内[[格点|格点]]（即横坐标与纵坐标皆为整数）个数计算公式来得出，在这里先考虑[[费马平方和定理|费马平方和定理]]：一个奇素数能表示成两个平方数之和[[当且仅当|当且仅当]]该素数[[同余|模4余1]]，并且不考虑符号与交换律下其形式唯一（由于必为一奇一偶，因此不考虑符号但考虑交换律下必然为两种形式），比如<math>29\equiv1\pmod4</math>可以得出<math>29=2^2+5^2=5^2+2^2</math>，而<math>23\equiv3\pmod4</math>因此无法分解成两个平方和形式。

现在对于所有正整数<math>N</math>，有其唯一的[[素因数分解|素因数分解]]形式：

:<math>N=2^k(p_1^{\alpha_1}p_2^{\alpha_2}\cdots p_m^{\alpha_m})(q_1^{\beta_1}q_2^{\beta_2}\cdots q_n^{\beta_n})</math>

其中<math>\{p_1,p_2,\cdots,p_m\}</math>为互不相同的模4余1的素数，<math>\{q_1,q_2,\cdots,q_n\}</math>为互不相同的模4余3素数。

* 如果<math>\{\beta_1,\beta_2\cdots,\beta_n\}</math>只要其中一个为奇数，则正整数<math>N</math>不存在表示成两个平方和的形式（比如<math>75=3\times5^2</math>，3的次数为1，因此不能表示成两平方和）；
* 而当<math>\{\beta_1,\beta_2\cdots,\beta_n\}</math>全为偶数时，此时能表示成平方数形式的数量等于<math>(\alpha_1+1)(\alpha_2+1)\cdots(\alpha_m+1)</math>（不考虑符号但考虑交换律的情况，比如<math>65=5\times13</math>，其中5与13次数均为1，因此有<math>(1+1)(1+1)=4</math>，即<math>65=1^2+8^2=2^2+7^2=7^2+2^2=8^2+1^2</math>）；
* 2的幂次<math>k</math>不影响<math>N</math>表示两平方和形式的个数，比如不管<math>k</math>是多少，<math>2^k\times65</math>能表示成两个平方和形式都是4种。

接下来引入[[狄利克雷特征|狄利克雷特征]]函数，定义<math>\chi(N)=\begin{cases}1&N\equiv1\pmod4\\-1&N\equiv3\pmod4\\0&N\equiv0\pmod2\end{cases}</math>，因此为积性函数，满足<math>\chi(a)\cdot\chi(b)=\chi(ab)</math>。

* 对于模4余1的素数<math>p</math>以及自然数<math>\alpha</math>，总有<math>p^\alpha\equiv1\pmod4</math>，因此<math>\chi(1)+\chi(p)+\chi(p^2)+\cdots+\chi(p^\alpha)=\alpha+1</math>；
* 对于模4余3的素数<math>q</math>以及自然数<math>\beta</math>，则有<math>q^\beta\equiv(-1)^\beta\pmod4</math>，因此<math>\chi(1)+\chi(q)+\chi(q^2)+\cdots+\chi(q^\beta)=\begin{cases}1&\beta\equiv0\pmod2\\0&\beta\equiv1\pmod2\end{cases}</math>；
* 对于2以及自然数<math>k</math>，当<math>k=0</math>时<math>2^0=1</math>，即<math>\chi(1)=1</math>；当<math>k>0</math>时总有<math>\chi(2^k)=0</math>，因此<math>\chi(1)+\chi(2)+\chi(4)+\cdots+\chi(2^k)=1</math>。

由于<math>\chi(a)\cdot\chi(b)=\chi(ab)</math>，而这些结果正好与上述性质相吻合，因此<math>N</math>表示成两个平方和形式的数量可以由其所有[[因数|因数]]<math>t</math>相应的<math>\chi(t)</math>之和<math>\sum_{t|N}\chi(t)</math>来表示，比如<math>30=2\times3\times5</math>，于是相应地有<math>\chi(1)+\chi(2)+\chi(3)+\chi(5)+\chi(6)+\chi(10)+\chi(15)+\chi(30)=0</math>。

小于等于<math>R^2</math>能被正整数<math>n</math>整除的正整数有<math>\left\lfloor\frac{R^2}n\right\rfloor</math>个，因此对于半径为<math>R</math>圆上及圆内格点数总和为：
:<math>1+4\left[\left\lfloor\frac{R^2}1\right\rfloor\chi(1)+\left\lfloor\frac{R^2}2\right\rfloor\chi(2)+\cdots+\left\lfloor\frac{R^2}R\right\rfloor\chi(R)\right]=1+4\left(\left\lfloor\frac{R^2}1\right\rfloor-\left\lfloor\frac{R^2}3\right\rfloor+\cdots+\left\lfloor\frac{R^2}{R'}\right\rfloor^\frac{R'-1}2\right)</math>

其中<math>R'</math>为不超过<math>R</math>的最大奇数，再由圆面积为<math>\pi R^2</math>，当<math>R\to\infty</math>时，两者比值极限得<math>1-\frac13+\frac15-\frac17+\cdots=\frac\pi4</math>。<ref>{{cite web |url=https://www.bilibili.com/video/av12131743 |title=【官方双语】隐藏在素数规律中的π_哔哩哔哩_bilibili |access-date=2022-04-06 |archive-date=2022-04-06 |archive-url=https://web.archive.org/web/20220406143549/https://www.bilibili.com/video/av12131743 }}</ref>

==参考文献==
* Jonathan Borwein, David Bailey & Roland Girgensohn, ''Experimentation in Mathematics - Computational Paths to Discovery'', A K Peters 2003, ISBN 1-56881-136-5, pages 28–30.
{{reflist}}

==外部链接==
* [http://timjoh.com/calculating-pi-in-ti-basic-using-the-leibniz-formula/ Implementation of the Leibniz formula for TI Basic] {{Wayback|url=http://timjoh.com/calculating-pi-in-ti-basic-using-the-leibniz-formula/ |date=20210810115248 }}
* [https://web.archive.org/web/20080211115011/http://sethborders.googlepages.com/Calculatepi.html use the Leibniz formula to approximate pi]
* [http://mattst88.com/programming/?page=leibniz Leibniz Formula in C, x86 FPU Assembly, x86-64 SSE3 Assembly, and DEC Alpha Assembly] {{Wayback|url=http://mattst88.com/programming/?page=leibniz |date=20210413023016 }}

[[Category:级数|Category:级数]]
[[Category:圆周率算法|Category:圆周率算法]]
[[Category:包含证明的条目|Category:包含证明的条目]]
[[Category:数学公式|Category:数学公式]]
[[Category:戈特弗里德·萊布尼茨|Category:戈特弗里德·萊布尼茨]]