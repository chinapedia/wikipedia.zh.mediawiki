{{NoteTA
|G1=數學
|T=zh-hant:球座標系;zh-hans:球坐标系;
}}
[[File:3D_Spherical.svg|thumb]]）与方位角{{mvar|φ}}（[[phi|phi]]）。]]
[[File:3D_Spherical_2.svg|thumb]]）与极角{{mvar|φ}}（[[phi|phi]]）。]]
'''球座標系'''（{{lang-en|spherical coordinate system}}）是[[數學|數學]]上利用'''球座標'''<math>(r,\ \theta,\ \varphi)</math>表示一個點P在三維空間的位置的三維[[正交座標系|正交]][[座標系|座標系]]。右圖顯示了球座標的幾何意義：原點與點P之間的“徑向距離”（{{lang|en|''radial distance''}}）<math>r</math>，原點到點P的連線與正z-軸之間的“极角”（{{lang|en|''polar angle''}}）<math>\theta</math>，以及原點到點P的連線在xy-平面的[[投影|投影線]]，與正x-軸之間的“[[方位角|方位角]]”（{{lang|en|''azimuth angle''}}）<math>\varphi</math>。它可以被视为[[极坐标系|极坐标系]]的三维推廣。球座標的概念，延伸至高維空間，則稱為[[N维球面#超球坐标系|超球座標]]。

==符号约定==
在學術界內，關於球座標系的標記有好幾個不同的約定。按照[[國際標準化組織|國際標準化組織]]建立的約定（ISO 31-11），球坐標標記為<math>(r,\ \theta,\ \varphi)</math>，其中<math>r</math>代表徑向距離，<math>\theta</math>代表極角，<math>\varphi</math>代表[[方位角|方位角]]，極角也稱為倾斜（inclination）角、[[法线|法线]]角或[[天頂|天頂]]（zenith）角。這種標記通常為物理界的學者所採用，在世界各地有許多使用者，本條目採用的是物理學界標記約定。[[方位角|方位角]]（azimuth）、高度（[[海拔|altitude]]或[[相对高度|elevation]]）角和[[天頂|天頂]]的概念出自關於[[天球|天球]]的[[地平坐標系|地平坐標系]]。在[[極坐標系|極坐標系]]中，角度坐標<math>\theta</math>常被稱為極角<ref>[http://mathworld.wolfram.com/PolarCoordinates.html the angular coordinate, often called the polar angle] {{Wayback|url=http://mathworld.wolfram.com/PolarCoordinates.html |date=20061028062604 }}.</ref>。

在數學界，球座標標記也是<math>(r,\ \theta,\ \varphi)</math>，但倾斜角與方位角的標記正好相反：<math>\theta</math>代表方位角，<math>\varphi</math>代表倾斜角。數學界的標記被認為“提供了對常用的[[極坐標系|極坐標系]]記號的邏輯擴展，<math>\theta</math>仍是在xy-平面上的角度而<math>\varphi</math>是在這個平面之外的角度”<ref name="http://mathworld.wolfram.com/SphericalCoordinates.html">{{cite web
| url = http://mathworld.wolfram.com/SphericalCoordinates.html
| title = Spherical Coordinates
| author = [[Eric_W._Weisstein|Eric W. Weisstein]]
| publisher = [[MathWorld|MathWorld]]
| date = 2005-10-26
| accessdate = 2010-01-15
| archive-date = 2018-06-23
| archive-url = https://web.archive.org/web/20180623061900/http://mathworld.wolfram.com/SphericalCoordinates.html
| dead-url = no
}}</ref>；一些作者将倾斜角列在方位角之前而写为<math>(r,\ \varphi,\ \theta)</math>，还有作者对径向距离使用<math>\rho</math>而写为<math>(\rho,\ \varphi,\ \theta)</math>或<math>(\rho,\ \theta,\ \varphi)</math><ref name="http://mathworld.wolfram.com/SphericalCoordinates.html {{Wayback|url=http://mathworld.wolfram.com/SphericalCoordinates.html |date=20180623061900 }}" />。

== 定義 ==
[[File:Spherical_coordinate_surfaces.png|thumb]]。紅色圓球面的<math>r=2</math>。藍色圓錐面的<math>\theta=45^{\circ}</math>。黃色半平面的<math>\varphi= - 60^{\circ}</math>（黃色半平面與xz-半平面之間的[[二面角|二面角]]角度是<math>\left|\varphi\right|</math>）。z-軸是垂直的，以白色表示。x-軸以綠色表示。三個座標曲面相交於點P（以黑色的圓球表示）。[[直角座標|直角座標]]大約為<math>(0.707, -1.225, 1.414)</math>。]]

假設P點在三維空間的位置的三個座標是<math>(r,\ \theta,\ \varphi)</math>。那麼，0 ≤ ''r''是從原點到P點的距離，0 ≤ ''θ'' ≤ π是從原點到P點的連線與正z-軸的夾角，0 ≤ ''φ'' < 2π是從原點到P點的連線在xy-平面的投影線，與正x-軸的夾角。

這裏，<math>\theta</math>代表倾斜角，<math>\varphi</math>代表方位角。當 <math>r=0</math>時，<math>\theta</math>與<math>\varphi</math>都一起失去意義。當<math>\theta = 0</math>或<math>\theta = \pi</math>時，<math>\varphi</math>失去意義。

如想要用球座標，找出點P在空間的地點，可按照以下步驟：
# 從原點往正z-軸移動<math>r</math>單位，
# 用[[右手定則|右手定則]]，大拇指往y-軸指，x-軸與z-軸朝其他手指的指向旋轉<math>\theta</math>角值，
# 用右手定則，大拇指往z-軸指，x-軸與y-軸朝其他手指的指向旋轉<math>\varphi</math>角值。

== 座標系變換 ==
三維空間裏，有各種各樣的座標系。球座標系只是其中一種。球座標系與其他座標系的變換需要用到特別的方程式。

=== 直角座標系 ===
{{main|直角座標系}}
使用以下等式，可從直角座標變換為球座標：
:<math>{r}=\sqrt{x^2 + y^2 + z^2}</math>，
:<math>{\theta}=\arccos \left( {\frac{z}{r}} \right)=\arcsin \left( {\frac{\sqrt{x^2 + y^2}}{r}} \right)=\arctan \left( \frac{\sqrt{x^2 + y^2}}{z} \right)</math>，
:<math>{\varphi}=\arccos \left( {\frac{x}{r \sin\theta}} \right)=\arcsin \left( {\frac{y}{r \sin\theta}} \right)=\arctan \left( {\frac{y}{x}} \right)</math>。
:計算 <math>{\varphi}</math> 時：
:1. 必須依照 <math>(x,\ y)</math> 所處的[[象限|象限]]來計算正確的[[反正切|反正切]]值。
:2. 當 <math>{x}=0</math> 時，判斷 <math>{y}</math> 的值：
::若 <math>{y}>0</math>，則 <math>{\varphi}={\frac{\pi}{2}}</math>，
::若 <math>{y}<0</math>，則 <math>{\varphi}={-\frac{\pi}{2}}</math> 或 <math>{\frac{3\pi}{2}}</math>，
::若 <math>{y}=0</math>，則 <math>{\varphi}</math> 為未定值 ( 因為 <math>{\frac {0}{0}}</math> 為[[未定式|未定式]] )。
反過來，也可從球座標變換為直角座標：
:<math>x=r \sin\theta \cos\varphi</math>，
:<math>y=r \sin\theta \sin\varphi</math>，
:<math>z=r \cos\theta</math>。

=== 圓柱座標系 ===
[[File:Cylindrical_with_grid.svg|thumb]]
{{further|圓柱座標系}}
圓柱座標系是[[極座標系|極座標系]]在三維空間往z-軸的延伸。<math>z</math>座標用來表示高度。使用以下方程式，可以從球座標變換為圓柱座標<math>(\rho,\ \varphi,\ z)</math>：
:<math>r=\sqrt{\rho^2+z^2}</math>、
:<math>\theta=\arctan\frac{\rho}{z}</math>、
:<math>\varphi=\varphi</math>。

反過來，可以從圓柱座標變換為球座標：
:<math>\rho=r\sin\theta</math>、
:<math>\varphi=\varphi</math>、
:<math>z=r\cos\theta</math>。

== 球坐标系下的微积分公式 ==
假定<math>\theta</math>是從原點到P點的連線與正z-軸的夾角，球座標系的標度因子分別為：
:<math>h_{r} =1</math>、
:<math>h_{\theta} =r</math>、
:<math>h_{\varphi} =r\sin\theta</math>。
[[File:Nabla_spherical2.svg|thumb]]
微分公式：
*线元素是一个从<math>(r,\theta,\varphi)</math>到<math>(r+\mathrm{d}r, \,\theta+\mathrm{d}\theta, \, \varphi+\mathrm{d}\varphi)</math>的无穷小位移，表示为公式：
:<math>\mathrm{d}\mathbf{r} = \mathrm{d}r\,\boldsymbol{\hat r} + r\,\mathrm{d}\theta \,\boldsymbol{\hat\theta } + r \sin{\theta} \mathrm{d}\varphi\,\mathbf{\boldsymbol{\hat \varphi}}</math>；
:其中的<math>\boldsymbol{\hat r},\boldsymbol{\hat\theta },\boldsymbol{\hat \varphi}</math>是在<math>r,\theta,\varphi</math>的各自的增加的方向上的[[单位矢量|单位矢量]]。
*面积元素1：在球面上，固定半径，天顶角从<math>\theta</math>到<math>\theta+\mathrm{d}\theta</math>，方位角从<math>\varphi</math>到<math>\varphi+\mathrm{d}\varphi</math>变化，公式为：
:<math>\mathrm{d}S_r=r^2\sin\theta\,\mathrm{d}\theta\,\mathrm{d}\varphi</math>。
*面积元素2：固定天顶角<math>\theta</math>，其他两个变量变化，則公式为：
:<math>\mathrm{d}S_\theta=r\,\sin\theta\,\mathrm{d}r\,\mathrm{d}\varphi</math>。
*面积元素3：固定方位角<math>\varphi</math>，其他两个变量变化，則公式为：
:<math>\mathrm{d}S_\varphi=r\,\mathrm{d}r\,\mathrm{d}\theta</math>。
*体积元素，徑向座標从<math>r</math>到<math>r+\mathrm{d}r</math>，天顶角从<math>\theta</math>到<math>\theta+\mathrm{d}\theta</math>，并且方位角从<math>\varphi</math>到<math>\varphi+\mathrm{d}\varphi</math>的公式为：
:<math>\mathrm{d}V=r^2\sin\theta\,\mathrm{d}r\,\mathrm{d}\theta\,\mathrm{d}\varphi</math>。

微分算子，如<math>\nabla f</math>、<math>\nabla \cdot \mathbf{F}</math>、<math>\nabla \times \mathbf{F}</math>、<math>\nabla^2 f</math>，都可以用<math>(r,\ \theta,\ \varphi)</math>座標表示，只要將標度因子代入在[[正交座標系|正交座標系]]條目內對應的一般公式，即可得到如下公式：
*[[梯度|梯度]]公式：
:<math>\nabla f={\partial f \over \partial r}\boldsymbol{\hat r} 
  + {1 \over r}{\partial f \over \partial \theta}\boldsymbol{\hat \theta} 
  + {1 \over r\sin\theta}{\partial f \over \partial \varphi}\boldsymbol{\hat \varphi}</math>。
*[[散度|散度]]公式：
:<math>\nabla\cdot \mathbf{A} = \frac{1}{r^2}{\partial \over \partial r}\left( r^2 A_r \right) + \frac{1}{r \sin\theta}{\partial \over \partial\theta} \left( \sin\theta A_\theta \right) + \frac{1}{r \sin \theta} {\partial A_\varphi \over \partial \varphi}</math>。
*[[旋度|旋度]]公式：
:<math>\nabla \times \mathbf{A} = \displaystyle{1 \over r\sin\theta}\left({\partial \over \partial \theta} \left( A_\varphi\sin\theta \right)
    - {\partial A_\theta \over \partial \varphi}\right) \boldsymbol{\hat r} + 
  \displaystyle{1 \over r}\left({1 \over \sin\theta}{\partial A_r \over \partial \varphi} 
    - {\partial \over \partial r} \left( r A_\varphi \right) \right) \boldsymbol{\hat \theta} +
  \displaystyle{1 \over r}\left({\partial \over \partial r} \left( r A_\theta \right)
    - {\partial A_r \over \partial \theta}\right) \boldsymbol{\hat \varphi}</math>。
* [[拉普拉斯算子|拉普拉斯算子]]是
:<math>\nabla^2 f={1 \over r^2}{\partial \over \partial r}\!\left(r^2 {\partial f \over \partial r}\right) 
  \!+\!{1 \over r^2\!\sin\theta}{\partial \over \partial \theta}\!\left(\sin\theta {\partial f \over \partial \theta}\right) 
  \!+\!{1 \over r^2\!\sin^2\theta}{\partial^2 f \over \partial \varphi^2}</math>。

== 地理座標系 ==
{{further|地理坐標系}}
[[File:Latitude_and_longitude_graticule_on_a_sphere.svg|thumb]]
[[地理座標系|地理座標系]]是自古以來主要用於[[地理學|地理學]]的另一種版本的球座標系。地理座標標记为<math>(\lambda,\ \psi,\ h)</math>，其中<math>\lambda</math>表示[[方位角|方位角]]並稱為[[經度|經度]]，<math>\psi</math>表示高度角並稱為[[纬度#大地纬度和地心纬度|地心纬度]]，<math>h</math>表示[[相對高度|相對高度]]。在地理學裏，通常不直接使用表示到地心距離的絕對高度，日常中所用地圖中可能不標示任何高度。

[[緯度|緯度]]<math>\psi</math>的定義域是<math> -90^\circ \le \psi \le 90^\circ</math>，以[[赤道|赤道]]為緯度<math>0^\circ</math>，正值往北負值往南。使用以下公式，可從關於[[天極|天極]]的[[天頂|天頂]]角<math>\theta</math>變換為地心緯度<math>\psi</math>：
:<math>\psi=90^\circ - \theta</math>，正值可稱北緯，負值去負號可稱南緯。

[[經度|經度]]<math>\lambda</math>的定義域是<math> - 180^\circ \le \lambda \le 180^\circ</math>。設定經過[[倫敦|倫敦]][[格林維治天文台|格林維治天文台]]的[[子午線|子午線]]為經度<math>0^\circ</math>，正值往東或負值往西。使用以下公式，可從在[[赤道|赤道]][[參考平面|參考平面]]上的[[方位角|方位角]]<math>\varphi</math>變換為經度<math>\lambda</math>：
:<math>\varphi\le 180^\circ</math>：<math>\lambda=\varphi</math>，正值可稱東經，
:<math>\varphi\ge 180^\circ</math>：<math>\lambda=\varphi - 360^\circ </math>，負值去負號可稱西經。
東經和西經都有[[180度经线|180°經線]]，二者等同並有關於[[國際日期變更線|國際日期變更線]]。

采用[[类球面|扁椭球]]时，一般采用椭球面一点的[[法线|法线]]与[[赤道|赤道]][[参考平面|参考平面]]交角为高度角并称为大地纬度，而地心纬度<math>\psi</math>和大地纬度<math>\varphi</math>的关系为：
:<math>\tan(\psi)=\frac{b^2}{a^2}\tan(\varphi)</math>，
径向距离即到地心距离<math>r</math>是关于地心纬度<math>\psi</math>的函数：
:<math>r(\psi)=\frac{b}{\sqrt{1 - (e\cos\psi)^2}}</math>，
其中<math>a</math>为[[参考椭球体|参考椭球体]]的[[半长轴|半长轴]]，<math>b</math>为[[半短轴|半短轴]]，<math>e</math>为[[偏心率|偏心率]]。采用[[球面|球面]]时径向距离<math>r</math>是固定值，地心纬度<math>\psi</math>和大地纬度<math>\varphi</math>一致。

== 應用 ==
正如二維直角座標系專精在平面上，二維球座標系可以很簡易的設定圓球表面上的點的位置。在這裏，我們認定這圓球是個單位圓球；其半徑是1。通常我們可以忽略這圓球的半徑。在解析[[旋轉矩陣|旋轉矩陣]]問題上，這方法是非常有用的。

球座標系適用於分析一個對稱於點的系統。舉例而言，一個圓球，其直角座標方程式為<math>x^2+y^2+z^2=c^2</math>，可以簡易的用球座標系<math>\rho =c</math>來表示。

用來描述與分析擁有球狀對稱性質的物理問題，最自然的座標系，莫非是球座標系。例如，一個具有質量或電荷的圓球形[[位勢|位勢]]場。兩種重要的[[偏微分方程式|偏微分方程式]]，[[拉普拉斯方程|拉普拉斯方程]]與[[亥姆霍茲方程|亥姆霍茲方程]]，在球座標裏，都可以成功的使用[[分離變數法|分離變數法]]求得解答。這種方程式在角部分的解答，皆呈[[球諧函數|球諧函數]]的形式。

== 參閱 ==
* [[天球坐标系统|天球坐标系统]]
* [[欧拉角|欧拉角]]
* [[雅可比矩阵|雅可比矩阵]]
*[[在圆柱和球坐标系中的del|在圆柱和球坐标系中的del]]
==引用==
{{reflist}}

{{正交座標系}}

[[Category:坐标系|Q]]