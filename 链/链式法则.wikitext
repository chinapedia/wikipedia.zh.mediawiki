{{NoteTA
|G1 = Math
|T=zh-tw:連鎖律;zh-cn:链式法則;
}}
{{微积分学}}
'''連鎖律'''，亦稱'''連鎖法則'''（{{lang-en|Chain rule}}），用于求[[复合函数|合成函数]]的[[导数|導數]]。

== 正式表述 ==
兩函數 <math>f</math> 和 <math>g</math> 的[[定义域|定義域]] (<math>D_f</math> 和 <math>D_g</math>) 、[[值域|值域]] (<math>I_f</math> 和 <math>I_g</math>) 都包含於[[实数|實數系]] <math>\mathbb{R}</math> ，若可以定義合成函數 <math>g \circ f</math> (也就是 <math>I_f \cap D_g \neq \varnothing </math> )，且 <math>f</math> 於 <math>a\in D_f</math> 可微分，且 <math>g</math> 於 <math>f(a)\in I_f \cap D_g </math> 可微分，則
:<math>{(g \circ f)}^{\prime}(a) = g^{\prime}[f(a)] \cdot f^{\prime}(a)</math>
也可以寫成
:<math>\frac{dg[f(x)]}{dx}\bigg|_{x=a} = \frac{dg(y)}{dy}\bigg|_{y=f(a)} \cdot \frac{df}{dx}\bigg|_{x=a} </math>

== 例子 ==

求函数 <math>f(x) = (x^2 + 1)^3</math>的导数。

:设 <math>g(x) = x^2 + 1</math>
:<math>h(g) = g^3 \to h(g(x)) = g(x)^3.</math>
:<math>f(x) = h(g(x)) </math>
:<math>f'(x)=h'(g(x))g'(x)=3(g(x))^2(2x)=3(x^2+1)^2(2x)=6x(x^2+1)^2. </math>

求函数 <math>\arctan\,\sin\, x</math>的导数。

:<math>\frac{d}{dx}\arctan\,x\,=\,\frac{1}{1+x^2}</math>
:<math>\frac{d}{dx}\arctan\,f(x)\,=\,\frac{f'(x)}{1+f^2(x)}</math>
:<math>\frac{d}{dx}\arctan\,\sin\,x\,=\,\frac{\cos\,x}{1+\sin^2\,x}</math>

== 证明 ==
嚴謹的證明需要'''連續函數的極限定理''':

兩函數 <math>f</math> 和 <math>g</math> 的定義域、值域都包含於實數系，若可以定義合成函數 <math>g \circ f</math> 且
:*<math>\lim_{x\to a}f(x)=L</math>
:*<math>\lim_{y\to L}g(y)=g(L)</math>
則有
:<math>\lim_{x\to a}g[f(x)]=g(L)</math>
(證明提示：展開[[函數極限#自變量趨於有限值時函數的極限|極限的δ-ε定義]]，並考慮 <math>f(x)</math> 等於或不等於 <math>L</math> 的兩種狀況。)

讓我們定義一個函數 <math>G</math> ，其定義域 <math>D_G = D_g </math> ， 而對應規則為
:<math>G(y)=\begin{cases}
\displaystyle\frac{g(y)-g[f(a)]}{y-g[f(a)]} & y\neq f(a) \\\\
 g^{\prime}[f(a)] & y=f(a)  
\end{cases}</math>
這樣的話
:<math>\lim_{x\to a}\frac{g(y)-g[f(a)]}{x-a}=\lim_{x\to a}\frac{g(y)-g[f(a)]}{f(x)-f(a)}\frac{f(x)-f(a)}{x-a}=\lim_{x\to a}G[f(x)]\cdot\frac{f(x)-f(a)}{x-a}</math>
因為可微則必連續(根據[[极限_(数学)#性质|乘法的極限性質]])，所以 <math>f</math> 於 <math>a</math> 連續、 <math>G</math> 於 <math>f(a)</math> 連續，故根據上面的極限定理有
:<math>\lim_{x\to a}G[f(x)]=g^{\prime}[f(a)]</math>
再根據[[极限_(数学)#性质|乘法的極限性質]]有
:<math>\lim_{x\to a}\frac{g(y)-g[f(a)]}{x-a}=g^{\prime}[f(a)]\cdot f^{\prime}(a)</math>
即為所求。 <math>\Box</math>

== 多元复合函数求导法则 ==
考虑函数''z'' = ''f''(''x'', ''y'')，其中''x'' = ''g''(''t'')，''y'' = ''h''(''t'')，''g''(''t'')和''h''(''t'')是可微函数，那么：
:<math>{\ dz \over dt}={\partial z \over \partial x}{dx \over dt}+{\partial z \over \partial y}{dy \over dt}.</math> 

假设''z'' = ''f''(''u'', ''v'')的每一个自变量都是二元函数，也就是说，''u'' = ''h''(''x'', ''y'')，''v'' = ''g''(''x'', ''y'')，且这些函数都是可微的。那么，''z''的偏导数为：
:<math>{\partial z \over \partial x}={\partial z \over \partial u}{\partial u \over \partial x}+{\partial z \over \partial v}{\partial v \over \partial x}</math>

:<math>{\partial z \over \partial y}={\partial z \over \partial u}{\partial u \over \partial y}+{\partial z \over \partial v}{\partial v \over \partial y}.</math>

如果我们考虑
:<math>\vec r = (u,v)</math> 
为一个向量函数，我们可以用向量的表示法把以上的公式写成f的[[梯度|梯度]]与<math>\vec r</math>的偏导数的[[数量积|数量积]]：
:<math>\frac{\partial f}{\partial x}=\vec \nabla f \cdot \frac{\partial \vec r}{\partial x}.</math>

更一般地，对于从向量到向量的函数，求导法则为：
:<math>\frac{\partial(z_1,\ldots,z_m)}{\partial(x_1,\ldots,x_p)} = \frac{\partial(z_1,\ldots,z_m)}{\partial(y_1,\ldots,y_n)} \frac{\partial(y_1,\ldots,y_n)}{\partial(x_1,\ldots,x_p)}.</math>

== 高阶导数 ==
复合函数的最初几个高阶导数为：
:<math>\frac{d (f \circ g) }{dx} = \frac{df}{dg}\frac{dg}{dx}</math>
:<math>
  \frac{d^2 (f \circ g) }{d x^2}
  = \frac{d^2 f}{d g^2}\left(\frac{dg}{dx}\right)^2 
    + \frac{df}{dg}\frac{d^2 g}{dx^2}
</math>
:<math>
  \frac{d^3 (f \circ g) }{d x^3} 
  = \frac{d^3 f}{d g^3} \left(\frac{dg}{dx}\right)^3 
    + 3 \frac{d^2 f}{d g^2} \frac{dg}{dx} \frac{d^2 g}{d x^2}
    + \frac{df}{dg} \frac{d^3 g}{d x^3} 
</math>
:<math>
  \frac{d^4 (f \circ g) }{d x^4}
  =\frac{d^4 f}{dg^4} \left(\frac{dg}{dx}\right)^4 
    + 6 \frac{d^3 f}{d g^3} \left(\frac{dg}{dx}\right)^2 \frac{d^2 g}{d x^2} 
    + \frac{d^2 f}{d g^2} \left\{ 4 \frac{dg}{dx} \frac{d^3 g}{dx^3} + 3\left(\frac{d^2 g}{dx^2}\right)^2\right\}
      
    + \frac{df}{dg}\frac{d^4 g}{dx^4}.
</math>

== 参见 ==
* [[乘积法则|乘积法则]]
* [[除法定则|除法定则]]

[[Category:求导法则|Category:求导法则]]
[[Category:微積分定理|Category:微積分定理]]