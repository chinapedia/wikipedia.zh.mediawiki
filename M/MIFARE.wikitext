{{TA
|G1=IT
|G2=電子學
|G3=物理學
}}
[[File:Mifare_logo_rgb.png|thumb]]
'''MIFARE'''是[[恩智浦半導體|恩智浦半導體公司]]（NXP Semiconductors）拥有的一系列[[非接觸式智慧卡|非接觸式智慧卡]]和[[近傍型卡|近傍型卡]]技术的注册商标。

MIFARE包括一系列依循[[ISO/IEC_14443|ISO/IEC 14443]]-A規格，利用[[無線射頻識別|無線射頻識別]]（頻率為13.56[[MHz|MHz]]）的多种非接触式智能卡专有解决方案。這項技術是最早是1994年由{{link-en|米克朗|Mikron}}集團（Mikron Group）開發，在1998年轉售給[[飛利浦|飛利浦電子公司]]（2006年更名為恩智浦半導體公司）。近年來MIFARE已經普遍在日常生活當中使用，如大眾運輸系統付費、商店小額消費、門禁安全系統、借書證等。

== 發展歷史 ==
[[File:Mifare_1k_transparent.jpg|300px]]
* 1994 — MIFARE Classic 1K，非接觸式讀取技術開發成功。
* 1996 — [[韓國|韓國]][[首爾市|首爾市]][[韓國首都圈電鐵|地鐵]]成為首個採用MIFARE的商轉系統。
* 1997 — MIFARE Pro，兼容接觸與非接觸式的智慧卡，並採用了[[三重數據加密演算法|3DES]]的[[協同處理器|協同處理器]]（coprocessor）機制。
* 1999 — MIFARE Pro X，開發完成[[公開金鑰基礎建設|公開金鑰基礎建設]]（PKI）機制。
* 2001 — MIFARE UltraLight規格開發成功。
* 2002 — MIFARE DESFire，開發以[[微處理器|微處理器]]（microprocessor）為基礎的產品。
* 2004 — MIFARE DESFire SAM，增強了MIFARE DESFire的安全基礎架構連接。
* 2006 — MIFARE DESFire EV1，第一個支援128bit [[高級加密標準|進階加密標準]]（AES）的產品。
* 2008 — MIFARE Plus，替換MIFARE Classic使用的128bit AES。
* 2008 — MIFARE Ultralight C，內建有三重數據加密演算法驗證的紙質票證IC（Paperticket IC）。
* 2010 — MIFARE SAM AV2，加入可讀取進階加密標準（AES）、三重數據加密演算法（3DS）、公開金鑰基礎架構（PKI）等安全密鑰的驗證機制。
* 2012 — MIFARE Ultralight EV1，與MIFARE Ultralight相同的規格但是取消了加密功能。
* 2013 — MIFARE DESFire EV2，更好的效能、保密性並且支援多種加密程式。

MIFARE的名字由來是米克朗車資收費系統（ '''MI'''kron '''FARE'''-collection System）組合而來，[[飛利浦|飛利浦電子公司]]在1998年收購了這項技術。 

1994年，米克朗公司授權[[英飛凌|英飛凌]] 科技在MIFARE現有的基礎上開發新的機制。<ref>{{cite web|title=SIEMENS AND MIKRON AGREE LICENSING DEAL|url=http://www.telecompaper.com/news/siemens-and-mikron-agree-licensing-deal--22439|publisher=telecompaper|date=1994-04-07|accessdate=2015-10-26|archive-date=2019-06-11|archive-url=https://web.archive.org/web/20190611145607/https://www.telecompaper.com/news/siemens-and-mikron-agree-licensing-deal--22439|dead-url=no}}</ref>。當時英飛凌取得的樣本規格是1K的記憶體容量 ，8、16、32位元的虛擬微處理器和[[USIM|USIM]]用的[[NFC|NFC]]設備<ref>{{cite web|title=Infineon Adds Security and Convenience to SIM Cards for NFC Applications|url=http://www.infineon.com/cms/en/about-infineon/press/press-releases/2007/INFAIM200711-015.html|publisher=Infineon|date=2007-11-13|accessdate=2015-10-26|archive-date=2016-06-28|archive-url=https://web.archive.org/web/20160628095507/http://www.infineon.com/cms/en/about-infineon/press/press-releases/2007/INFAIM200711-015.html|dead-url=no}}</ref>。

[[摩托羅拉|摩托羅拉公司]]曾經嘗試開發與MIFARE功能類似的接觸式晶片，原本該公司預估每個月有1百萬次的使用量，但是最後只有10萬次。以致最後放棄了這個產品
<ref>{{cite web|title=Motorola sets smart card targets|url=http://www.cnet.com/news/motorola-sets-smart-card-targets/|publisher=Cnet|date=2002-01-02|accessdate=2015-10-26|archive-date=2019-06-29|archive-url=https://web.archive.org/web/20190629125247/https://www.cnet.com/news/motorola-sets-smart-card-targets/|dead-url=no}}</ref>。

1998年飛利浦將MIFARE Classic技術授權給了[[日立製作所|日立製作所]]<ref>{{cite web|title=SMART CARD NEWS-Banksys Offers Stakas in Proton Purse Technolgy|url=http://www.smartcard.co.uk/members/newsletters/1998/feb98.pdf|publisher=Cnet|date=1998-02-01|accessdate=2015-10-26|archive-date=2013-11-02|archive-url=https://web.archive.org/web/20131102015139/http://www.smartcard.co.uk/members/newsletters/1998/feb98.pdf|dead-url=no}}</ref>，該公司在1999年至2006為[[日本電信電話|日本電信電話（NTT）]]開發了非接觸式智慧卡的解決方案。另外為NTT開發的電話卡專案有3個合作伙伴（分別是：Tokin-Tamura-Siemens、日立製作所、[[電裝|電裝公司]]），原本規劃以MIFARE Classic授權為基礎進而開發出兩種大小不同容量的接觸式產品，但是最後只有完成大容量的產品。

2008年，NXP為日立製作所提供了包含MIFARE Plus及MIFARE DESFire2項技術，日立製作所的半導體部門也更名為[[瑞薩電子|瑞薩電子]]
<ref>{{cite web|title=Renesas and NXP announce licensing agreement on MIFARE contactless technology|url=http://www.nxp.com/news/press-releases/2008/11/renesas-and-nxp-announce-licensing-agreement-on-mifare-contactless-technology.html|publisher=NXP Semiconductors|date=2008-11-03|accessdate=2015-10-26|archive-date=2015-09-30|archive-url=https://web.archive.org/web/20150930200615/http://www.nxp.com/news/press-releases/2008/11/renesas-and-nxp-announce-licensing-agreement-on-mifare-contactless-technology.html|dead-url=no}}</ref>。

2010年，NXP把MIFARE授權給[[金雅拓|金雅拓]]公司（Gemalto），2011年NPX授權法國歐貝特科技使用在[[SIM|SIM]]卡上。這些授權都是用來開發NFC領域的產品。

== 硬體架構及工作原理 ==
{|class="wikitable" style="text-align:center"
! rowspan="2" |
!align="center" colspan="2"|MIFARE Ultralight
!align="center" colspan="1"|MIFARE Classic
!align="center" colspan="2"|MIFARE Plus
!align="center" colspan="3"|MIFARE DESFire
|-
! rowspan="1" align="center"|MIFARE Ultralight EV1
! rowspan="1" align="center"|MIFARE Ultralight C

! rowspan="1" align="center"|MIFARE Classic EV1

! rowspan="1" align="center"|MIFARE Plus (S/X)
! rowspan="1" align="center"|MIFARE Plus SE

! rowspan="1" align="center"|MIFARE DESFire EV1
! rowspan="1" align="center"|MIFARE DESFire EV2
! rowspan="1" align="center"|MIFARE DESFire EV3
|-
|射頻介面|| colspan="8"|[[ISO|ISO]]/[[IEC|IEC]] 14443-2，TYPE A
|-
|通訊協定|| colspan="3"|ISO/IEC 14443-3|| colspan="2"|ISO/IEC 14443-3&4|| colspan="3"| ISO/IEC 14443-4
|-
|UID碼|| colspan="2"| UID：7位元組||colspan="3"| UID：7位元組，RID：4位元組（無UID）|| colspan="3"| UID：7位元組，RID：4位元組（無UID）
|-
|通訊速度||colspan="3"| 106Kbps||colspan="5"| 106Kbps-848Kbps
|-
|資料儲存容量|| colspan="1"| 48bytes|| colspan="1"| 128bytes|| colspan="1"| 144bytes|| colspan="1"| 1K、4Kbytes|| colspan="1"| 2K、4Kbytes|| colspan="1"| 256、2K、4K、8Kbytes|| colspan="2"| 2K、4K、8Kbytes
|-
|驗證金鑰種類||colspan="1"| 無||colspan="1"| [[TDES|TDES]]||colspan="1"| {{link-en|Crypot-1|Crypot-1}}||colspan="2"| {{link-en|Crypo-2|Crypot-2}}、[[AES|AES]]||colspan="3"| [[TDES|TDES]]、[[AES|AES]]
|-
|機卡驗證類型||colspan="1"| 密碼||colspan="7"| 三重認證
|-
|機卡通訊加密類型||colspan="2"| 無||colspan="1"| Encrypted||colspan="6"| Plain，Encrypted以及CMACed
|-
|共同準則認證類型<br>（Common Criteria Certification）||colspan="3"| 無||colspan="1"| EAL4+||colspan="1"|無||colspan="1"| EAL4+||colspan="2"|EAL5+
|}
UID：唯一識別碼（Unique Identifier）， RID：安全隨機識別碼（Random Security Identifier）

{|class="wikitable"  font-size:10px; style="float: right;"
|+ 資料存儲區塊示意圖
!align="left" colspan="1"|區段
!align="left" colspan="1"|區塊 0
!align="left" colspan="1"|區塊 1
!align="left" colspan="1"|區塊 2
!align="left" colspan="1"|區塊 3
|-
|0||製造商代碼||資料區||資料區||金鑰、存取權限
|-
|1||資料區||資料區||資料區||金鑰、存取權限
|-
|2||資料區||資料區||資料區||金鑰、存取權限
|-
|:||:||:||:||:
|-
|14||資料區||資料區||資料區||金鑰、存取權限
|-
|15||資料區||資料區||資料區||金鑰、存取權限
|}
*卡片架構：卡片上面有一組唯一識別碼、通訊介面（包含天線及[[調變解調器|調變解調器]]）以及一個[[特殊應用積體電路|ASIC]]裡面包含了通訊邏輯電路、加密控制邏輯電路與資料儲存區（ [[EEPROM|EEPROM]]），可以作為電子錢包或其它門禁、差勤考核、借書證等用途。
**資料存儲區塊：可分16個區段（sector 0-15）， 每個區段由4個區塊（block 0-3）組成，而每個區塊都是獨立的單元，每1個區塊的容量有16Byte。而每個區段的最後一個區塊則用來存放2組金鑰（KeyA、KeyB），以及金鑰對應各自的存取權限（Access bit）。
**每張卡片第一區段的第一區塊（sector 0，block 0）只能讀取無法寫入資料，稱為製造商代碼（Manufacturer Code）, 第1－4byte為UID。第5byte為位元計數檢查碼（bit count check)，其餘的存放卡片製造商的資料。所以每張卡片實際能使用的只有15個區段，即便如此也可用於15個不同的應用。

*讀寫卡機架構：讀卡機包含[[CPU|CPU]]、電源模組、讀（寫）模組、記憶模組、控制模組等，有些還有顯示模組、定時模組等其他模組。

*工作流程：當卡片接近讀寫卡機進入通訊天線的感應範圍（約2.5[[公分|公分]]至10公分）之後，讀寫卡機便會提供微量電力（約達2伏特之後）驅動卡片上的電路。此時卡、機各以[[曼徹斯特編碼|曼徹斯特編碼]]（{{lang|en|MANCHESTER Encoding}}）及{{tsl|en|Miller encoding|米勒編碼}}（{{lang|en|Miller encoding}}）加密通訊內容後再以[[調變|振幅偏移調變]]（Amplitude Shift Keying，ASK）透過調變解調器收發[[無線電波|無線電波]]信號互相驗證是否為正確卡片，如果驗證結果正確讀寫卡機就會確認要存取的資料存儲區塊，並對該區塊進行密碼校驗，在卡、 機三重認證無誤之後，就可以透過加密進行實際工作通訊。這個過程大約只需要0.1秒就可以完成。如果同時有多張卡片進入讀寫卡機感應範圍，讀寫卡機會將卡 片編號並選定1張卡片進行驗證直到完成所有卡片驗證（稱為防碰撞機制）或是離開感應範圍為止。
**卡 機三重認證步驟：1.卡片產生一個亂數RB傳送到讀卡機。2.讀卡機會將接收到的亂數RB依公式加密編碼後的TokenAB數值並傳送回卡片。3.卡片接 收到TokenAB後，會把加密部份解譯出來然後比對參數B、亂數RB。同時並依據收到的亂數RA，參照公式編碼後產生TokenBA傳送回讀卡機。4. 讀卡機接收到TokenBA後，又把加密過的部份解譯，比較亂數RB，RA與TokenBA中解出之RB、RA是否相符，正確的就可以完成指令（扣款、打 開門鎖或是登記其他事項）。

== 攻擊事件 ==
2007年12月，在[[混乱通讯大會|騷亂交流大會]]上Henryk Plötz和Karsten Nohl<ref>{{Cite web |url=http://www.cs.virginia.edu/~kn5f/ |title=Karsten Nohl的個人網頁 |accessdate=2015-10-26 |archive-date=2020-02-04 |archive-url=https://web.archive.org/web/20200204014629/http://www.cs.virginia.edu/~kn5f/ |dead-url=no }}</ref>發表了部分用於MIFARE晶片[[演算法|演算法]]上的[[反向工程|反向工程]]技術<ref>{{cite web |title=Mifare: Little Security, Despite Obscurity |url=http://events.ccc.de/congress/2007/Fahrplan/events/2378.en.html |first=Karsten |last=Nohl |author2=Henryk Plötz |publisher=Chaos Communication Congress |accessdate=2015-10-26 |archive-date=2018-11-26 |archive-url=https://web.archive.org/web/20181126181829/https://events.ccc.de/congress/2007/Fahrplan/events/2378.en.html |dead-url=no }}</ref>。

2008年3月，在荷蘭的奈梅亨大學（Radboud University Nijmegen）數位安全研究群裡發表了利用反向工程複製並且修改採用MIFARE Classic技術的電子票證OV卡（ov-chipkaart）上的餘額<ref>{{cite web|url = http://www.cs.ru.nl/~flaviog/publications/Security_Flaw_in_MIFARE_Classic.pdf|title = Security Flaw in Mifare Classic|author = Digital Security Group publisher=Radboud University Nijmegen|date = 2008-03-12|accessdate = 2015-10-26|archive-date = 2016-12-23|archive-url = https://web.archive.org/web/20161223160825/http://www.cs.ru.nl/~flaviog/publications/Security_Flaw_in_MIFARE_Classic.pdf|dead-url = no}}</ref>。
奈梅亨大學發表了下列三篇關於MIFARE Classic的文件：
* [http://www.cs.ru.nl/~flaviog/publications/Attack.MIFARE.pdf A Practical Attack on the MIFARE Classic] {{WebCite|url=https://www.webcitation.org/6AqRPyRDO?url=http://www.cs.ru.nl/~flaviog/publications/Attack.MIFARE.pdf |date=20120921135151 |dateformat=iso }}
* [http://www.cs.ru.nl/~flaviog/publications/Dismantling.Mifare.pdf Dismantling MIFARE Classic] {{WebCite|url=https://www.webcitation.org/6AqRQxbOk?url=http://www.cs.ru.nl/~flaviog/publications/Dismantling.Mifare.pdf |date=20120921135205 |dateformat=iso }}
* [http://www.cs.ru.nl/~flaviog/publications/Pickpocketing.Mifare.pdf Wirelessly Pickpocketing a MIFARE Classic Card] {{WebCite|url=https://www.webcitation.org/6AqRRTDhY?url=http://www.cs.ru.nl/~flaviog/publications/Pickpocketing.Mifare.pdf |date=20120921135213 |dateformat=iso }}
恩智浦半導體曾經嘗試在荷蘭的法庭提出訴訟以阻止這些文件發表，但是法官認為這屬於言論自由，便否決NXP公司所提<ref>{{cite web|url=http://zoeken.rechtspraak.nl/ResultPage.aspx?snelzoeken=t&searchtype=ljn&ljn=BD7578|title=Pronunciation, Primary Claim|author=Arnhem Court Judge Services|publisher=Rechtbank Arnhem|date=2008-07-18|accessdate=2015-10-26|archive-date=2012-02-15|archive-url=https://web.archive.org/web/20120215225402/http://zoeken.rechtspraak.nl/ResultPage.aspx?snelzoeken=t&searchtype=ljn&ljn=BD7578|dead-url=no}}</ref><ref>{{cite news |url=http://www.thestandard.com/news/2008/07/18/judge-denies-nxps-injunction-against-security-researchers |title=Judge denies NXP's injunction against security researchers |publisher=The Standard |date=2008-07-18 |deadurl=yes |archiveurl=https://web.archive.org/web/20090105205323/http://www.thestandard.com/news/2008/07/18/judge-denies-nxps-injunction-against-security-researchers |archivedate=2009-01-05 |accessdate=2015-10-26 }}</ref>

2008年8月在第17屆[[USENIX|高等計算系統協會]]（USENIX）中有另外一份講述如何利用反向工程的程序發表<ref>{{cite journal|url=http://www.usenix.org/events/sec08/tech/nohl.html|title=Reverse-Engineering a Cryptographic RFID Tag|first=Karsten|last=Nohl|author2=David Evans|journal=Proceedings of the 17th USENIX Security Symposium|date=2008-08-01|access-date=2015-10-26|archive-date=2011-06-08|archive-url=https://web.archive.org/web/20110608131040/http://www.usenix.org/events/sec08/tech/nohl.html|dead-url=no}}</ref>

臺大電機教授示範竄改悠遊卡：2010年7月，[[臺灣大學|臺灣大學]][[電機系|電機系]]教授鄭振牟團隊使用改進過的監聽封包（Sniffer-Based）的攻擊手法攻擊Mifare卡。將1張正常使用中的[[悠遊卡|悠遊卡]]，將餘額從正100多元，更改成為負五百多元<ref>{{cite web|url=http://www.ithome.com.tw/node/63075|title=臺大電機教授示範無線竄改悠遊卡金額|publisher=iThome|date=2010-09-01|accessdate=2015-10-26|archive-date=2019-06-13|archive-url=https://web.archive.org/web/20190613110930/https://www.ithome.com.tw/node/63075|dead-url=no}}</ref>。

資安顧問竄改悠遊卡：2011年7月，某科技公司一名24歲資安顧問，宣稱在美國網站購買讀寫卡機，再下載美國學生破解[[波士頓地鐵|波士頓地鐵]]查理卡（Charlie Card）的文章後花了四個月的時間撰寫程式，破解悠遊卡防護系統，以自製讀寫卡機為悠遊卡竄改加值成功並盜刷六次<ref>{{cite web|url=http://www.appledaily.com.tw/appledaily/article/headline/20110928/33698917/|title=天才駭客破解悠遊卡 盜刷39元|publisher=蘋果日報|date=2011-09-28|accessdate=2015-10-26|archive-date=2017-09-14|archive-url=https://web.archive.org/web/20170914011617/http://www.appledaily.com.tw/appledaily/article/headline/20110928/33698917|dead-url=no}}</ref>。

==相關條目==
* [[RFID|RFID]]
* [[近場通訊|NFC]]
* [[FeliCa|FeliCa]]
* {{tsl|en|Legic}}
* [[智慧卡|智慧卡]]
* [[悠遊卡|悠遊卡]] (台灣)
* [[iPASS一卡通|iPASS一卡通]] (台灣)

==參考==
{{reflist|2}}

==外部連結==
* [http://www.mifare.net/ MIFARE官網]
* [http://www.tw.nxp.com/about.html 台灣恩智浦半導體公司官網] {{Wayback|url=http://www.tw.nxp.com/about.html |date=20150924053006 }}

[[Category:智慧卡|Category:智慧卡]]
[[Category:近场通信|Category:近场通信]]