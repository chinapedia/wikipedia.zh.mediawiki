{{NoteTA
|G1=IT
|1=zh-cn:图标; zh-tw:圖示; zh-hk:圖標;
}}
{{Infobox file format
| name = MHTML
| icon =[[檔案:MHTML.PNG|150px]]
| iconcaption = IE使用的圖示
| screenshot =
| extension = .mht, .mhtml
| mime = multipart/related<br />application/x-mimearchive
| type code =
| uniform type =
| owner =
| genre = [[置标语言|置标语言]]
| container for =
| contained by =
| extended from = [[HTML|HTML]]
| extended to =
| standard = RFC 2557（1999年推荐）
}}

'''網頁封存檔'''（{{lang-en|'''M'''IME '''HTML'''}}或{{lang|en|'''M'''IME Encapsulation of Aggregate '''HTML''' Documents}}，缩写mhtml）是種儲存檔案格式，在RFC 2110中定義，後經RFC 2557修訂。微軟稱之'''單一檔-{}-案網頁'''或'''单个文-{}-件网页'''（Single-File Web Page）<ref>{{cite web|url=https://docs.microsoft.com/en-us/office/troubleshoot/office-suite-issues/web-page-missing-file-error|title="Missing file" error with a web page file|author=|date=2020-06-12|publisher=Microsoft Docs|accessdate=|archiveurl=https://web.archive.org/web/20200621063116/https://docs.microsoft.com/en-us/office/troubleshoot/office-suite-issues/web-page-missing-file-error|archivedate=2020-06-21|deadurl=no|language=en}}</ref><ref>{{cite web |url=https://docs.microsoft.com/zh-tw/office/troubleshoot/office-suite-issues/web-page-missing-file-error |title=網頁檔案出現「遺失檔案」錯誤 |author= |date=2020-06-13 |publisher=Microsoft Docs |accessdate= |archiveurl=https://web.archive.org/web/20200621022955/https://docs.microsoft.com/zh-tw/office/troubleshoot/office-suite-issues/web-page-missing-file-error |archivedate=2020-06-21 |deadurl=no |language=zh-tw }}</ref><ref>{{cite web |url=https://docs.microsoft.com/zh-cn/office/troubleshoot/office-suite-issues/web-page-missing-file-error |title=包含网页文件的 "缺少文件" 错误 |author= |date=2020-06-13 |publisher=Microsoft Docs |accessdate= |archiveurl=https://web.archive.org/web/20200619143642/https://docs.microsoft.com/zh-cn/office/troubleshoot/office-suite-issues/web-page-missing-file-error |archivedate=2020-06-19 |deadurl=no |language=zh-cn }}</ref>。

其以[[多用途互聯網郵件擴展|多用途互聯網郵件擴展]]格式，應用[[HTML郵件|HTML郵件]]訊息相同技術開發，將一個[[多附件網頁|多附件網頁]]（如包含大量[[圖片|圖片]]、[[SWF|Flash動畫]]、[[JavaScript|Java小程序]]的網頁）儲存成單一檔案<ref name=12a3a45>{{cite book|author=David J. Clark|title=The Unofficial Guide to Microsoft Office Word 2007|year=2008|publisher=John Wiley & Sons|isbn=9780470377437}}</ref>，副檔名為'''.mht'''（[[Internet_Explorer|IE]]）或'''.mhtml'''（[[Chromium|Chromium]]），支援瀏覽器對此兩種副檔名皆可設定讀取。由於IE最早使用，有時被簡稱MHT。

== 與HTML差異 ==
HTML頁面中的圖形和其他功能可以分開存放，需要原始文件上引用，也可以通過data URI scheme等途徑嵌入其中。MHTML則把網頁及其附件皆儲存為單一檔案。

== 創建及編輯 ==
[[Microsoft_Office|Microsoft Office]]（[[Word|Word]]<ref name=12a3a45 />、[[Excel|Excel]]、[[PowerPoint|PowerPoint]]、[[Access|Access]]）能夠創建及編輯MHTML檔案。

在[[Linux|Linux]]平台上，程式[[kmhtConvert|kmhtConvert]]可將文件轉換為MHTML格式。
== 浏览器的支持==
有些瀏覽器具有原生的这种把網頁保存為MHTML的方式，而有些瀏覽器可直接通過第三方的擴展支持MHTML格式。由於保存為MHTML的方式未經標準化，因此各瀏覽器讀取的效果略有不同。
===Internet Explorer===
[[Microsoft_Internet_Explorer|Microsoft Internet Explorer]]自5.0版支持MHTML格式，是第一個支持MHTML文件的瀏覽器。
===Opera===
[[Opera瀏覽器|Opera]]自9.0版支持把網頁保存為MHTML文件，或讀取MHTML文件。<ref>{{cite web |url=http://my.opera.com/desktopteam/blog/show.dml/172375 |title=…and one more weekly! |last=Santambrogio |first=Claudio |date=10 March 2006 |publisher=[[Opera_Software|Opera Software]] |accessdate=2009-05-15 |archiveurl=https://web.archive.org/web/20060321061106/http://my.opera.com/desktopteam/blog/show.dml/172375 |archivedate=2006-03-21 |deadurl=yes }}</ref>但基於WebKit/Blink的Opera 15卻未提供此功能，直到Opera 16才恢復。

現時通過{{mono|opera://flags#save-page-as-mhtml}}啟用實驗性的選項。
===Firefox===
[[Firefox|Firefox]]不支援讀寫MHT文件。<ref>{{cite web|title=Bug 40873 - Save as rfc 2557 MHTML; complete webpage in one file|url=https://bugzilla.mozilla.org/show_bug.cgi?id=40873|accessdate=2018-10-23|archive-date=2020-12-15|archive-url=https://web.archive.org/web/20201215155813/https://bugzilla.mozilla.org/show_bug.cgi?id=40873|dead-url=no}}</ref>在57.0之前有兩個這樣的擴展是免費提供的，如[http://maf.mozdev.org/index.html Mozilla Archive Format] {{Wayback|url=http://maf.mozdev.org/index.html |date=20200629182138 }}、[https://web.archive.org/web/20170207055530/http://www.unmht.org/unmht/en_index.html UnMHT]。

===Google Chrome===
在[[Google_Chrome|Chrome]]創建MHTML文件可以通過啟用{{mono|chrome://flags#save-page-as-mhtml}}這個實驗性的選項（25.0起）(現已移除)，<ref>[http://superuser.com/questions/369232/how-to-save-a-web-page-as-mht-in-chrome How to save a web page as MHT in chrome?] {{Wayback|url=http://superuser.com/questions/369232/how-to-save-a-web-page-as-mht-in-chrome |date=20180923162642 }}, superuser.com</ref>或是通過用於擴展程式的API（35.0起）。<ref>{{cite web |author= |url=https://developer.chrome.com/extensions/pageCapture |title=chrome.pageCapture |website=developer.chrome.com |accessdate=2019-11-10 |archive-date=2020-05-09 |archive-url=https://web.archive.org/web/20200509074844/https://developer.chrome.com/extensions/pageCapture |dead-url=no }}</ref>

===Safari===
[[Safari|Safari]]不提供对MHTML的支持，代之以苹果公司自创的{{link-en|Webarchive|Webarchive}}格式，[[OS_X|OS X]]的版本中还提供保存为[[PDF|PDF]]选项。也有人试图为Safari创建读写MHTML文件的扩展。

=== Konqueror ===
Konqueror需要使用[http://sourceforge.net/projects/mhtconv mhtconv] {{Wayback|url=http://sourceforge.net/projects/mhtconv |date=20161229034521 }}扩展以实现对MHTML的支持。

===ACCESS NetFront===
[[NetFront|NetFront]] 3.4（像是索尼爱立信[[K850|K850]]等设备上的）可读取或保存MHTML文件。

===Pale Moon===
[[Pale_Moon|Pale Moon]]需要安裝MHT文件讀寫的擴展。有一個這樣的擴展是免費提供的，即[https://addons.palemoon.org/addon/mozarchiver/ MozArchiver] {{Wayback|url=https://addons.palemoon.org/addon/mozarchiver/ |date=20201112015603 }}。

=== GNOME Web ===
最近的[[GNOME_Web|GNOME Web]]版本可以存取MHTML。

===Vivaldi===
[[Vivaldi_(瀏覽器)|Vivaldi]]可以通過{{mono|vivaldi://flags#save-page-as-mhtml}}啟用實驗性的選項。

===MHT阅读器===
一些商业或民间开发者设计了MHT文件阅读器，还提供转换为其它格式（如转换为[[PDF|PDF]]）的选项。

== 格式 ==
MHTML檔案的第一部分是[[電子郵件|電子郵件]]檔頭，第二部分是常規的HTML源碼，後續部分是由各自的[[URL|URL]]標識的附件，并以[[base64|base64]]格式編碼。

該檔案與 .eml（電子郵件）具有互換性，二者的副檔名可以相互交換。一份 .eml 檔案可以作為電子郵件發送，也可以通過電郵客戶端顯示，一條電郵資訊可以用 .mhtml 或 .mht 副檔名存儲，並通過一些網頁瀏覽器或者文本編輯器顯示。

示例如下：
<syntaxhighlight lang="xml">
Subject:標題
Date: Wed, 15 Dec 2004 10:05:01 +1000
Content-Type: multipart/related;
Content-Transfer-Encoding: quoted-printable
Content-Location: file://C:/fishier.html
This is a multi-part message in MIME format.

Content-Type: text/html;
<HTML>
 <HEAD>
  <TITLE>Title</TITLE>
 </HEAD>
 <BODY>
   ...
 </BODY>
</HTML>

Content-Type: image/gif
Content-Transfer-Encoding: base64
Content-Location: file://C:/image.gif
RHLJbDYX0KhHzv7yGcCgghhgHLJbDYX0KhHzv7yGcChkNdjn+Nfn+NXm98/i98rf9sfe9b/Z9L3X
87fU8qP8afL8AHzvfg7yGcChkNIwMZHLJbDYX0KhHzv37yGcChkNIw2Oj5AAAZIAlhAAACwAAAAA
er8JhHg8PhgQBrPZwG673+6CoUCv2+91gn5PGPT7fgOCg4SFhQKIiYoCAY2Oj5AAAZIAlJWXACEA
4SFh==
</syntaxhighlight>
其中Subject为文档标题，Content-Type为文件的MIME属性，Content-Location为原始文件的地址，Content-Transfer-Encoding为编码格式。

== 参见 ==
* [[Mozilla_Archive_Format|Mozilla Archive Format]]
* {{link-en|Webarchive|Webarchive}}
* RFC 2397

== 參考資料 ==
<references/>

[[Category:网页归档格式|Category:网页归档格式]]
[[Category:HTML|Category:HTML]]