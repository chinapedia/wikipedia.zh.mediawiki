{{Lowercase}}
{{refimprove|time=2016-05-03T01:31:29+00:00}}
[[OS_X|OS X]] 是苹果公司 Mac OS 操作系统替代品的产物。 在多次失败的尝试之后，苹果于1994年启动了 Pink 项目（后来和 IBM 进行了合作），这就是 Taligent 和 [[Copland_操作系统|Copland]] ，两年后这一项目取消。
通过收购获得了 [[NeXT|NeXT]] 和其 [[NeXTSTEP|NeXTSTEP]] 操作系统之后，苹果公司开始着手开发他们最新的操作系统 ([[Mac_OS_X|Mac OS X]]) 
OS X 首次出现是1999年的 OS X Server 1.0，第一个正式的 OS X 桌面版本发布于2001年3月24日。
从10.5版本开始，OS X 通过了 Open group Unix O3 单一 Unix 规范认证。

2016年6月，苹果公司宣布OS X更名为macOS，以便与苹果其他操作系统如iOS、watchOS和tvOS保持统一的命名风格。

Mac OS X 包含两个主要的部分：以FreeBSD源代码和Mach微核心为基础的 [[XNU|XNU]] 混合内核，并在 XNU 上构建的 Darwin 核心系统；及一个由苹果开发，称为 Aqua 的闭源、独占版权的图形用户界面。
细分的看，Mac OS X 系统可以分成五层结构，每一层有其代表性的技术。

== 开发 ==

=== NeXTSTEP ===
NeXTSTEP 使用基于卡内基梅隆大学开发的 [[Mach|Mach]] 2.5 微内核 [[BSD|BSD]] 4.3 子系统开发的混合内核。 NeXTSTEP 还推出了基于 [[Display_PostScript|DPS]] 的窗口系统，通过在显示器和打印机上使用同一种语言以达到更好的所见即所得效果。 NeXT 还包含他们从 StepStone 的收购的面向对象的 Objective-C 的语言和一系列旨在加快软件开发的框架（工具包）。

NeXTSTEP 最初设计运行在跑摩托罗拉68K处理器上，但后来被移植到英特尔的x86，惠普的[[PA-RISC|PA-RISC]]和升阳电脑的[[SPARC|SPARC]]处理器。后来，开发工具和框架以OpenStep形式发布，作为一个开发平台，它可以其他操作系统上运行。

=== Rhapsody ===
1997年2月4日，苹果公司收购了NeXT，并着手开发 [[Rhapsody|Rhapsody]] 操作系统。Rhapsody 基于 NeXTSTEP 构建，并将核心系统[[移植_(軟體)|移植]]到了 [[PowerPC|PowerPC]] 架构上并添加了一个重新设计的用户接口。允许旧 Mac OS 的程序运行在独立的 JAVA 平台上的模拟层称为 Blue Box，而 Objective-C 开发工具和框架被称为 Yellow Box，Yellow Box 将为 [[Windows|Windows]] 独立提供。

Rhapsody 项目的最终结果，以 [[Mac_OS_X_Server_1.0|OS X Server 1.0]] 的形式于1999年发布。

=== Mac OS X ===
[[File:Diagram_of_Mac_OS_X_architecture.svg|缩略图]]
在1998年的[[苹果全球开发者大会|苹果全球开发者大会]](WWDC)上，由于 Macintosh 平台软件开发者对 Rhapsody 上的Yellow Box 和 Blue Box存在诸多不满，苹果公司作出回应，称 Mac OS X 将提供一个不同于 Rhapsody 中现存的、全新的 API。

来自 Macintosh Toolbox 的关键 API 使得 OS X 可以直接运行在 BSD 层上而不需要 Macintosh 模拟层，这个接口被称为 Carbon，是 Mac OS X 中五大主要 API 之一，Carbon 去除了约2000个有问题的 API（系统中 API 总数约8000个）并将之替换为现代操作系统兼容的系统调用<ref name="anguish99summary">{{Cite web|url=http://www.stepwise.com/SpecialCoverage/WWDC98/Summary.html|title=WWDC 98 Summary|accessdate=2006-10-13|author=Scott Anguish|date=May 1998|publisher=stepwise.com|archive-date=2021-12-31|archive-url=https://web.archive.org/web/20211231093640/http://www.stepwise.com/SpecialCoverage/WWDC98/Summary.html}}</ref>。

与此同时，苹果宣布将 Mach 部分内核版本号升级到3，BSD 部分的内核将被 [[FreeBSD|FreeBSD]], [[NetBSD|NetBSD]] 和 [[OpenBSD|OpenBSD]] 项目所替代.<ref name="anguish99summary"/> 他们还发布了名为 I/O Kit的新驱动层，用于替代 NeXTSTEP 中的 Driver Kit，针对 Driver Kit 缺少电源管理和热交换特性、自动配置功能匮乏等问题作出了改进。<ref>{{Cite web|url=http://www.stepwise.com/SpecialCoverage/WWDC98/Thursday-IOKit.html|title=Rhapsody Core OS: Intro to the I/O Driver Architecture|accessdate=2006-10-13|author=Scott Anguish|date=1998-05-14|publisher=stepwise.com|archive-date=2021-12-31|archive-url=https://web.archive.org/web/20211231093640/http://www.stepwise.com/SpecialCoverage/WWDC98/Thursday-IOKit.html}}</ref>

在1999年的 WWDC 上，苹果公司发布了 [[Quartz|Quartz]]，一个基于 [[便携式文档格式|便携式文档格式]] 的窗口系统以避免产生（先前 NeXTSTEP 中 DPS 系统中遇到过的）和 Adobe 的版权纠纷和相关费用。

苹果还宣布，Yellow Box 被更名为 [[Cocoa|Cocoa]] 并撤回了 Yellow Box 将在 Windows 系统上提供的承诺。此次 WWDC 苹果还首次演示了将 Mac OS X 运行在 [[HFS+|HFS+]] 格式的驱动器上 。

第一个面向消费者的 Mac OS X 版本是2000年9月13日发布的[[Mac_OS_X公開測試版|公开预览版]]。

== 结构<ref>{{cite web|url=https://developer.apple.com/library/mac/documentation/MacOSX/Conceptual/OSX_Technology_Overview/About/About.html#//apple_ref/doc/uid/TP40001067-CH204-TPXREF101|title=About Developing for Mac|publisher=|accessdate=2016-05-03|archive-date=2016-08-05|archive-url=https://web.archive.org/web/20160805130752/https://developer.apple.com/library/mac/documentation/MacOSX/Conceptual/OSX_Technology_Overview/About/About.html#//apple_ref/doc/uid/TP40001067-CH204-TPXREF101|dead-url=no}}</ref> ==

===内核和设备服务层===
内核和设备服务层包括 XNU 内核、设备驱动和其他底层组件。
XNU是由苹果电脑发展的操作系统内核，被使用于Mac OS X中。它是Darwin操作系统的一部分，跟随着Darwin一同作为自由及开放源代码软件被发布。其中，XNU 是X is Not Unix的缩写。
XNU 包括 Mach 和 BSD （libSystem）两个部分，最初版本的 XNU 是 Mach 2.5版本和 BSD 4.3 的混合，随着 OS X 的发布，Mach 版本升级到3，BSD 部分被 FreeBSD 替代。

* Mach：
Mach 是一个由卡内基梅隆大学开发的计算机操作系统[[微内核|微内核]]，是最早实现微核心操作系统的例子之一，也是许多其它相似的项目的标准。
同UNIX一样，Mach系统也包含了一组丰富的实用工具，并保留了 Unix 中驱动程序的概念用以硬件交互。
在 OS X 中，Mach 内核为系统提供了64位内核和主要驱动支持。

* BSD：
伯克利软件套件（英语：Berkeley Software Distribution，缩写为 BSD），也被称为伯克利Unix（Berkeley Unix），是一个操作系统的名称，现在 BSD 也被用于称呼其衍生的各种套件。
BSD 开创了现代计算机的潮流，由于BSD设计出众，代码编写清晰，包括它的文档，BSD 是最早添加库以支持 IP 协议栈和[[伯克利套接字|伯克利套接字]]的 Unix 系统，套接字系统的发明使得计算机系统的网络通信和本地读写一样方便，BSD 。时至今日，BSD仍在学术机构，乃至许多商业或自由产品的高科技实验中，继续被用作试验平台，甚至在嵌入式设备中。
最初的 OS X 的内核 XNU 所使用的是 4.3BSD ，该版本发布于1986年6月。时至今日，OS X 中的许多命令行工具还是来源于 BSD。在 OS X 中，文件系统、网络栈、[[进程间通信|IPC]]、通知机制的支持也来自 BSD。

=== 核心系统层（Core OS） ===
核心系统层的技术和框架是硬件/网络相关的底层服务，这些服务是和内核特性直接相关的。包括以下组件和框架（不完全列举）：
* 安全措施：（为上层提供支持）包括Gatekeeper、APP 沙盒化、代码签名等。
* Core OS 框架：包括磁盘管理、硬件加速、OpenCL、系统配置等。
* Hypervisor：虚拟化支持。

===核心服务层（Core service）===
核心服务层和用户界面的应用程序没有直接联系，但是它们建立在内核和核心系统层上，为APP提供诸如数据处理、字符串控制、封装网络库等核心支持。包括以下组件和框架（不完全列举）：
* iCloud 存储服务和 CloudKit
* 社交网络帐号：包括保存在 OS X 内的社交帐户的管理。
* 文件管理
* 本地化设置：语言、货币、日期和时间的格式化、编码、字体排版和渲染。
* 安全认证：包括本地账户、信任的证书、安全传输、密钥串访问等。
* Time Machine 支持：OS X 的系统备份功能。
* [[Bonjour|Bonjour]]：局域网下的设备发现服务，是打印机服务和局域网文件共享服务的基础。
* XML 和 SQLite 支持：系统和 APP 的配置文件使用 XML 格式进行存储，数据使用 SQLite 格式进行保存。
* [[Webkit|Webkit]]: 允许 APP 进行网页渲染，具有 Web Core 和 JavaScript Core 两个部分。
* 快速预览：包括在 spotlight 中预览和空格键预览。
* Store Kit: 为 Mac Appstore 和 iTunes 提供支持，处理相关请求。
* Core Services Umbrella Framework：包括管理文件打开方式、MIME 支持、文件元数据管理、SearchKit 搜索支持、词典服务等。
** [[Carbon_(API)|Carbon]]: Carbon 也是 OS X 上的原生 API，也是 Core Services Umbrella Framework 的子集<ref>{{cite web|url=https://developer.apple.com/library/mac/releasenotes/General/CarbonCoreDeprecations/index.html#//apple_ref/doc/uid/TP40012224|title=Carbon Core Deprecations|publisher=|accessdate=2016-05-05|archive-date=2015-09-07|archive-url=https://web.archive.org/web/20150907185823/https://developer.apple.com/library/mac/releasenotes/General/CarbonCoreDeprecations/index.html#//apple_ref/doc/uid/TP40012224|dead-url=no}}</ref>，和 Cocoa 不同的是，Carbon是面向过程（Procedural）的编程语言API，也更加接近系统底层，可以使用包括 C 和 C++ 在内的多种编程语言进行开发，类似 Windows 的 win32 API。Carbon API 提供了良好的向下兼容性，为开发者快速将旧 MacOS 上的程序移植到 OS X 提供了便利，但是 Carbon 本身已经处于被苹果不建议使用的状态，也没有64位支持，在 OS X 10.8 后苹果没有对 Carbon 提供后续更新。

===媒体层 ===
媒体层负责音频、图像等多媒体文件的处理，2D 和 3D 图像的渲染，各种动画支持。
* [[OpenGL|OpenGL]] ：OpenGL是一个定义了一个跨编程语言、跨平台的应用程序接口（API）的规范，它用于生成二维、三维图像。OpenGL本身与语言和平台无关，它将具体实现交给窗口系统，OS X 也提供了OpenGL 的实现。
* [[Metal_(API)|Metal]] ：Metal 是一种面向底层的硬件加速 API，Metal 在单一 API 下提供了类似 OpenGL 和 OpenCL 的功能，旨在为提供和 Windows上[[Direct3D|Direct3D 12]]和跨平台的[[Vulkan_(API)|Vulkan]]相似的功能和特性。 从10.11开始在 OS X 上提供支持。
* [[Quartz|Quartz]]：Quartz 是 OS X 上的 UI 绘图层，由 Quartz Compositor（合成视窗系统，管理和合成幕后视窗视频来创建Mac OS X用户界面） 和 Quartz 2D（以PDF规范为基础的图形库，用来绘制二维文字和图形，现在被称为 Core Graphics）组成。
* 颜色管理
* 音视频文件解析：包括QuickTime Kit、Core Media 、Core Video等一系列多媒体处理框架。
* 字体渲染系统：包括 Cocoa Text 系统和Core Text。

===图形用户界面（Cocoa 层）===
图形用户界面层包括设计和用户交互的 UI、响应用户操作、管理程序的行为。
* Aqua：Aqua 是承载于 Quartz 上的 GUI 系统和视觉主题，首次发布于2000年。
* X11（XQuartz）: XQuartz 是 OS X 上 [[X窗口系统|X窗口系统]]的一个实现，最初和 OS X 10.2 公开预览版一起提供，从 OS X 10.8 开始不随系统提供。
* Spotlight：OS X 下的搜索工具。
* [[Cocoa|Cocoa]]: Cocoa是 Mac OS X 上原生面向对象的编程环境，建立在 Quartz 上并由Objective-C语言编写，Cocoa 程序也主要使用Objective-C语言编写，但是通过桥接技术，也可以使用 JAVA、Python、Ruby 等语言开发 Cocoa 应用。Cocoa是典型的 [[MVC|MVC]] 模式。
** Appkit：直接派生自NeXTSTEP的AppKit的。它包含了程序与图形用户界面交互所需的代码。
** Foundation 工具包：首先出现在OpenStep中。在Mac OS X中，它是基于Core Foundation的。作为通用的面向对象的函数库，Foundation提供了字符串，数值的管理，容器及其枚举，分布式计算，事件循环，以及一些其它的与图形用户界面没有直接关系的功能。
** [[Core_Data|Core Data]]：Core Data是Mac OS X中Cocoa API的一部分，它允许按照MVC模型组织APP的数据，并以XML，二进制文件或SQLite数据文件的格式将其序列化。

== 参考文档 ==
{{Reflist}}

== 外部链接 ==
* [http://www.prepressure.com/pdf/basics/osx-quartz OS X 和 PDF] {{Wayback|url=http://www.prepressure.com/pdf/basics/osx-quartz |date=20200927201738 }}
* [http://www.apple.com/macosx/ Apple: Mac OS X] {{Wayback|url=http://www.apple.com/macosx/ |date=20060728031552 }} — OS X 官方页面。
* [http://arstechnica.com/reviews/os/macosx-10.4.ars/2 Mac OS X (arstechnica.com)] {{Wayback|url=http://arstechnica.com/reviews/os/macosx-10.4.ars/2 |date=20080706064713 }} —  Mac OS X 评测 (10.0 - 10.10)
* [https://web.archive.org/web/20200510142913/http://osxbook.com/ Mac OS X Internals] The web page associated with the book.
* [https://developer.apple.com/opengl/ OpenGL for OS X] {{Wayback|url=https://developer.apple.com/opengl/ |date=20180714134450 }}  Apple developer guide for OpenGL.
* [https://developer.apple.com/library/mac/documentation/Darwin/Conceptual/KEXTConcept/KEXTConceptIntro/introduction.html Kernel Extension Programming Topics] {{Wayback|url=https://developer.apple.com/library/mac/documentation/Darwin/Conceptual/KEXTConcept/KEXTConceptIntro/introduction.html |date=20160517170710 }} Mac developer library.

{{MacOS}}

[[Category:Mac_OS介面|Category:Mac OS介面]]