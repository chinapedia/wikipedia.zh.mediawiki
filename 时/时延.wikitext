在[[计算机网络|计算机网络]]中进行[[分组交换|分组交换]]，[[分组|分组]]从一台主机（源），通过一系列[[路由器|路由器]]传输，在另一台主机（目的地）结束它的进程。当[[分组|分组]]从一个节点（主机或[[路由器|路由器]]）沿着这条路径到后继结点（主机或[[路由器|路由器]]）时，该分组在沿途的每个节点都经受了几种不同类型的'''时延（{{lang|en|Delay}}）'''。

==时延种类==
[[节点处理时延|节点处理时延]]（{{lang|en|Nodal Processing Delay}}）、[[排队时延|排队时延]]({{lang|en|Queuing Delay}})、[[传输时延|传输时延]]({{lang|en|Transmission Delay}})、[[传播时延|传播时延]]({{lang|en|Propagation}})。而这些时延累加起来是节点总时延({{lang|en|Total Nodal Delay}})。为了深入了解[[分组交换|分组交换]]和[[计算机网络|计算机网络]]，我们必须理解这些'''时延'''的性质和重要性。

===节点处理时延===
检查[[分组|分组]]首部和决定将该[[分组|分组]]导向何处所需要的时间是节点处理时延的一部分。处理时延也包括其他因素，如检查比特级差错所需要的时间，该差错出现在这些[[分组|分组]]比特从上游节点向[[路由器|路由器]]A传输的过程中。高速路由器的处理时延通常是微秒或更低的数量级。在这种节点处理之后，路由器将该分组引向通往路由器B链路之前的队列。

===排队时延===
在队列中，当分组在链路上等待传输时，它经受排队时延。一个特定分组的排队时延将取决于先期到达的、正在排队等待向链路传输的分组的数量。如果该队列是空的，并且当前没有其他分组在传输，则该分组的排队时延为0。另一方面，如果流量很大，并且许多其他分组也在等待传输，该排队时延将很大。到达组的分组数量是到达该队列的流量强度和性质的函数。实际的排队时延通常在毫秒到微秒级。

===传输时延===
假定分组以先到先服务的方式传输——这在分组交换网络中是常见的方式，仅当所有已经到达的分组被传输后，才能传输我们的分组。用L比特表示分组的长度，用R bps表示从路由器A到路由器B的链路传输速率。发送时延是L/R。这是将所有分组比特推向链路所需要的时间。实际的传输时延通常在毫秒到微秒级。

===传播时延===
一旦一个比特被推向链路，该比特需要向路由器B传播，从该链路的起点到路由器B的传播所需要的时间是传播时延。该比特以该链路的传播速率传播，该传播速率取决于该链路的物理媒介，其速率范围是<math>2*10^8-3*10^8\,</math> m/s，这等于或略小于光速。传播时延等于两台路由器之间的距离除以传播速率，即传播时延是d/s，其中d是两台路由器之间的距离，s是该链路的传播速率。传播时延在毫秒级。

==传播时延和发送时延的比较==
[[计算机网络|计算机网络]]领域的新手有时难以理解发送时延和传播时延之间的差异，该差异虽说细小但是很重要。'''发送时延'''是路由器将分组推出所需要的时间，它是分组长度和链路传输速率的函数，而与两台路由器之间的距离无关。'''传播时延'''是一个比特从一台路由器向另一台路由器传播所需要的时间，它是两台路由器之间距离的函数，但与分组的长度或链路的传输速率无关。

==节点总时延==
令<math>d_{proc}\,</math>，<math>d_{queue}\,</math>，<math>d_{trans}\,</math>和<math>d_{prop}\,</math>分别表示处理时延、排队时延、传输时延和传播时延，那么节点的总时延由下式给定：

::<math>d_{nodal} = d_{proc} + d_{queue} + d_{trans} + d_{prop}\,</math>

这些时延成分所起的作用可能变化很大。一般而言，处理时延<math>d_{proc}\,</math>通常是微不足道的。然而，<math>d_{queue}\,</math>，<math>d_{trans}\,</math>可能是<math>d_{nodal}\,</math>的主要成分。

==排队时延==
节点时延的最为复杂和令人感兴趣的成分是排队时延。事实上，排队时延在计算机网络中的重要程度和人们感兴趣的程度，从发表的数以千计的论文和大量的专著可见一斑。
与其他三项时延（即<math>d_{proc}\,</math>，<math>d_{prop}\,</math>和<math>d_{trans}\,</math>）不同的是，排队时延对不同的分组是不同的。
===流量强度===
判断排队延时的大小时，结果很大程度取决于流量到达该队列的速率、链路的传输速率和到达流量的性质（即流量是周期性到达还是以突发形式到达）。

令a表示分组到达队列的平均速率（a的单位是分组每秒，即pkt/s），假定所有的分组都是L比特组成的，则比特到达队列的平均速率是La bps。而La/R被称为流量强度，它在估计排队时延的影响程度方面经常起着重要的作用。

===流量强度与排队时延===
如果La/R > 1，则比特到达队列的平均速率超过从该队列传输出去的速率。在这种不幸的情况下，队列的增加将趋近于无界，并且排队时延将趋向无穷大。因此，流量工程中的一条金科玉律是：设计系统时流量强度不能大于1。

现在考虑La/R ≤ 1的情况。这时，到达流量的性质影响排队时延。例如，如果分组周期性到达，即L/R s到达一个分组，则每个分组将到达一个空队列中，因此不会有排队时延。另一方面，如果分组以突发形式到达而不是周期性到达，则可能有很大的平均排队时延。例如，假定每L/R s同时到达N个分组，则传输的第一个分组没有排队时延；传输的第二个分组就有L/R s的排队时延；更为一般地，第n个传输的分组具有(n-1) L/R s的排队时延。
==端到端时延==
假设源主机和目的主机之间有N-1台路由器，并且该网络是无拥塞的。那么端到端时延为：

::<math>d_{end-end} = N (d_{proc} + d_{trans} + d_{prop}\,</math>)

==参见==
* [[计算机网络|计算机网络]]
* [[分组交换|分组交换]]

==参考文献==
{{reflist}}
* [[James_F.Kurose,_Keith_W.Ross|James F.Kurose, Keith W.Ross]]， 《计算机网络:自顶向下方法》（原书第四版）,(Computer Networking: A Top-Down Approach Forth Edition, ISBN 978-7-111-16505-7)
* [[William_Stallings|William Stallings]], 《数据与计算机通信》(DATA & COMPUTER COMMUNICATIONS, 6th Edt., ISBN 7-04-010043-6)

==外部链接==
* [http://www.cnpaf.net 中国协议分析网] {{Wayback|url=http://www.cnpaf.net/ |date=20160114134006 }}
* [http://www.google.com.hk 谷歌] {{Wayback|url=http://www.google.com.hk/ |date=20010922083310 }}

{{Computer Science}}
[[Category:网络技术|Category:网络技术]]
[[Category:计算机技术|Category:计算机技术]]